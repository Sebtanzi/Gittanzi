Chapter 1
Security Governance 
=================================
COBIT 5 (Control Objective for Information and Related Technology) by ISACA (Information System Audit and control Associations:
		1. Meeting Stakeholder Needs
		2. Covering the enterprise end-to-end
		3. Applying a single, integrated framework
		4. Enabling a Holistic Appoach
		5. Separating Governance from Management

STRIDE model :
		Spoofing = access through falsified identity (IP adress, MAC adress, user names, system names, SSID, email adress,...)
		Tampering = unauthourized changes of data in transit or in storage, affects integrity and availability
		Repudiation = ability to deny having performed an action, may result in innocent third parties being blamed
		Information disclosure = revelation or distribution of private/confidential information
		Denial of Service = prevent authorized source of a resource, through flaw exploitation,/connection overloading/traffic flooding
		Elevation of priviledge = grants greater priviledge to an account

DREAD system to evaluate attack: High/Middle/Low or 3/2/1
		Damage potential = how sever
		Reproducibility = how complicated to reproduce
		Exploitability  = how hard to perform
		Affected users = how many users likely to be attacked
		Discoverability = how hard to discover the weakness

Level of government/military classification (acronyme = US Can Stop Terrorism)
		Top secret	-|
		Secret		-|= Classified
		Confidential	
		Sensitive but unclassified
		Unclassified

Level of Busines/private sector classifications levels
		Confidential (= proprietary,related to company)/Private (related to individuals)
		Sensitive
		Public


====================================================
The CIA triad:

	Confidentiality 
		= assurance that data are restricted from unauthorized subjects
		encryption/cryptography and masking (of input password)
		steganography = a message into an other message
		attacks = social engineering, port scanning, shoulder surfing, eavesdropping (ecoute), sniffing,...
		defend = encryption, network traffic padding, strict access control, rigorous id procedures, data classification, extensive personal training
		3 states of data: at rest / in process (can be hacked) / in transit
		Sensitivity / Discretion / Criticality / Concealment (dissimulation) / Secrecy (secret) / Privacy / Seclusion (isolement) / Isolation
		
	Integrity
		= data are unaltered from their original protected state and modified only by authorized subjects
		attacks = virus, logic bombs, unauthorized access, errors in coding, malicious modification, intentional replacement, system backdoors, code injection...
		defend = strict access control, strict access control, rigorous id procedures, intrusion detection system, object/data encryption, hash total verifications, interface restrictions, input/functions keys, extensive personal training
		CRC / checksum / hashes / MACs
	CSO
	Availability
		= authorized subjects are granted timely and uninterrupted access to objects
		attack = device failure, software errors, environmental issues, object destruction, communications destructions, DoS, DDoS
		defense = monitoring performance and network traffic, using firewalls and routers (DoS), redundancy /back up of critical systems, BCP: fault tolerance features and global elimination of SPOF
		MTD = maximum tolerable downtime


Other concepts:
	AAA services (Authentication Authorization Accountability)
	= (Identification -> Authentication) -> Authorization -> Auditing (=monitoring) -> Accounting (needs nonrepudiation)
		
	Authorization
		CRUD = Create Read Update Delete
		RBAC =  Role Based Access Control
		RuBAC = Rule -- -- --
		DAC = Discretionary Access Control
		MAC = Mandatory Access Control
		
	accountability (responsabilité) = auditing
	Layering = multiple controls in a series

Security gouvernance
	= collection of practices related to supporting, defining and directing the security efforts of an org
	= needs to be global and managed throughout the organization
	top-down (or bottom-up = rarely used) from senior management to IT staff
	Information Security Team (InfoSec) should be lead by a Chief Security Officer (CSO)
	3 levels of planning: Strategic (5years updated annually) > Tactical (1years)> Operational (monthly or quarterly)

	Level of government/military classification (acronyme = US Can Stop Terrorism)
		Top secret	-|
		Secret		-|= Classified
		Confidential	
		Sensitive but unclassified
		Unclassified

	Level of Busines/private sector classifications levels
		Confidential (= proprietary, related to company)/Private (related to individuals)
		Sensitive
		Public

Security Roles
	Senior Management
		= organization owner, ultimately responsible for the security maintained, make decisions, sign off on all policy issues
	Security professional
		= write and implement security policy
	Data Owner
		= high level manager responsible for data protection, classify info for placement
	Data Custodian	(FR=gardien)	
		= user responsible for task of implementing (performing and testing backup; validates data integrity, deploy security solutions, manage data storage)
	User
		= any person with access to the secured system, should understand and uphold security policy
	Auditor
		= responsible for reviewing and verifying security policy adequacy and implementation

Control Frameworks (FR=cadres)	
	COBIT 5 (Control Objective for Information and Related Technology) by 	
		1. Meeting Stakeholder Needs
		2. Covering the enterprise end-to-end
		3. Applying a single, integrated framework
		4. Enabling a Holistic Appoach
		5. Separating Governance from Management
	
	Operational Security = due care (=using reasonable care to protect) + due diligence (continued application of this security structure)

Security Policy, standards, procedure and guidelines
	
	Security Policy
		= top tier of the formalization
		defines scopes and discusses assets
		= strategic plan
		3types: regulatory (legal standards) 
			advisory (acceptable behaviour and activities)
			informative (support, research, background of the above)
	Standard
		= next tier after policy
		defines compulsory requirements for the homogenous use of HW,SW, techno, and security control
		tactical

	Baselines
		= next tier after standard
		common fundational secure state
		system specific (TCSEC, ITSEC, NIST)

	Guidelines
		= same level as baselines
		operational guide
		outline methodology, suggested actions, not compulsory (FR=obligatoire)		

	Procedure
		= final element of formalized Security Plicy
		= step-by-step how-to document
		must be kept separate for each system

	Policy > Standard > Baselines / Guidelines > Procedures

	Threat Modeling
		=identifies potential harm, probability of occurence, priority of concernand means to eradicate or reduce the threat
		proactive approach / defensive approach

	Fuzz testing
		=specialized dynamic testing technique that provides many different types of input to stress its limits and find undetected flaws

Identifying Threats
	
	focused on Assets
	focused on Attackers
	focused on Software
	Microsoft provide STRIDE model (Spoofing, Tampering, Repudiation, Information disclosure, Denial of Service, Elevation of priviledge)
		Spoofing = access through falsified identity (IP adress, MAC adress, user names, system names, SSID, email adress,...)
		Tampering = unauthourized changes of data in transit or in storage, affects integrity and availability
		Repudiation = ability to deny having performed an action, may result in innocent third parties being blamed
		Information disclosure = revelation or distribution of private/confidential information
		Denial of Service = prevent authorized source of a resource, through flaw exploitation,/connection overloading/traffic flooding
		Elevation of priviledge = grants greater priviledge to an account

Diagramming potential attack
	= data flows diagram
	integrates users, processors, applications, datastores and other essential elements
	= high level overview

reduction analysis
	= decomposing the application, system or environment
	= understanding logic of product and interactions with external elements
	5 key concepts:
		Trust boundaries = any location where level of trust or security changes
		Data Flows paths = movement of data
		Input points = location of external input
		Priviledge operations = activity that requires greater priviledge (system changes or alter security)
		Detail about security stance and approach = security policy, foundations and assumptions

Prioritizations and response
	DREAD system to evaluate attack: High/Middle/Low or 3/2/1
		Damage potential = how severe
		Reproducibility = how complicated to reproduce
		Exploitability  = how hard to perform
		Affected users = how many users likely to be attacked
		Discoverability = how hard to discover the weakness

Evaluating third party for security integration
	On-site assessment
	Document exchange and review
	Process/policy review


tenets (FR: principes) of secure architecture and design
	how much security is enough ?
		security isnt free -> trade
		proper balance cost/benefit analysis
	defense in depth
		no one mechanism -> defense indepth / layered defense
	fail-safe
	KISS principle: Keep It Simple
	Open design
	Consider the weakest link = users !
	redundancy
	dual control

======================================================================================================================
Chapter 2
Personal security and Risk management Concepts

======================================================================================================================

Quantitative risk analysis
	= concrete probability percentages
	1.Assign Asset Value (AV), in $		
	2.Exposure Factor (EF) = loss potential, in %
	3.Calculate single loss expectancy (SLE), in $, SLE = AV * EF
	4.Assess the annualized rate of occurence (ARO), = probability determination, in unit/year
	5.Derive the annualized loss expectancy (ALE), in $/year, ALE = ARO * SLE
	6.Perform cost/benefit analysis of countermeasures, needs calculate new ALE with implemented countermeasure
		(safeguard often reduce ARO, not AV nor EF)
		-> Annual Cost of Safeguard (ACS) = ALE before safeguard - ALE after implementing safeguards

6 step RMF (Risk Management Framework)
	1.security categorization based on impact analysis
	2.security control selection = initial set of baseline security control
	3.security control implementation = describe how
	4.security control assessment = 
	5.information system assessment (FR=evaluation)
	6.security control monitoring


======================================================================================================================



Personal security policies
	people = weakest link in the security chain
	job description = first description of security needs
	
	seperation of duties
		= critical, significant and sensitive work tasks are divided among several individual admin
		= principle of least priviledge to admin
		= protection against collusion (= ocurrence of negative activity undertaken by two or more people)
	Job responsabilities
		= specific work tasks an employee is required to perform one regular basis	
		principle of least priviledge
			= users should be granted the minimum amount of access necessary
			requires low-level granular access control
	Job rotation
		= rotating employees among multiple job positions
		provides knowledge redundancy
		reduces risk of fraud, data modification, theft, sabotage, and misuse of info
			< person become familiar and expand privileges and access
			< easier to detect by another employee who knows job position -> peer auditing, protect collusion
		cross-training =alternative to job rotation

	Collusion
		= several people work together to perpetrate a crime
	
employment agreement policies
	NDA Non Disclosure Agreement
	NCA Non Compete Agreement

employment termination processes
	strong relation between security department and HR -> minimize risk during termination
	ex-employee must return all company property, network access should be terminated
	
SLA = important when using any type of third party service provider, including cloud services
	system uptime
	Maximum consecutive downtime (MCD)
	Peak Load
	Average Load
	Responsabitlity for diagnostics
	Failover time (if redundancy)

Compliance = act of conforming to or adhering to rules, policies, regulations, standards or requirements
	
Privacy
	= active prevention of unauthorized access to information
	= freedom from unauthorized access to information
	= freedom from being observed, monitored or examined without consent
	Personally Identifiable Information PII = data item that can traced back to the person of origin
		= phone number, email address, mailing address...
	Health Insurance Portability and Accountability Act (HIPAA)
	Sarbanes-Oxley Act of 2002 (SOX)
	Payment Card Industry Security Standard (PCI DSS)
	
Security Governance
	= collection of practices related to supporting, defining and directing the security efforts of an organization
	= related with corporate and IT governance
	Third party governance = system of oversight that may be mandated by law, regulations, industry standards, contractual obligation or licensing requirements
		usually involves an outside investigator or auditor
	Documentation review
		ATO Authorization To Operate
		TATO Temporary Authorization To Operate
	
Risk Management concepts
	Security = prevents loss or disclosure of data while sustaining authorized access
	Risk = possibility that something could happen to damage, destroy, or disclose data or other resource
	primary goal of risk management = reduce risk to an acceptable level
	risk analysis = process of risk management achieving
		= examining an environment for risks, evaluating each threat event, create cost/benefit report

Risk Terminology
	Asset = anything within an environment that should be protected
	Asset Valuation	= dollar value assigned to an asset
	Threats	= potential occurrence that may cause to undesirable outcome for an org or for aspecific asset
		threats agents = people or programs, HW, systems
		threats events = accidental and intentional exploitations of vulnerabilities
				= natural or manmade
	Vulnerability =	weakness in an asset or weakness (or abscence) of a safeguard or countermeasure
		= flaw, loophole, oversight, error, limitation, failty...
	Exposure = being susceptible to asset loss because of a threat
		exposure to realized threat = experienced exposure
	Risk = possibility that a threat will exploit a vulnerability to cause harm to an asset
		risk = threat * vulnerability
	Safeguards (=countermeasures) = anything that removes or reduces vulnerabilities against one or more specific threats
		= only means by which risk is mitigated or removed
		reduces the ARO (annualized rate of occurence)
	Attack = exploitation of a vulnerability by a threat agent
	Breach = occurence of a security mechanism being bypassed by a threat agent
	
	THREATS exploits VULNERABILITIES which results in EXPOSURE which is RISK which is mitigated by SAFEGUARDS which protect ASSETS which are endangered by THREATS

Identifies threats and vulnerabilities
	=list of possible threats = threat agents + threat events
	
	Viruses
	Cascade errors
	Criminal activity by authorized users
	movements
	intentional attacks
	reorganization
	authorized under illness or epidemics
	malicious hackers
	disgruntled (FR=mécontent) employees
	users errors
	natural disasters
	physical damage
	misuse of data
	changes or compromises to data classification or security policies
	Government, political, or military intrusions
	processing errors, buffer overflow
	personal priviledge abuse
	temperature extrems
	energy anomalies (static, EM pulse, radio freq, power loss)
	loss of data
	info warfare
	bankruptcy, or interruption of business activity
	coding/programming errors
	intruders (physical and logical)
	environmental factors (gases, liquid, organisms)
	equipment failure
	physical theft
	social engineering

risk assessment/analysis
	= should be performed by a team rather than a single individual
	= use consultant cavalry
	= should be understood and approved by upper management
	quantitative risk analysis -> real dollar figures
	qualitative risk analysis -> subjectives and intangible values
	
Quantitative risk analysis
	= concrete probability percentages
	1.Assign Asset Value (AV), in $		
	2.Exposure Factor (EF) = loss potential, in %
	3.calculate single loss expectancy (SLE), in $, SLE = AV * EF
	4.Assess the annualized rate of occurence (ARO), = probability determination, in unit/year
	5.Derive the annualized loss expectancy (ALE), in $/year, ALE = ARO * SLE
	6.Perform cost/benefit analysis of countermeasures, needs calculate new ALE with implemented countermeasure
		(safeguard often reduce ARO, not AV nor EF)
		-> Annual Cost of Safeguard (ACS) = ALE before safeguard - ALE after implementing safeguards
	
Qualitative Risk Analysis
	= scenario based more than calculator based
	= rank threats on a scale to evaluate their risks, costs and effects
	techniques = brainstorming, delphi technique,...
	
	scenario
		= written description of a single major threat
	Delphi technique
		= anonymous feedback-and-response process used to enable a group to reach an anonymous consensus
		
Risk assessment/Acceptance
	4 possible response to risk
		reduce or mitigate > implementing of safeguards
		assign or transfer > insurance and outsourcing
		accept > risk tolerance or risk apetite (valuation by management of the cost/benefice analysis)
		reject or ignore > unacceptable possible response
		
	Residual risk = risk remaining after implementing safeguards
	Total risk = threats * vulnerabilities * asset values
	total risk - controls gap = Residual risk

countermeasure selection and assessment
	Countermeasure should
		relies on cost/benefit analysis
		costs < AV
		costs < benefit of countermeasure
		not be dependant on secrecy: "security through obscurity" is not viable
		be testable and verifiable
		be consistent to all users and resources
		few or non dependencies ro reduce cascade failures
		tamperproof (FR=infalsifiable)
		accessible to only priviledge operators
	security should be designed to support and enable business tasks and functions: CM evaluated in that context

Implementation
	Technical
		= authentication methods, encryption, constrained interface, access control list, protocols, firewalls, routers, IDS, clipping (=coupure) levels
	administrative
		defined by org's security policy and other regulations or requirements
		focus on personal and business
		= policies, procedures, hiring practices, background checks, data classifications, security awareness, trainings, vacations history, reports, work supervision, personal control, testing
	Physical
		= can be physically touched
		= guards, fences, motion detectors, locked doors, sealed windows, lights, cable protections, laptop locks, badges, swipe cards, guards dogs, video cameras, mantraps, alarms
	
	Types of control
		access control = ensuring only authorized users can access
		fence = perimeter defining device

		deterrent
			= deployed to discourage violation of security policies
			= policies, security awareness policies, locks, fences, security badges, guards, mantraps, security cameras
		preventive
			= stop unwanted on unauthorized activity from occuring
			= fences, locks, biometrics, mantraps, lighting, alarm systems, separation of duty, job rotation, data classification, penetrating testing, AC methods, encryption, auditing, callback procedures, security policies, IPS (intrusion preventive systems) 
		detective
			= discover detect unwanted activity
			operates after the fact
			= security guards, motion detectors, recording, job rotation, mandatory vacation, audit trails, honeypot or honeynets, IDS, violation reports, supervision and reviews of users, and incident investigations
		compensating
			= provide various options to other existing controls
		corrective
			= modifies the environment to return systems to normal after an unwanted activity
			= antivirus, backup and restore, rebooting a system,...
		recovery
			= extension of corrective controls, but more advanced and complex
			= backup and restore, fault tolerant drive systems, system imaging, server clustering, antivirus, DB or VM shadowing
		Directive
			= direct, confine, or control the actions of subjects to force compliance to security policy
			= posted notifications, escape route exit signs, monitoring, supervision, procedures

	Monitoring and Measurement
		security control should be quantified, evaluated, or compared
		not always an absolute value
		
	Asset Valuation
		=assign to an asset a specific $ value
		
	Continuous improvement
		risk analysis/risk assessment is a point in time metric
		threat is always changing
		security is always changing

	Risk Framework
		= guideline
		primary defined by NIST (National Institute of Standards and Techno)
		6 step RMF (Risk Management Framework)
			security categorization based on impact analysis
			security control selection = initial set of baseline security control
			security control implementation = describe how
			security control assessment
			information system assessment (FR=evaluation)
			security control monitoring
		
		Operationnaly Critical Threat, Asset and Vulnerability Evaluation (OCTAVE)
		Factor Analysis of Information Risk (FAIR)
		Threat Agent Risk Assessment (TARA)
	
	Manage Information Security Education
		Awareness
			= posters, notices, newsletter, screen savers,...
		Training
		Education
		

============================================================================================================

Chapitre 3:
Business Continuity Planning

BCP 4 main steps:
		Project scope and planning
		Business impact assessment
		Continuity Planning
		Approval and implementation

SLE = AV * EF
ALE = SLE * ARO
ALE = AV * EF * ARO

============================================================================================================

Planning for Business Continuity
	involves assessing the risks to organizational process and creating policies, plan, and procedure to minimize impact
	used to maintain continuous operations in the event of an emergency situation
	if continuity is broken, processes have stopped and the org is in disaster mode: disaster recovery planning (DRP) takes over 

	BCP 4 main steps:
		Project scope and planning
		Business impact assessment
		Continuity Planning
		Approval and implementation
	
Project scope and planning
	requires:
		structured analysis from crisis planning point of view
		creation of BCP team approved by senior management
		assessment of the resources available
		analysis of the legal and regulatory landspace

	Business Organisation Analysis
		areas to consider:
			operational department responsible for the core services the business provides to its clients
			critical support services
			Senior executives and other key individuals

	BCP team selection
		should include:
			representatives from each of the organisation's departments responsible
			representatives from the key support department identified by the organizational analysis
			IT representatives whith technical expertise
			security representatives
			legal representatives
			senior management
		should be diverse but work in harmony !
		
		senior management:
			setting priorities
			providing staff and financial resources
			arbitrating dispute about the criticality of services

		resources requirements: 3 phases, requires most human resources efforts
			BCP Development
			BCP testing training and maintenance
			BCP implementation
				
	Legal and Regulatory Requirements
	
Business impact assessment (BIA)
	Quantitative decision making = numbers and formulas to reach a decision
	Qualitative Decision Making = takes non-numerical factors, like emotions, investor/customer confidence, workforce stability
		leads to categories of prioritizations (high/medium/low)

	Identify Priorities
		= comprehensive list of business processes and ranking them
		divide the workload among the BCP team members
		draw up a list of Organizational assets and assign AV
		set up the MTD and RTO (Recover Time Objective)
			goal of BCP: RTO < MTD

	Risk Indentification
		natural risks and man-made risks
		
	Cloud:
		contract is not normally sufficient due diligence when choosing a cloud provider
		SOC (Service Organizational Control) is often made by an independant auditing firm
			SOC-1 covers only internal controls over financial reporting
			SOC-2, SOC-3: security, privacy and availability controls
		AICPA (American Institute of Certified Public Accountants) maintains consistency between auditors
	
	Likehood assessment
		expresses in term of ARO
		helps from USGS (US Geological Survey) or FEMA (Federal Emergency Management Agency)
		
	Impact Assessment
		uses EF, SLE and ALE
		SLE = AV * EF
		ALE = SLE * ARO
		ALE = AV * EF * ARO
		
		qualitative point of view:
			loss of goodwill among our client base
			loss of employees to other jobs after prolonged downtime
			social/ethical responsabilities
			negative publicity

	Resource prioritization
		combine quantitative and qualitative lists into a single prioritized list
	
Continuity Planning
	
	Strategy development = bridges gap between the business impact assessment and the continuity planning phases of BCP dev
		
	Provisions and processes = people, building and infra

		people
			= most valuable assets
			needs shelter and food

		building and facilities
			identify critical facilities
			Hardening provisions = outline mechanisms and procedures that can be put in place to protect existing facilities
			Alternate Sites = identify alternate sites where business activities can resume immediately

		Infra
			often IT backbone of communications and computer systems that process orders, supply chain, customer interactions
			Physically hardening systems
			Alternative Systems

	Plan Approval = needs top-level endorsement of the plan
	Plan Implementation = BCP team should supervise the conduct of an appropriate BCP maintenance program
	needs Training and Education

BCP Documentation
	benefits:
		ensures BCP personal have a written continuity doc to reference in case of emergency
		historical record of the BCP process
		forces team members to commit their thought to paper

	Continuity Planning goals
		should be decided on at or before first BCP team meeting and remain unchanged
		= ensure the continuous operation of the business in the face of an emergency situation

	Statement of importance
		reflect the criticality of the BCP to the org's continued viability
		commonly takes the form of a letter to the org's employee
		need to put out the letter under the signature of the CEO
		
	Statement of Priorities
		flow directly from the the identify priorities phase of the business impact assessment
		
	Statement of Organization Responsability
		"business continuity is everyone's reponsability"
		comes from a senior-level executive
		can be incorporated into the same previous letter

	Statement of Urgency and Timing
		expresses the criticality of implementing the BCP and outlines the implementation timetable
	
	Risk assessment
		recaps decision making process undertaken during the business impact assessment
		AV EF ARO SLE ALE should be included
	
	Risk assessment / mitigation
		contain outcome of the strategy development portion of the BCP process
		stated acceptable risks
		outlines provision and processes put into place for unacceptable risks
	
	Vital Record Program
		identify and find vital records
	
	Emergency-Response Guidelines
		outline the organizational and individual responsabilities for immediate response to an emergency situation
			immediate response procedures
			list of individual who should be notified
			secondary response procedures

	Maintenance
		BCP doc and plan must be living doc
		BCP team should meet periodically
		practice version control
		
	Testing and exercices
		BCP doc should outline a formalized exercice program

============================================================================================================

Chapter 4
Laws, regulations, and compliance

============================================================================================================
1994 CFAA Amendments
1987 Computer Security Act (CSA)
1991 Federal Sentencing Guidelines
1996 National Information Infra Protection Act
1995 Paperwork Reduction Act 
2000 Government Information Security Reform Act (GISRA)
2002 Federal Information Security Management Act (FISMA)
1986 Computer Fraud and Abuse Act (CFAA)

copyrights
trademarks
patents
trade secrets

============================================================================================================

Categories of Law
	criminal law: protect society, prosecuted by federal and state gov
	civil law: framework for transaction of business, court and argued by the two affected party
	admin law: used by government agencies to effectively carry out day-to-day business

	federal laws -> federal courts system
	state laws 

Laws

Computer Crime

	Computer Fraud and Abuse Act
		Comprehensive Crime Control Act (CCCA) in 1984
			access classified info or financial info
			access a computer used exclusivly be the federal gov
			use federal computer to perpetrate a fraud
			cause malicious damage to a federal computer
			modify medical records in a computer
			traffic in computer password if it affects interstate commerce or federal computer system
		
		amended by Computer Fraud and Abuse Act (CFAA) in 1986: move to all "federal interest" computers
			any computer used exclusively by the US government
			by financial institution
			by the government or a financial institution when the offfense impedes (FR=empecher) the ability of the gouv or institution to use that system
			any combination of computers used to commit an offense, even not located in the same state


		1994 CFAA Amendments
			outlaws the creation of any type of malicious code that might cause damage to a computer system
			modified the CFAA to over any computer used in interstate commerce
			allowed for the imprisonment of offenders
			provides legal authority for the victims of computer crime to pursue civil action
		
			2015 CFAA bring computer crimes into the scope of Racketeer Influenced and Corrupted Organization Act (RICO)	
		
		1987 Computer Security Act (CSA)
			NIST responsible for developing standards and guidelines
			provides enactment of such standards and guidelines
			require the establishment of security plans by all operators of federal computer system
			require mandatory periodic training for all people involved in management, use, or operation of federal computer systems

			devides reponsability among 2 federal agencies: NSA (classified systems) and NIST(all other federal gov system)
		
		1991 Federal Sentencing Guidelines
			prudent man rule: senior executives ensures due care
			minimize punishment for infractions by demonstrating due diligence
			3 burden of proof for negligence:
				legally recognized obligation
				failed to comply with recognized standards
				causal relationship between the act of negligence and subsequent damages

		1996 National Information Infra Protection Act
			broadens CFAA to cover computer systems used in international commerce
			extends similar protections to portions of the national infra other than computing systems (railroads, pipelines...)
			treats any intentional or reckless (FR=temeraire,imprudent) act that cause damage as felony

		1995 Paperwork Reduction Act 
			agencies must obtain Office of Management and Budget (OMB) approval before requesting most types of information from the public
			
		2000 Government Information Security Reform Act (GISRA)
			provides a comprehensive framework for establishing the effectiveness of controls over information resources
			recognized the higly networked nature of the federal computing environment
			provides effective government-wide management and oversight
			provides for development and maintenance of minimum controls
			provide a mechanism for improved oversight of federal agency information security programs
			creating concept of "mission-critical system"
				= national security system by other provisions of law
				protected by procedures established for classified information
				the loss, misuse, disclosure, or unauthorized access to or modification of any information it processes have impact on the mission of an agency
			
		2002 Federal Information Security Management Act (FISMA)
			federal agencies implement an information security programs for agency operations
			government agencies include the activity of contractor
			NIST implement following elements:
				periodic assessment of risks
				policies and procedures that are based on risk assessment
				subordinate plans for providing adequate information security
				security awareness training
				periodic testing and evaluation of efffectiveness
				process of planning, implementing, evaluating, dans documenting
				procedures for detecting, reporting, and responding
				plans and procedures to ensure continuity of operations

Intellectual Properties
	= coca-cola recipe
	copyrights, trademarks, patents, and trade secrets
	

	Copyrights and the Digital Millenium Copyright Act
		garanties the creators of "original works of authorship" protection, 8 broad categories
			literacy (including computer software), musical, dramatic, pantomines and choreographic, pictoral/graphical/sculptural/motion pictures/sound, architectural
			extended to "look and feel" of GUI < consult a qualified intellectual property attorney
		creator of work has an automatic copyright from the instant the work is created
		copyright ownership default to the creator except for "work for hire" (employee in workday hours)
		70 years after the death of the last surviving author
		works for hire and anonymous work: 95y from first publication and/or 120y from date of publication
		
		Digital Millenium Copyright Act (DMCA) provides compliance to World Intellectual Property Organization (WIPO)
			up to 1M$ and 10y imprisoned
			exemption to service provider:
				transmission must be initiated be a person other than the provider
				transmission, routing, provision of connections, or copying carried out by an automated technical process
				provider must not determine the recipients of the material
				intermediate copies must not be accessible to anyone other
				material must be transmitted with no modification to its content
				provisions allow the breation of backup copies of computer software
				emerging field of webcasting or broadcasting

		Anti-Counterfeiting Agreement (ACTA)

	Trademarks
		words, slogan, and logos to identify a company and its products
		automatic protection if used trademark for public activity
		can register to the US Patent and Trademark Office (USPTO)
			from "TM" symbol to "R circled" symbol
			can be done on trademark intended to used but not yet used (= "intent to use" application)
		2 requirements:
			+trademark must not be similar to another trademark (due diligence search)
			+should not be descriptive (ex.: "Mike's Software Company" not approved)
		10y period renewed unlimited successive 10y period

	Patents
		protects intellectual property rights of inventors
		20y inventor granted exclusive rights to use the invention
		Must be new, useful and working, not be obvious
			
	Trade Secrets
		= absolutly critical to the business and significant damage would result if it were disclose
		ex.: manufactuging process, advanced statistical model
		2 majors issues:
			filling copyright and patent disclose the invention
			copyrights and patents are limited in time				
			
	Licensing
		contractual license agreements use written contracts between software vendor and customer	
		shrink-wrap license agreements written outside the software packaging
		click-through license agreements, during installation process
		cloud services agreements: link and checkbox for confirm
		UCITA: Uniform Computer Information Transactions Act
			provides common framework for the conduct of computer-based business transactions
		BSA Business Software Alliance

	Import/Export
		complex set of regulations governing the export of sensitive HW and SW products

	Encryption Exports Controls
		DCBIS Department of Commerce Bureau of Industry and Security
		
	Privacy
		ACLU American Civil Liberties Union
		
	US Privacy Law
		4th amendment
			right of the people to be secure in their persons, houses, papers and effects, against unreasonable search and seizures
		1974 Privacy Act
			severely limits the ability of Federal Government agencies to disclose private info
			provides formal procedure for individual to gain access to records the gov maintains and to request that incorrect records be amended
		1986 ECPA Electronic Communications Privacy Act
			crime to invade the electronic privacy of individual
		1994 CALEA Communications Assistance for Law Enforcement
		1996 Economic and Protection of Proprietary Information Act
		1996 HIPAA Health Insurance Portability and Accountability Act
			HMO Health Maintenance Organization
		2009 HITECH Heath Information Technologue for Economic and Clinical Health
			amended HIPAA -> HIPAA Omnibus Rule in 2013
			how to treat Business Associates (BA)
				Protected Health Information (PHI)
				Business Associates Agreement (BAA)
			 HITECH breach information rule: notify affected users of HIPAA-covered entity whose experience data breach
				vary from state to state
				include: Social Security Number / Driver's license number / State identification number / Credit or debit card / Bank account number / medical records / health insurance info
		1998 Children's Online Privacy Act COPPA
			parents opportunity to review any information collected from their children and permanently delete
	
	1999 Gramm-Leach-Billy Act (GBLA)
		strict governmental barrier between financial institutions
		limitations on the type of information that could be exchange among subsidiaries of same corporation

	2001 USA PATRIOT Act
		Providing Appropriate Tools Required to Intercept and Obstruct Terrorism
		broden law inforcement
		ISP (internet service provider) may provide government with large range of information
		
	Family Educational Rights and Privacy Act (FERPA)
		inspect and request correction to any educational records
		schools not release personal information from students records

	1998 Identity Theft and Assumption Deterrence Act
		extend victim to person whose identity was stolen

	Privacy in workplace
		reasonable expectation of privacy for letter, not for postcard or any use of employer-owned communications equipment
		company should take reasonable precautions to ensure no implied expectation of privacy
			clauses in employement contracts, statements in corporate acceptable use, logon banner, warning labels
	
	European Union Privacy Law
		1995 4 October procsessing of personal data must require:
			consent, contract, legal obligation, vital interest, balance between interests of data holder and data subject, right to acc, right to know data source,right to correct, right to withhold consent, right to leagal action (safe harbor principle)
		US companies conducting business in europe must meet:
		notice, choice, onward transfer, acces, security;data integrity, enforcement

	Compliance
		PCI DSS compliance 12 main requirements: (PCI DSS Standards)
			install and maintain firewall to protect cardholder data
			not use vendor suppplied defaults for system passwords
			protects stored cardholder data
			encrypt transmissions of cardholder
			protect all system against malware
			develop and maintain secure systems
			restrict access to cardholder data
			identigy and authenticate access
			resctrict phycisal acces
			maintain a policy
	
	Contracting and Procurement
			security professional should conduct reviews of security controls put in place by vendors, during initial vendors selection and evaluation process
				what type of sensitive data are stored
				what controls are in place
				what encryption algorithm and key lenght are used
				what types of security audits does the vendor perform
				does vendor relies on any other third party
				where will data storage processing and transmission take place
				what is the vendor incident response process
				what provision are in place to ensure ongoing intergrity		
	


============================================================================================================

Chapter 5
Protecting Security Assets

============================================================================================================
7 principles to opt for US company to the EU program:
	Notice: org must inform individuals aout the purpouse of collecting data
	Choice: org must offer opportunity to opt out
	Onward transfer: org can only transfer data to other than organizations that comply with Notice et Choice principles
	Security: must take reasonable precautions to protect data
	Data integrity: may not use info ffor other purpose that stated in notice and choice principles, must insure data is reliable
	Access: individuals must have access to personal information that the org holds
	Enforcement: org must assure compliance with the principles

Identifying Data roles
	Data owners
	System Owners
	Business/Mission Owners
	Data Processors
	Administrators
	Custodians
	User


============================================================================================================


Classifying and labeling assets

	assets = sensitive data, hardware used to process it and media use to hold it

	Defining Sensitive Data
		=/= public or classified
		= confidential, proprietary, protected

		Personally identifiable Information PII
			distinguish or trace someone: name, social security nimber, date and place of birth
			linked or linkable to someone: medical, educational, financial

		Protected Health Information PHI
			HIPAA Health Insurance Portability and Accountability Act mandates protection of PHI
			= information created or received by health care provider, health plan, public health authority...
			= information that relates the past, present or future physical or mental health
		
		Proprietary data
			= any data that helps an org maintain a competitive edge
			= SW code, tech plans, internal processes, intellectual property, trade secrets
			competitors access proprietary data can serouisously affect the primary mission of org
			APT Advanced Persistent Threat
				APT1 stealing 6.5TB of compressed intellectual property data

		Defining Classifications
			Government data classifications:
				top secret = disclosure cause exceptionnaly grave damage to national security
				Secret = disclosure cause serious damage to national security
				Confidential = disclorue cause damage to national security
				Unclassified = not top secret, or scret or confidential = available to anyone
			
			Non government classifications:	
				Class 3 to Class 0
				Confidential (or Proprietary) = Class 3 = Top secret
				Private = Classe 2 = Secret
				Sensitive = Class 1 = Confidential
				Public = Classe 0 = Unclassified

			Confidential or Proprietary
				= disclosure cause exceptionally grave damage to the mission of org
			Private
				= should stay private but doesn't meet Confidential definition
			Sensitive
				= disclosure could cause damage to the org
			Public
				= unclassified = posted in web site, brochure, or any public source
				but need integrity (no modification from outside)

			CISSP Candidate Information Bulletin = sensitive info		
			
		Defining Data Security REquirements
			Advanced Encryption Standard with 256-bit cryptography keys(AES 256)
			Data Loss Presention Server (DLP) detects labels and apply protection
			
		Understanding Data States
			at rest, in motion/in transit, in use
			encryption protocol, strong authentication and authorization

	Managing sensitive data
		= prevent data breach
				= any event in which an unauthorized entity is able to view and access sensitive data
				15 data breach reported a week
	
		Marking sensitive data
			= labeling = identify classification level
			UUID Universally Unique Identifier
			some DLP adds metadata tags to documents
			specific desktops backgrounds
			rarely downgrade classified data, recommanded to destroy and replace

		Handling sensitive data
			marks also Back up !!
			
		Storing sensitive data
			protection 
			encryption built-in to encrypt data at file level and disk level
			uses Heating, Ventilation and Air Conditioning HVAC
		
		Destroying sensitive Data
			= cannot fall into wrong hands and result in unauthorized disclosure
			Data remanence = data that remains on a hard drive as residual magnetic flux
			Degaussers using power, only effective on magnetic media
			SSD cant be sanitized -> NSA requires SSD should be disintegrate = 2mm or smaller pieces
			
			Erasing = delete operation against a file, or selection of files, or entire media
				in most cases, the deletion only remove directory or data link to the file
			Clearing (or overwriting) = process of preparing media for reuse
				1. First character = 	1010 0001
				2. Complement =		0101 1110
				3. Random bits =	1101 0100
			Purging = more intense clearing that prepares media for reuse in less secure environment
			Declassification = purges media or system in preparation to reuse in a unclassified environment
			Sanitization = combination of processes that removes data from a system or from media
			Degaussing = creating a strong magnetic field that erases data on some media
				does not affect optical
				often destroy electronics on Hard Drive
			Destruction = incineration, crushing, shredding, disintegration, disolving
				some remove platters and destroy them seperatly

		Retaining Assets
			apply to data or records, media, systems, personel
			record retention
				often dicted by laws, regulations, and standards
				
	Protecting Confidentiality with crypto
		
		Symmetric cryto
			= uses same key to encrypt and decrypt data
			Advanced Encryption Standard (AES)
				= most popular symmetric encryption algorithm
				replaces Data Encryption Algorithm (DEA) in 2001	
				ex.: bitlocker, Microsoft Encrypting File System (EFS)
				uses 112-bits 168-bits or 256-bits
			Triple DES (or 3DES)
				uses 56-bits key but newer use 112-bits or 168-bits
				ex.: Microsoft OneNote, System Center Configuration Manager
			Blowfish
				created by Bruce Schneier
				uses 32 bits to 448 bits
				ex.: Linux systems uses bcrypt, bcrypt based on blowfish
				adds 128 additional bits as a salt to protect against rainbow table attacks

		Transport Encryption
			before data is transmitted, for data in transit 
			primary risk for in transit data is sniffing
			HTTPS (Hypertext Transfer Protocol Secure) uses Transport Layer Security (TLS)
			=/= HTTP transmits data in cleartext
			Secured Sockets Layer (SSL) = presursor of TLS = created by Netscape
			Internet Engineering Task Force (IETF)
			IETF discovered SSL is sensible to POODLE (Padding Oracle On Downgraded Legacy Encryption) attack
			VPN Virtual Private Network
				uses TLS and IPsec (Internet Protocol Security)
			SSH Secure Shell = strong encryption protocol included in Secure Copy (SCP) and Secure File Transfer Protocol (SFTP)
				=/= FTP transmits data in cleartext
			Telnet sends traffic over the network in cleartext

	Identifying Data roles

		Data owners
			= person who has ultimate organization responsability for data
			= typically CEO, President, or department head (DH)
			= responsible for (NIST SP 800-18)
				establishes rule for appropriate use and protection (rules of behavior = AUP Acceptable Use Policy)
				provides inputs to information system owners regarding the security requirements and security controls
				decides who has access to information systems
				assists in identification and assessment of common security controls

		System Owners
			= person who owns the system that processes sensitive data
			= responsible for (NIST SP 800-18)
				develops system security plans
				maintains system security plan
				ensure system users and support personel receives appropriate security training
				updates the system security plan
				assists in the indentification, implementation and assessment of common security controls
			= typically the same physical person as the data owner
		
		Business/Mission Owners
			NIST 800-018 refers to a program manager or an information system owner
			overlap with the responsabilities of the system owner or bet the same role	

		Data Processors
			= any system used to process data
			or = the person or entity that controls the process of the data
			7 principles to opt for US company to the EU program:
				Notice: org must inform individuals aout the purpouse of collecting data
				Choice: org must offer opportunity to opt out
				Onward transfer: org can only transfer data to other than organizations that comply with Notice et Choice principles
				Security: must take reasonable precautions to protect data
				Data integrity: may not use info for other purpose that stated in notice and choice principles, must insure data is reliable
				Access: individuals must have access to personal information that the org holds
				Enforcement: org must assure compliance with the principles
		
		Administrators
			= responsible for granting appropriate access to personnel
			can assign permissions, based on least priviledge and need to know
			use typically a Role-used access control model

		Custodians
			helps protect the integrity and security of data
			= typically the IT department or system security admin
		
		User
			= any person who access data to accomplish work task
		
	Protecting Privacy
		
		Using Security Baselines
			imaging = capture a single system with desired settings as an image
			deploy the image to other systems
			P-1 = basic security practises
			
		Scoping and tailoring
			scoping = reviewing baseline security controls and select which control applies to org
			tailoring = modifying the list of security controls within the baseline so they align with the mission of the organisation

		Selecting Standards
			

=======================================================================================================================================================

Chapitre 6:
Cryptography and Symmetric Key Algorithms
			
=======================================================================================================================================================
Concepts
	plaintext (P) message = message before put into coded form
	encrypt = uses a cryptoalgorithm to code the plaintext message and create a ciphertext (C) message		
	Keys = cryptoalgotrithm uses keys to maintain their security
	Key space = range of value that are valid for use as a key for a specific algorithm
	Bit Size = key space in difinde by bit size, number of binary bits in the key
	algorithm = set of rules, usually mathematical, that dictates how to enciphering and deciphering processes

Boolean Mathematics
	AND = symbol ^
	OR = symbol inversed of AND
	NOT = symbol ~
	EXCLUSIVE OR (or XOR) = circled +
	Modulo function = symbol mod = symbol %





=======================================================================================================================================================

Historical Milestones in cypto

	Caesar cipher
		= rotate 3 cipher = ROT3
		= substitution monoalphabetic cipher = C3 cipher
		vulnerable to frequency analysis
	
	American Civil War
		Flag Signals
	
	Ultra vs Enigma
		Enigma = German prior to WW2
			3 to 6 rotors to implement substitution cipher
		Ultra = attack Enigma codes
			Polish reconstructed an enigma prototype
			broke Enigma in 1940
		Purple machine = Japanese version of Enigma
			Japan used very formal message formats in communications that helps cryptoanalytic

Crypto Basis
	
	Goals of Crypto
		= confidentiality, integrity, authentication, non repudiation

		Confidentiality
			= data remains private white at rest or in transit (= in the wire, refers to network cables)
			Symmetric key uses a shared secret key available to all user of cryptosystem
			Asymmetric uses individual combinations of public and private keys for each users
		Integrity
			= ensures data not altered without authorization
			protects against all form of alteration
			enforced through the use of encrypted message digests (digital signature)
		Authentication
			= verify claimed identity of system users
		Nonrepudiation
			= assure the recipient that the message is originated by the sendor
			assured only by public key, or asymetric cryptosystems

	Concepts
		plaintext (P) message = message before put into coded form
		encrypt = uses a cryptoalgorithm to code the plaintext message and create a ciphertext (C) message		
		Keys = cryptoalgotrithm uses keys to maintain their security
			= very large binary number
			= cryptovariables
		Key space = range of value that are valid for use as a key for a specific algorithm
		Bit Size = key space in defined by bit size, number of binary bits in the key
				= range of number from 0 to 2^n
		algorithm = set of rules, usually mathematical, that dictates how to enciphering and deciphering processes
		Kerchoff principles
			= Kerchoff's assumption
			= cryptographic system should be secure even if everything in the system , except the key, is public knowledge
			= "The ennemy know the system"
			=/= "security through obscurity"

		
Cryptographic Mathematics

	Boolean Mathematics
		AND = symbol ^
		OR = symbol inversed of AND
		NOT = symbol ~
		EXCLUSIVE OR (or XOR) = circled +
		Modulo function = symbol mod = sumbol %

	One way functions
		= mathematical operation that easily produces output values for each possible combination of inputs but makes impossible to retrieve the input values
	
	Nonce
		= random number that acts as a placeholder variable in mathematical functions
		most recognizable = Initialization vector (IV)
		IVs used to create unique ciphertext everytime the same message is encrypted using the same key

	Zero-knowledge proof
		= prove your knowledge of a fact to a third party without revealing the fact
		Victor stands in entrance A and see Peggy enters in A and returns in B, proving she passed the door

	Split Knowledge
		information divided among multiple users
		see key escrow = crypto keys, digital signatures, and even digital certificates can be stored in a key escrow database
		Minimum number of agent (M)
		Total number of agent (N)
			M always < or = to N
	
	Work Function (or Work Factor)
		strenght of cryptography system is measured by measuring the effort in term of cost and/or time
		size of work function should be matched against the relative value of protected assets
		loses its value over time

	Ciphers
		Codes vs Ciphers
			Codes uses codebook ("I received your communication" = 10.3)
			Ciphers convert message from plaintext to cipher text on a bit basis, character basis or block basis

		Transposition Ciphers
			rearrange the letter in a plaintext message
			decryption algo simply reverses the encryption transformation
			ex.: apple -> elppa
			columnar transposition = uses a keyword
				ex.: "The fighters will strike the ennemy base at noon" with keyword: attacker
					ATTACKER	firt A = 1, next are incremented for 1
					17823546	next letter C is 3 and so on

					THEFIGHT	reading down each collumn in the order given by the keyword -> A A C E K
					ERSWILLS	-> TETEEFWKMTIIEYNHLHAOGLTBOTSESNHRRNSESIEA
					TRIKETHE
					ENEMYBAS
					ESATNOON
			
		Substitution ciphers
			replaces each character or bit with a different character
			ex.: Caesar Cipher = ROT3
					encryption formula: C = (P+3) mod 26		
					decryption formula: P = (C-3) mod 26
			can use polyalphabetic substitution = multiple alphabets in the same message
			ex.: Vigenere cipher (each alphabet is defined by the precedent by rotating one letter to the left)
				ABCDEFGGHIJKLMNOPQRSTUVWXYZ
				BCDEFGGHIJKLMNOPQRSTUVWXYZA
				CDEFGGHIJKLMNOPQRSTUVWXYZAB
				DEFGGHIJKLMNOPQRSTUVWXYZABC
				EFGGHIJKLMNOPQRSTUVWXYZABCD
				...
			
				plaintext = 	ATTACKATDAWN	
				key =		SECRETSECRET	
				cipher = 	SX...		S = A column + S line, X = T column + E line, ...

			vulnerable to period analysis, examination of frequency  based on the repeated use of the key
		
			One-Time pads (or Vernam ciphers)
				= extremely powerful type of substitution cipher
				uses a different substitution alphabet for each letter of the plaintext message
				C = (P+K) mod 26
				Must be:
					randomly generated	
					physically protected against disclosure
					be used only once
					the key must be as long as the message

			Caeser, Vigenere and One-time pads only differ from key length (1 for Caeser, secret=6 for Vigenere, N for One-time pad)
			
			Running key cipher (or book Cipher)
				= use a book to get the key: text of a chapter in Mobydick, starting with the third paragraphe
				ex.: 	P = RICHARDWILL -> 17  8  2  7  0 17  3 22  8 11 11 
					K = WITHMUCHINT -> 22  8 19  7 12 20  2  7  8 13 19
					addition mod 26 -> 13 16 21 14 12 11  5  3 16 24  4			
					C = 		    N  Q  V  O  M  L  F  D  Q  Y  E

		Block Ciphers
			operates on "chunks"
			ex.: transposition ciphers

		Stream Ciphers
			operates on one character or bit at a time
			ex.: caesar cipher
		
		Confusion
			= relationship between the plaintext and the key is so complicatd that an attacker can't merely continue altering the P and analyzing the resulting ciphertext to determine the key
			
		Difusion
			= a change in the P results in multiple changes spread throughout the  ciphertext

Modern Cryptography

	Symmetric Key algorithm
		rely on "shared secret"
		the key is used to encrypt and decrypt data
		= secret key cryptography or private key cryptography

		Key distribution = major problem, needs out-of-band exchange
		does not implement nonrepudiation
		not scalable
		must be regenerated often

		very fast, often 1 000 to 10 000 faster than asymettric algo

		key requirement: for n = number of parties in communication, Numbers of Key = n* (n-1) /2

	Asymmetric key algo
		or public key algo
		each user has 2 keys: 1 public shared with all users, 1 private kept secret
				if the public key encrypts a message, only the private key can decrypt it, and vice versa
		ex.: 	1. Alice encrypts with Bob's public key
			2. Bob decrypts with its private key
			3. Bob replies by encrypting its response with Alice public key
			4. Alice decrypt the answer with its private key
		
		key requirement: for n = number of parties in communication, Numbers of Key = n*2
		assures digital signature techno (recipient can decrypt a message using Bob publics key to assure its been encrypted with bob's private key)

		addition of new user needs only the generation of one pair of keys
		users can be removed far more easely in asymetric systems
		key generation is required only when a user's private key is compromised
		asymmetric can provide integrity, authentication and nonrepudiation
		key distribution is a simple process
		no preexisting communication link needed
		-: very slow

	Hashing Algorithm
		=summaries of the message's content, difficult to derive the message from hash, very unlikely that 2 messages produce the same hash
		MD2/MD5 (Message Digest)
		SHA-0, SHA-1, SHA-2 (Secure Hash Algorithm)
		HMAC (Hash Message Authentication Code)

Symmetric Cryptography

	Data encryption standards
		DES = 64-bits block cipher that has 5 modes of operation:
			
		key = 56 bits long
		uses a long series of exclusive OR, repeated 16 times on each encryption/decryption operation
		each repetition = round, DES performs 16 rounds

		Electronic Codebook Mode ECM
			simplest and least secure
			encrypts the block using the chosen secret key
			same block produces same encrypted block		
			only used for very short message, such as keys or parameters to other modes

		Cipher Block Chaining Mode CBC
			each block of unencrypted test is XORed the block of ciphertext immediately preceding, before it is encrypted using DES algo
			implements an IV and XORs it with the first block of the message
				IV must be sent to the recipient
			CBC errors propagate

		Cipher Feedback Mode CFB
			= streaming cipher version of CBC, operates against data produces in real time
			not block, but memory buffers of the same blocksize

		Output Feedback Mode OFB
			XORs block text with seed value instead of previous ciphered block
			for first block a IV is used to create the seed value
			future seed value are derived by running the DES on the previous seed value
			no chaining function, no propogation of errors

		Counter Mode CTR
			uses a stream cipher similar to CFB and OFB
			uses a simple counter that increments for each operation
			errors dont propagate
			allows to break an encryption of decryption into multiple independant steps: well suited for parallel computing
			
		Triple DES 3DES
			4 versions of 3DES:
				DES-EEE3 mode:first encrypts plain text three times, using K1, K2, K3
					C = E(K1,E(K2,E(K3,P)))
					key lenght: 168bits long

				DES-EDE3 mode:uses 3 keys but replace encryption in second operation by decryption
					C = E(K1,D(K2,E(K3,P)))
					key lenght: 168bits long

				DES-EEE2 mode:uses 2keys
					C = E(K1,E(K2,E(K1,P)))
					key lenght: 112bits long					

				DES-EDE2 mode: uses 2 keys and replace encryption in second operation by decryption
					C = E(K1,D(K2,E(K1,P)))
					key lenght: 112bits long

		IDEA International Data Encryption Algorithm
			Swiss developers	
			developed in response to insufficient key lenght of DES algorithm
			64-bits block of plaintext/ciphertext  but with a 128-bit key
			found in Phil Zimmerman's popular Pretty Good Privacy (PGP)
		
		Blowfish
			Bruce Shneier
			similar to DES and IDEA but variable lenght key from 32bits to 448bits
			longer the key, longer encryption/decryption time
			no license required
			
		SkipJack
			US government in Federal Information Processing Standards (FIPS) 185, the Escrowed Encryption Standard (EES)
			64-bits blocks of text
			80-bits key
			cryptographic routines supporting the Clipper and Capstone encryption chips
			NIST and Department of Treasury hold a portion of the information required to reconstruct a Skipjack key

		Rivest Cipher 5 (RC5)
			by Rivest, shamir and Adleman (RSA) Data Security
			block cipher of variable block sizes (32, 64 and 128 bits)
			key size between 0 and 2 040 bits

		Advanced Encryption Standard (AES)
			October 2000: Rijndael block cipher chosen in replacement for DES
			November 2001: FIPS 197 mandates use of AES/RIjndael for all sensitive but unclassified data by US gov
			3 key lenght: 128, 192 and 256 bits
			AES: 128 bits blocks, but Rindael extends to the key lenght
			number of rounds depend on the key lenght:
				128bits keys require 10 rounds
				192bits keys require 12 rounds
				256bits keys require 14 rounds

		Twofish
			Bruce Schneier
			block cipher
			128 bits blocks of data, key up to 256 bits lenght
			prewhitening = involves XORing the plain text with a separate subkey before the first round of encryption
			postwhitening = similar operation after the 16th round

		
Symmetric key management

	Creation and distibution of symmetric keys

		offline distribution
			physical exchange of key material
			
		Public key encryption
			to set up an initial communications link

		Diffie-Hellman
			1. Richard and Sue aggree on 2 large  numbers: p = prime number, g = integer, 1 < g < p
			2. Richard chooses a random large integer r and creates R = g^r mod p / Sue chooses s and creates S = g^s mod p
			3. richards sends R to Sue and Sue sends S to richard
			4. Richard perform K = S^R mod p and Sue performs K = R^S mop p
			5. Richard and Sue uses K as secret key communication

		Storage and Destruction of Symmetric Keys
			never store the symmetric key into the same system where encrypted data resides
			consider providing 2 different individuals with half of the key
				= concept of split knowledge
			downgrade a user implies key must be changed and all encrypted materials must be reencypted with the new keys
			
		Key Escrow and recovery
			these systems allow government, under limited circonstances such as a court order, to obtain the crypto key
			Fair Cryptosystems:
				secret keys divided in 2 or more pieces, when government obtain legal authority to access particular key, court order 3rd parties and reassembles the secret key
			Escrowed Ecryption Standard:
				provides the government with a technological means to decrypt ciphertext

Cryptographic Life Cycle
	

			 
=======================================================================================================================================================

Chapitre 7:
PKI and Cryptography Applications

=======================================================================================================================================================

Hash Algorithm Memorization Chart:

Hash of variable lenght (HAVAL) - an MD5 variant	128,160,192,224,256 bits hash value
Hash Messaging Authentication Code (HMAC)		Variable
MD2 / MD4 / MD5						128
SHA-1							160
SHA-224							224
SHA-256							256
SHA-384							384
SHA-512							512

5 requirements for hash function, according to RSA:
	input can be of any lenght
	output has a fixed lenght
	relatively easy to compute for any input
	one-way
	collision free (hard to find 2 messages producing same hash value)

Certificate contains specific identifying information governed by standard X.509
	version of X.509 to which the certificate conforms
	Serial number
	signature algorithm identifier
	Issuer name
	Validity Period
	Subject's name
	Subject's public key

=======================================================================================================================================================

Asymetric cryptography
	
	Public and private key
	
	RSA
		depends and computational difficulty in factoring large prime numbers
		1. choose 2 large prime numbers (approx 200 digit each), labeled p and q
		2. compute de product of these number n = p * q
		3. select a number, e, that satisfies the following:
			e < n
			e and (n-1)(q-1) are relatively prime
		4. find a number, d, such that (ed-1) mod (p-1)(q-1) = 0
		5. distribute e and n as the public key, keep d secret as the private key
	
		to encrypt: C = P^e mod n
		to decrypt: P = C^d mod n

		relative equal protection:
			RSA with 1 088 bits key
			DSA with 1 024 bits key
			Elliptic Curve with 160 bits key

	El Gamal
		released into public domain
		the algorithm double the lenght of any message it encrypts: not good for long messages over narrow network

	Elliptic Curve
		y^2 = x^3 + ax + b
		2 points on an elliptic, P + Q, assumes that Q = x P
		very difficult to find x even if P and Q are known

Hash Functions
	take a possibly long message and generate a unique output value (= message digest) derived from the content of the message
	can be used to implement a digital signature algorithm
	message digest = hash value, hash, hash total, CRC, fingerprint, checksum, digital ID
	in most case 128Bits or larger
	according to RSA:
		input can be of any lenght
		output has a fixed lenght
		relatively easy to compute for any input
		one-way
		collision free (hard to find 2 messages producing same hash value)

	SHA Secure Hash Agorithm
		developed by NIST
		SHA-1 takes virtually any lenght (real = 2 097 152 TB) produces a 160 bits digest, processes in 512 Bits Blocks
		SHA-2 has four variants
			SHA-256 256 bits digest using 512 Bits block
			SHA-224 truncated version of the SHA-256 to produce 224 bits digest using 512 Bits Block
			SHA-512 512 bits digest using 1 024 Bits block
			SHA-384 truncated version of SHA-512
		SHA-3 = Keccak algorithm
		
	SHS Secure Hash Standard

	MD2 Message Digest 2
		developped by Ronald Rivest (from RSA) in 1989 for 8bits processor
		16Byte checksum
		pad the message so its lenght is a multiple of 16 Bytes
		128bits message digest using entire message and appended checksum
	
	MD4
		1990
		support 32bits processor
		pads the message to ensure that the message lenght is 64bits smaller than a multiple of 512bits
		processes 512bits block of message  in three round of computation and produce a 128bits digest
		must be avoided, major flaw discovered

	MD5
		= 512 Bits blocks but uses 4 distinct rounds of computation to produce a 128 Bits digest (same as MD2 and MD4)
		subjects to collision
		
Digital Signature
	
	assure the recipient that the message truly came from the claimed sender
	assure the recipient that the message nas not alterred while in transit
		protects against malicious modification and unintentional modification
	rely on a combination of public key cryptography and hashing function
	
	1. Alice generate a message digest of the original plaintext
	2. Alice encrypts only the message digest using her private key, this is the digital signature
	3. Alice appends the signed message digest to the plaintext message
	4. Alice transmits the appended message to Bob

	Bob receives the digitally signed message
	1. Bob decrypts the digital signature using Alice's public key
	2. Bob uses the same hashing function to create a message digest of the full plaintext message received from Alice
	3. Bob compares both message digest, if it matches Bob is sure that the message has been sent by Alice

	-> doesn't provide any privacy, ensure only integrity, authentication and nonrepudiation
	can easely provide privacy by adding a encrypting step 5. Alice encrypt the whole appended message using Bob public key

	HMAC
		implements a partial digital signature: garantees integrity but not nonrepudiation
		can be combined with any standard message digest generation algorithm, such as SHA-2, by using a shared secret key

	Digital Signature Standards
		NIST specifies the digital signature algorithms acceptable for fed gov use in Federal Information Processing Standards FIPS 186-4
			also known as Digital Signature Standards DSS
			all federally approved digital signature algorithm must use SHA-2 hashing functions
		DSS specifies the encryption algorithm that can be used to support a digital signature infra:
			DSA as specified in FIPS 186-4
			RSA as specified in ANSI X9.31
			ECDSA as specified in ANSI X9.62

	To be known:
		Schnorr's signature
		Nyberg-Rueppel's signature

Public Key Infrastructure
	
	Certificates
		provide communicating parties with the assurance that the people they are communicating with truly are who they claim to be
		= endorsed copies of an individual's public key
		contains specific identifying information governed by standard X.509
			version of X.509 to which the certificate conforms
			Serial number
			signature algorithm identifier
			Issuer name
			Validity Period
			Subject's name
			Subject's public key
		X.509 is not an official standard but Microsoft and Mozilla have adopted it as their de facto standard for Secure Sockets Layer (SSL) communications

	Certificates Authorities
		to obtain a digital certificate from a reputable CA, you must prove your identitfy to the satisfaction of the CA
		PKI relies on a hierarchy of trust relationships
		Browsers developers preconfigure browsers to trust the major CA's

	Registration Authorities (RA)
		assits CA with the burden of verifying users identities prior to issuing digital certificates

	Certification Path Validation (CPV)
		means that each certificate in a certificate path from the original start or root of trust down to the server or client in question is valid and legitimate
		can break the chain of trust or can reestablish all trust links and prove that the assumed trust remains assured

	Certificate Generation and Destruction
		
		Enrollment
			prove your identity to the CA
			CA creates an X.509 digital certificate containing your identifying information and a copy of your public key
			CA digitally sign the certificate using the CA's private key and provides you with a copy of your signed digital certificate	
		
		Verification
			= checking the CA's digital signature using the CA's publickey
				certification is not in the Certificate revocation list CRL
				digital signature of CA is authentic
				you trust the CA
				certificate actually contains data your are trusting
			often built-in browser

		Revocation
			because:
				certificate was compromised (ex.: certificate owner accidentally gave avay the private key)
				certificate was erroneously issued
				details of the certification changed
				security assocation changed
			Revocation grace period 
				= defined in the Certificate Practice Statement CPS		
			Online Certificate Status Protocol OCSP
				client sends an OCSP request to the CA's OCSP
				server respond with status: valid, invalid, or unknown

Asymmetric Key Management

	best practices:
		choose the encryption system wisely
			"security through obscurity" is not appropriate approach
			choose algorithm vetted by industry experts
			select a key lenght that balances security requirements with performance considerations
			keep the private key secret !
			retire keys when they served, change key pair every few months
			back up your keys!
	
Applied cryptography
	
	Portable devices
		popular OS now include disk encryption
			Windows: bitLocker and EFS
			OSX: Filevault encryption
			Linux, Windows, MAc: TrueCrypt
		Trusted Platform Modules
		don't forget about smartphones

	Email
		if you need confidentiality in mail, encrypt the message
		if you need integrity, hash the message
		if you need authentication, integrity and/or nonrepudiation, digitally sign
		if you need confidentiality, authentication, integrity and/or nonrepudiation, encrypt and digitally sign

	Pretty Good Privacy PGP
		Phil Zimmerman's in 1991
		combine CA hierarchy with "web of trust"
		available in 2 versions:
			commercial version using RSA for key exchange, IDEA for encryption, MD5 for hashing
			freeware version (similar to OpenPGP standard) using Dellfie-Hellman key algorithm, Carlisle Adams/stafford Tavares (CAST) 128-bits encryption, and SHA-1 hashing
		include: StartMail, Mailvelope, SafeGmail and Hushmail

	S/MIME
		Secure Multipurpose Internet Mail Extension (S/MIME) protocol			
			= defacto standard for encrypted mail
			uses RSA
			received backup of major industry players
			incorporated in: MS Outlook, Mozilla Thunderbird, Mac OSX Mail
			relies on X.509 certificates for exchanging keys
			supports AES and 3DES symmetric encryption algorithm
	
	Web application
		SSL 
			developed by Netscape
			HTTPS uses port 443
			Security standard for Microsoft Internet Explorer
			1. browser retrieves the web server's certificate and extract the server's public key
			2. browser creates a random symmetric key, encrypt with server public key and send to server
			3. server decrypt the symmetric key with its private key and start symmetric encryption

		TLS
			1999 proposed as a replacement standard to SSL
			uses TCP port 443
			2014 POODLE demonstrated a flaw in SSL 3.0, industry goes to TLS

	Steganography and Watermarking
		makes alterations to the least significatnt bits of the many bits that make up image files
		iSteg = steganography tool

	Digtal Rights Movement DRM
		use encryption to enforce copyright restrictions on digital media
		CSS Content Scrubling System
		AACS Advanced Access Content System
		ADEPT Adobe Digital Experience Protection Technology 
		Vitrium or FileOpen = Document DRM
		
	Networking
		
		Circuit Ecryption
			link encryption (usually lower level of OSI)
				creates a secure tunnel between 2 points
				using Hw or SW solution that encrypts all traffic
				includes all the data, with header, trailer, address and routine data
				each packet has to be decrypted/reencrypted at each hop
				slower the communication routing

			end-to-end encryption (usually highr level of OSI)
				ex.: TLS from user to server, SSH
				moves faster from point to point
				encrypt only the workload data
				more susceptible to sniffers and eavesdroppers

		IPsec
			set by the Internet Engineering Task Force (IETF)	
			use public key crypto, using IP-based protocol
			primary use for VPN
			operate either tunnel or transport mode
			commonly paired with the Layer 2 Tunneling Protocol (L2TP) as IPsec/L2TP
			Has 2 main components:
				Authentication Header AH: provides integrity and nonrepudiation, and authentication and access control, prevents replay attack
				Encapsulating Security Payload: provides confidentiallity and integrity of packet contents
			2 modes:
				transport mode: only packet payload is encrypted, for P2P
				tunnel mode: entire packet is encrypted, gateway-to-gateway communication
			Security Association
				= simplex connection
				
		ISAKMP
			Internet Security Association and Key Management Protocol (ISAKMP)
				4 requirements set in the RFC 2408:
					authenticate communicating peers
					create and manage security associations
					provide key generation mechanisms
					protects against threats

			
		Wireless Networking
			Wired Equivalent Privacy WEP
				64bits and 128bits encryption options
				described in IEEE 802.11
				should never be used
			WPA Wifi Protected Access
				implements TKIP Temporal Key Integrity Protocol
			WPA2 adds AES cryptogratphy
			to run 802.1x, the client runs a piece of software known as the supplicant, which communicates with the authentication server


Cryptography Attacks

	Analytic attack:
		algebric manipulation that tries to reduce the complexity of the algorithm
		focus on the algorithm

	Implementation Attack
		exploits the software coden the technology employed to program the encryption system
	
	Statistical Attack
		exploits statistical weakness, as floating-point error and inability to produce truly random numbers
		focus on the OS or HW

	Brute Force
		attempts every possible valid combination for a key or password
		rainbow tables provide precomputed values for cryptographic hashes

		Salting saves Passwords
			cryptography salt = a random value added at the end of the password before the OS hash the password
	
	Frequency Analysis and Ciphertext Only Attack
	
	known plaintext
		get plaintext and its ciphertext to compute the algo
	
	Chosen Ciphertext
		attacker decrypt chosen portions of the ciphertext to discover the key

	Chosen Plaintext
		attacker encrypt plaintext message and analyse the cipher output

	Meet in the Middle
		= reason why 2DES was discarded
		attackers use a known plaintext message
		plain text is encrypted using any possible key k1 and decrypted using any possible key k2
		when match is found, the k1/k2 pair representents both portions of the double encryption

	Man in the middle
		birthday attack, or collision attack, or reverse hash matching
		seek to find flaws in the one-to-one nature of hashing functions
		attackers seek to substitute in a digitally signed communication a different message that produces the same message digest

	Replay
		if chrypto don't incorporate temporal protection
		attacker intercepts an ecrypted message (often request for authentication) and then later "replays" the captures message to open a new session
		can be defeated by incorporationg stamp and expiration date
						


=======================================================================================================================================================

Chapter 8:
Principles of Security, Models, Design, capabilities

=======================================================================================================================================================
=======================================================================================================================================================

Implement and Manage engineering Processes Using Secure Design Principles

	Object and Subject:
		Subject = user or process that makes the request to access a ressource
		Object = ressource that the subject wants to access
		serves as an example of transitive trust: if A trust B and B trusts C, then A trusts C
	
	Closed and Open Systems
		closed = work well with a narrow range of other systems, generally from the same manufacturer
		open = use agreed-upon industry standards

	Technique for ensuring Confidentialitty, Integrity and Availability
		
		Confinement
			restrict action of a program
			allows a process to read from and write to only certain memory location and resources
			= sandboxing
			implemented in the OS or through a confinement application or service (sandboxie.com)

		Bounds
			each process that runs on a system is assigned a security level
			simple system: 2 levels = user and kernel
			= limits sets on the memory addresses and resources
			some may require physical bounded processes, can be very expensive

		Isolation
			= when a process in confined through enforcing access bounds
			protect OS, the kernel, and other independant app
			
	Controls
		uses access rules to allow subjects to access only authorized objects
		Mandatory and Discretionary Access Control MAC and DAC
			MAC: static attributes of the subject and the object determine the permissibility of an access
			DAC: subject has some ability to define the object to access
			RBAC: rule based access control		

	Trust and Assurance
		trusted system = all protection mechanisms work together to process sensitive data while maintaining a stable and secure computing environment
		Assurance = degree of confidence in satisfaction of security needs
		
Understand the fundamental Concepts of Security Models
	
	token = separate object that is associated with a resource and describes its security attributes
	capabilities list = row of security attributes for each controlled object
	security label = attribute storage, generally permanent part of the object to which its attached
		provides safeguard against tampering (FR=falsification), that neither tokens nor capabilites list do

	Trusted Computing Base TCB
		Orange book (= DoD standard 5200.28) describes a TCB Trusted Computing Base
		TCB = subset of a complete information system
			should be as small as possible
			only portion of that system that can be trusted
			in general, responsible to control access to the system
			must provide method to access outside and inside the TCB itself

	Security Parameter
		= imaginary boundary between TCB and the rest of the system
		trusted paths = TCB secured channels to rest of the system
		TCSEC guidelines: trusted paths are required for high trust level systems such as those at level B2 or higher of TCSEC

	Reference Monitor and Kernel
		= part of the TCB that validates access to every resources prior to granted access
		stands between every subject and object
		= access control enforcer for the TCB
		Security kernel = collection of components in the TCB that work together to implement reference monitor functions
			launch appropriate components to enforce reference monitor functionality and resist all known attacks
			uses a trusted path to communicate with subjects

	State Machine model
		= a system that is secured no matter what state it is in
		FSM Finite State Machine
			combines an external input with an internal machine state to model all kinds of complex systems
			given an input and a state, an FSM transitions to another state and may create an output
			next state = output = F(current state, input)

		state = snapshot of a system in a specific point in time
			if all aspects of the state meet the requirement of the security policy, the state is considered secure
		
		transitions 
			occur when accepting input or producing output
			always results in a new state (= state transition)
			all state transition must be evaluated
			if each possible state transitions results in another secure state, the system can be called a secure state machine
			
	Information flow model
		focuses on the flow of information
		designed to prevent unauthorized, insecure, or restricted information flow, often between different level of security (multilevel models)
		establishes a relationship between 2 versions of state of the same object
		addresses covert channel by specifically excluding all non identified flow pathways

	Non interference Model
		concerned with how the actions of a subject at a higher security level affect the system state or the actions of a subject at a lower security level
		
	Composition Theory
		information flows between system
		cascading: input of one system comes from the output of another
		feedback: one system provides input to another, which reciprocates by reversing roles
		hookup: one system sends input to another system but also sends input to external entities

	Take-Grant Model
		employs redirected graph to dictate how rights can be passed from one subject to another, or to an object
		
		take rule = allows a subject to take rights over an object
		grant rule = allows a subject to grant rights to an objects
		create rule = allows a subject to create new rights
		remove rule = allows a subject to remove rights

	Access Control Matrix
		table of subject and object that indicates the actions of functions taht each subjects can perform on each object
		each column = ACL
		each row = Capabilities List

	Bell-LaPaluda Model
		1970 by the DoD
		derived from the DoD multilevel security policies
		write up and read down allowed, write down and read up forbidden
		prevents leaking or transfer of classified info
		provides confidentiality but not integrity nor availability
		3 basic properties:
			simple security property = subject may not read info at higher security level
			* security property (= confinement property) = subject may not write information to an object at lower sensitivity level
			Discretionary security property = system uses an access matrix

		exception: trusted subject is not constrained by the * security property
			trusted subject = guaranted not to consummate a security-breaching information transfer even if it is possible

	Lattice-based access control (FR: lattice=treillis)
		subjects are assign position in the lattice, between security label or classifications
		subjects can access only object between the least upper bound and the hight lower bound of the labels or classification of the lattice position
		deals primarely with confidentiality (relation to Bell-LaPaluda model)
		
	Biba Model
		after Bell
		provides integrity
		inverted Bell model
			simple security property (or axioms or rules) = subject may not read info at lower security level
			* security property = subject may not modify information to an object at higher sensitivity level
		read up and write down allowed, read down and write up forbidden
		
		3 integrity issues:
			prevent modification of objects by unauthorized subjects
			prevent unauthorized modification of objects by authorized subjects
			prevent internal and external object consistency
	
		few drawbacks:
			addresses only integrity
			focuses on protecting objects from external threats, internal assued to handled programmatically
			no access control managment, doesnt provide a way to assign or change an object's or subject's classification level
			doest not prevent covert channels

		more common choice for commercial organizations (integrity more important than confidentiality)

	Clark-wilson Model
		1987 specific to commercial org
		multifaceted approach
		defines each data item and allows modifications through only small set of programs
		uses a three-part relationship subject/program/object (or subject/trnsaction/object)
			= triple or access control triple
		2 principles: 
			+well-formed transactions = programs -> constrained interface
			+separation of duties

		defines items:
			Constrant Data Item CDI	=any data whose integrity is protected by security policies
			Unconstraint Data Item = any data not protected by security model
			Integrity Verification Procedure IVP = scans data items and confirms their integrity
			Transformation Procedure TP = only procedures that can modify a CDI

		
	Brewer and Nash Model ( = Chinese Wall)
		was created to permit access controls to change dynamically based on a user's previous activity
		applies to a single integrated database
		for conflicts of interests
			create conflicts classe, prevents a user to access multiple object in the same conflict class
		administrator has full access, except when an actions is taken against any data items: admin access to any conflicting data items is temporarily blocked

	Goguen-Meseguer Model
		= integrity model
		= foundation of non interference conceptual theories
		predetermining the set or domain (= list of object that can access a subject)
		based on automation theory and domain separation
		
	Sutherland Model
		= integrity model
		preventing interference in support of integrity
		defines a set of system states, initial states, and state transitions
		see covert channels

	Graham-Denning Model
		= focused on secure creation and deletion of both subjects and objects, through an access control matrix
		8 primary protection rules:
			securely create an object
			securely create a subject
			securely delete an object
			securely delete a subject
			securely provide the read acces right
			securely provide the grant access right
			securely provide the delete acces right
			securely provide the transfer acces right
			
Select Controls and Countermeasures based on Systems Security Evaluation Model

	1. system is tested, technical evaluation is performed
	2. formal comparison of its design and security criteria and its actual capabilities and performance
	Often third party is hired to perform such evaluation, results in a seal of approval
	3 main product evaluation models or classification: TCSEC, ITSEC and Common Criteria

	Rainbow Series (color of the covers)
		since 1980
		Trusted Computer System Evaluation Criteria TCSEC ( = orange book) created by National Computer Security Center NCSC in 1985 
		Information technology Security Evaluation Criteria ITSEC
			= EU, in 1990 though 1998
		TCSEC and ITSEC replaced by the Common Criteria
			
	TCSEC Classes and REquired Functionnality
		Cat A: verified protection, highest level of security = similar to B3, development cycle: each phase is controlled using formal methods, documented, evaluated, verified
		Cat B: mandatory protection = more granularity control, based on Bell-LaPaluda, on security labels
			B1: labeled security = each subject and object has security labels, grants access by check labels compatibility
			B2: structured protection = must ensure no covert channels exist, process isolation, operators and admin functions separated
			B3: security domains = increasing separation and isolation of unrelated process, adressed during initial reboot
		Cat C: Discretionary protection = basic acces control
			C1: Discretionary protection = control acces by user ID and/or groups
			C2: Controlled access protection = users must be identified individually, enforce data cleansing, strict logon procedures
		Cat D: Minimal protection

	Red Book 
		interpret TCSEC in networking context
		
		rates integrity and confidentiality
		adresses communications integrity
		adresses denial of service protection
		adresses compromise (= intrusion) protection and prevention
		restrictd to limited class of networks (= centralized networks with a single accreditation authority)
		uses 4 rating level: None, C1 (= minimum), C2 (= Fair), B2 (= good)
	
	TCSEC issues
		dont control what users do with information once access is granted
		entirely on confidentiality
		doesnt deal with network issues
		not carefully adress the finds of personnel, physical, and procedural policies

	ITSEC Classes and Required Assurance Functionnality
		target of Evaluation TOE in 2 categories
			functionnality rated from F-D to F-B3 (no F-A1)
			assurance rated from E0 through E6
		correspondance between TCSEC and ITSEC
			
	Common Criteria
		ability to purchase CC-evaluation product

		Recognition of CC
			official standard ISO 15408

		Guidelines:
			add buyer's confidence
			eliminate duplicated evaluation
			keep making evaluation and certification process more effective and efficient
			evaluation of IT products adhere to high and consistent standards
			promote evaluation and increase availability of IT products
			evaluate functionnality and assurance of the TOE

		Based on 2 key elements:
			protecting profiles PP
			Security Targets ST

		Package = grouping  of security requirement components that can be added or removed from a TOE
		PP compared to various ST from the selected vendor's TOE
		clients selects a vendor based on published or marketed evaluation assurance levels EAL
		Evaluate Assurance Level (EAL) provide standardized method of evaluating vendor

		Structure of CC
			Part 1: intro and general model
			Part 2: Security Functional Requirements
			Part 3: Security Assurance

		EAL from 1 through 7
			EAL1 = Functionnaly tested: due care
			EAL2 = Structurally tested: evaluating legacy systems, low to moderate levels of independently assured security
			EAL3 = Methodically tested and checked: when security engineering begin at dev step, moderate level of independently assured securrity
			EAL4 = Methodically designed, tested and checked: rigorous,positive security engineering, involves independant testing of all TOE security Function (TSF)
			EAL5 = Semi-formally designed and tested: rigorous engineering, including specialist security techniques, for semi-formal testing, high level of ISA
			EAL6 = Semi-formally verified, designed and tested: produce a premium TOE
			EAL7 = formaly verified, designed and tested: only highest risk situation

		TCSEC	ITSEC	CC Description
		D	F-D+E0	EAL0, EAL1	minimal, no protection
		C1	F-C1+E1	EAL2		discretionary security mechanisms
		C2	F-C2+E2	EAL3		controlled access protection
		B1	F-B1+E3	EAL4		labeled security prtection
		B2	F-B2+E4	EAL5		Structured security protection
		B3	F-B3+E6	EAL6		Security domains
		A1	F-B3+E6	EAL7		Verified security design
		

	Industry and International Security Implementation Guideline
		
		PCI-DSS = security for electionic payment transactions
		ISO = worldwide standards-setting group

	Certification and accreditation
		
		Certifications
			= first phase of total evaluation process
			= test and document the security capabilities of a system in a specific configuration
	
		accreditation
			if management decides the certification of the system satisfies their needs, the system is accredited
			= formal declaration by the Designated Approving Authority DAA
			usually performed by third party and trusted by everyone

		often iterative process

	Certifications and Accreditations systems

		Risk Management Framework RFM replace the DoD Information Assurance Certification and Accreditation Process DIACAP
			4 phases:
				1. Definitions: creation of System Security Authorization Agreement SSAA
				2. Verification: refinement of the SSAA, recommandation to the DAA, and DAA accreditation's decision
				3. Validation: refinement of the SSAA, recommandation to the DAA, and DAA accreditation's decision
				4. Post-Accreditation: include maintenance of the SSAA

		3 types of accreditation, from National Security Telecommunication and Information Security System instruction 1000:
			system accreditation = major application or general support system
			site accreditation = specific, self-contained location
			type acreditation = app or system distributed on different locations

Understand Security Capabilities of Information Systems

	Memory protection
	Virtualization
	Trusted Platform Module
		HSM Hardware Security Module 
			= cryptoprocessor, 
			provide accelerated solution for large (2048+ bit) asymmetric encryption calculatons ans a secure vault for key storage
			used in ATM and POS bank terminals	
	Interfaces
	Fault Tolerance
		RAID, avoiding SPOF


=======================================================================================================================================================

Chapter 9:
Security Vulnerabilities,threats and countermeasures

=======================================================================================================================================================
=======================================================================================================================================================

Assess and Mitigate security Vulnerabilities
	
	computer architecture = design and construction of computing systems at a logical level

	Hardware
		= physical stuff that makes up a computer
		
	Processors
		= central processing unit CPU

		execution types
			multitasking = handling 2 or more task simultaneously
				OS simulate multitasking by carefully structuring the sequence of commands sent to the CPU for execution

			multiprocessing = a multiprocessor computing system harnesses the power of more than one processor to complete the execution of a single application
				SMP Symmetric Multi Processing, processors share same OS, Data bus, Memory resources

			Massively Paralelle Processing MPP = systems house hundred or thousands of processors, each with its own OS

			Multiprogramming = similar to multitasking, a way to batch or serialize multiple processes
				usually takes place on large-scale systems (mainframes)
				normally coordinates by the OS

			Multithreading = multiple concurrent task to be performed within a single process
				thread = self-contained sequence of instructions that can execute in parallele, and are part of the same parent process
		
		Processing types
			Single State = require use of policy mechanism to manage information at different level
				security admin approve a processor and system to handle only one sceurity level at a time
			
			Multistate = certified to handle multiple security levels simultaneously

		Protection Mechanisms
			runtime environment = OS + all active app
			
			Protection Rings = 	
				runs on Multics OS
				designated and built between 1963 and 1969 through collaboration of Bell Labs, MIT and General Electrics
				implemented first in Honeywell
				inspired UNIX and introduced the idea of protection rings to OS design

				organize code and components in an OS into concentric rings
					Multics allowed up to 7 rings, modern OS use a four-ring model (0 to 3)
					ring 0 (OSKernel/Memory) is the highest level of privileged
						kernel is the part of the OS that always resides in the memory	
					ring 1 houses other part of the OS
					ring 2 where I/O drivers, protocols and system utilities reside
					ring 3 for applications and programs

					ring 0-2 runs in supervisory or privileged mode
					ring 3 runs in user mode

				lies in priority, privilege and memory segmentation
				mediated-access model
					many modern OS break memory into 2 segments:
						ring 0-2: system access level = kernel mode or privilege mode
						ring 3: user-level programs and app = user mode

					process can acces resources in their own ring and outside ring
						ex.: process in ring 1 can access ring 1-3
					system call: mediated acces to inner ring
					
				Process state (= operating state) = various form of execution in which a process can run
					supervisor state = privilege, all access mode
					problem state = associated with user mode

					Processing queue = processes line up for execution in OS
						time slice = chunk of processing time
						process schedular usually selcet the highest-priority process for execution

					Ready = process is ready (= has all memory and other resources it needs) to resume or begin processing as soon as it is scheduled
					Waiting (=blocked) = ready for continued execution but is waiting for a device or access request to be serviced
					Running = executes on the CPU and keep going until it finishes, its time slice expires, or is blocked for some reason
						if time slice ends and process isn't completed, it returns to ready and queue
						if the process blocks while waiting for a resource to become available, it goes into waiting state and queue
					Supervisory = process must perform an action that requires greater privileges
						basically, any function that is not in the user mode (ring 3) or problem state
					Stopped = process finishes or must be terminated (an error occurs, a required resource is not available)
						
					new processes always transition into ready state
					ready processes always transition into running state
					
					process scheduler
						waiting in memory
						manages processes awaiting execution in ready and waiting state
						decides what happens to running processes when they transition into another state
							
					Security Mode = 4 approved security modes for systems 
						before deployed need:
							a hierarchical MAC environment
							total physical control over which subjects can access the computer
							total physical control over which subject can enter into the same room as the computer console

					Dedicated Mode = similar to single-state systems
						each user must have a security clearance that permits access to all information processed by the system
						each user must have access approval for all info processed by the system
						each user must have a valid need to know for all info processed by the system

					System High Mode
						each user must have a security clearance that permits access to all information processed by the system
						each user must have access approval for all info processed by the system
						each user must have a valid need to know for "some information processed by the system"

					Compartmented mode
						each user must have a security clearance that permits access to all information processed by the system
						each user must have access approval for "any info that they will have to access to on the system"
						each user must have a valid need to know for some information processed by the system
					
					Compartmented mode workstations CMW
						requires sensivity levels and information labels

					Multilevel Mode (=controlled security mode)
						the subject's clearance level dominates the object's sensitivity label
						each user must have access approval for "any info that they will have to access to on the system"
						each user must have a valid need to know for all info processed by the system

					Table:

					Mode		Clearance	Need to know	PDMCL (Process Data from Multiple Clearance Level)
					Dedicated	Same		None		None
					System High	Same		Yes		None
					Compartmented	Same		Yes		Yes
					Multilevel	Diferrent	Yes		Yes
	
			Operating Mode

				User mode
					= basic mode
					CPU allows the execution of only a portion of its full instruction set
						> protection against user errors and attackers
					often processes within user mode are executed within a controlled environment called VM and virtual subsystem machine

				Privilege Mode
					give the OS access to the full range of instructions supported by the CPU
					= Privilege mode = Supervisory mode = system mode = Kernel mode (depends on the vendor)
					grants a wide range permissions to the process executing on the CPU
					usually forbidden to user application, only for those processes that are components of the OS, for security and integrity

	Memory

		Read Only Memory ROM
			memory PC can read but can't change, no writing allowed
			content of a standard ROM is burned in at the factory
			often contents "bootstrap" information that computer use to startup
				includes POST (Power-on Self Test)
			
		PROM (Programmable ROM)		
			allows end user to burn chip's contents later, no further change possible
			often used for custom hardware applications where some custom functionnality like a ROM chip
		
		EPROM (Erasable Programmable ROM)
			small windows that, when illuminated with a special violet light erase the content or the chip

		EEPROM (Electronnaly EPROM)
			electric voltages delivered to the pin forces erasure

		Flash Memory
			similar to EEPROM, but can be written in blocks or page
			most common: NAND flash, widely used in memory cards, thumb drives, mobile device and SSD

		Random Access Memory RAM	 		
			when computer is off, all data stored in RAM disappears
			usefull for temporary storage
			a backup copy should always be kept on another storage device in case of loss of electrical power

			Real Memory
				= main memory = primary memory
				largest RAM storage resource available to the computer
				composed of a number of dynamic RAM chips, must be refreshed on a periodic basis

			Cache RAM
				take data from slower devices and temporarily stores it in faster devices
				processor contains onboard cache:
					on-chip = level 1, often backed up by a static cache RAM in a separate chip = level 2 cache
				keep the data that's likely to be used next closer at hand (CPU instructions, data fletches, file access...)

			Dynamic vs Static RAM
				dynamic = capacitors, loses their charge overtime that can alter memory, needs CPU overhead for periodic operations
				static = use flip-flop as on/off switch, no need for periodic operations, more expensive

		Registers
			limited amount of memory onboard the CPU, that is used by ALU Arithmetic Logical Unit
		 	operates in lockstep with CPU at typical CPU speed
			
		Memory adressing
	
			Register adressing
				CPU uses register adress to access its content

			Immediate Adressing
				a way of referring to data that is supplied to the CPU as part of an instruction
				ex.: "add 2 to the ALU in register 1"
					uses 2 adressing schemes: first (add 2) is immediate adressing (=include in the command), second is register adressing (= register 1)
			
			Direct Addressing
				provides the CPU the actual address to the memory location to access

			Indirect Addressing
				the memory address contains another memory address
				
			Base+Offset addressing
				uses a value in one of the CPU's registers as base location 
				then add the offset supplied with the instruction to retrieve the operand from the computed memory location		
				
		Secondary Memory
			= magnetic, optical, flash-based media
			data is read by OS and stored into primary memory
			stores massive amount of information, very cheap
			paging = reads the data from disk back into real memory
			memory functions in nanoseconds, disk in milliseconds
		
		Memory Security Issues
			memory retention issues = delete or erase all ROM,PROM,EPROM,secondary memory
			RAM could retain some of their charge for a limited period in time...
			attack can freeze memory chips to delay the decay or resident data
			most important issues is to control who may access data stored in memory while a computer is in use
		
	Storage
		store information that may be used anytime after its been written

		Primary memory = primary storage = RAM
		Secondary storage =  secondary storage = long term storage device

		Volatile = lose data when power off
		Nonvolatile = dont lose data when power off

		Random (storage access) = allow OS to read and write immediately from any point within the device, using adressing system
			almost all primary memory, and most secondary memory
		Sequential = require to read all the data physically stored prior to the desired location
			magnetic tape drive

		Storage media security
			data remanence = data remain on secondary storage device after it has been erased
			sanitizing = use specialized utilities to destroy all trace of data on the the device, or damage or destroy it beyond possible repair
			SSD have often blocks of data that are not marked as "live" but hold a copy of the data, traditional zero wipe is ineffective
			secondary storage are prone to theft, need full disk encryption (many HDD and SDD offers on-device native encryption)

	Input and Output device
		= basic and primitive peripherals

		Monitors
			TEMPEST can compromise the security of data displayed on a monitor
				uses the electronic emanation (= Van Eck radiation) to be read from a distance (= Van Eck phreaking)
				works better on CRT than on LCD
			shoulder surfing or telephoto lenses on cameras

		Printers
			exposed to the network,and often not designed to be secure system
			modern ones store data locally, often on hard drive
			users may forget to retrieve their sensitive printouts
			sometimes easier to steal paper than electronic device

		Keyboards/mouse
			eligible to TEMPEST monitoring
			sophisticated bugging: intercept all the keystrokes and transmit to a remote receiver
			blutooth, as radio signal, can be intercepted

		Modems
			one of greatest woes of a security admin
			can use to to create uncontrolled access points into your network
			can create an alternate egress (FR=sortie) channel that insiders can use to funnel (FR=entonnoir) data outside the organization
			
	Input/Output Structures
		
		Memory mapped I/O
			a part that the address space used by CPU functions to provide access to some kind of device through a series of mapped memory addreses or locations
		
		Interrupt (IRQ)
			IRQ Interrupt Request 
			= a technique for assigning specific signal lines to specific device through special interrupt controller
			when a device wants to adress input to CPU, it sends a signal on its assigned IRQ
			older PC: 0-16 with 2 cascaded 8-line interrupt
			newer PC: 0-23 with 3 cascaded 8-line interrupt
			newer PnP-copatible devices may actually share a single IRQ number
			interrupt conflict = 2 or more device share the same IRQ
			Only OS should access IRQs at a sufficiently high level of privilege

		Direct Memory Acces DMA
			works as a channel with 2 signal lines
				Direct Memory Request DMQ
				Direct Memory Acknowledge DMACK
			through DMQ, a device signals the CPU it wants to make direct access to another device, usually real memory
			CPU authorise access and block further acces for other device, when completed the device uses the DMACK to signal to CPU that it may once againt permit access previously blocked memory location 			
			faster than require CPU to mediate the access, and free time cycle for other operations on the CPU
			often use to load secondary memory to RAM

		Firmware
			= microcode
			describe software stored in a ROM chip

			BIOS = Basic Input Output Systems
				contains the OS-independant primitive instructions that a computer need to start up and load the OS from disk
				phlashing = install a malicious variation of BIOS or firmware that introduce remote control or other features
				2011, most vendor replace BIOS by UEFI (Unified Extensible firmware interface)

			Device Firmware
				mini-OS located in Device for boot up and more

Client Based
	client-side attack = any attack that is able to harm a client
	can occur on any protocol, not just HTTP
	risk of poisoning of local caches

	Applets
		= code objects are sent from a server to perform some actions on the client
		= self-contained miniature programs that execute independantly of the server that sent them
	
		processing burden is shifted to the client
		client able to produce data using local resources
		in a properly programmed applet, server never receive data provided to the applet as input
	
		can include a trojan horse component

		Java applets
			Java is platform-dependant programming language developed by Sun Microsystems
			implement a Virtual Machine (named JVM), each system should install JVM version needed by OS
			Sun creates "sandbox" concept to place privilege restriction on Java code
				sandbox isolate Java code objects from the rest of the OS

		ActiveX Controls
			Microsoft aswer to Java
			use a variet of languages: Vsual Basic, C, C++, and Java
			execute only on system running Microsoft browser
			no sandbox, have full access to the Windows OS environment

	Local Cache
		= anything temporarely stored on the client for future use
		ARP cache, DNS cache, Internet Files cache
		ARP used to resolve an IP address into the appropriate MAC address, in order to craft the ethernet header for data transmission
		ARP poisoning
			respond to ARP broadcast queries in order to send back falsified replies
			create static ARP entries, through use of trojan horses, buffer overflow, or social engineering attack
				static ARP are permanenet to reboot

		Man-the-middle through DNS poisoning
			HOST Poisoning
				HOSTS files = static file found on TCP/IP supporting system that contains hardcoded references for domain names and associated ip adresses
				entries in HOSTS files are permanent
				used prior to dynamic query-based DNS
				admin or hackers can add relationship from FQDN Fully Qualified Domain Name and IP address
								
			Authorized DNS server attack
				aims at altering the primary record of a FQDN
				authorative DNS server hosts the zone files or domain database

			sending an alternate IP address to the client to be used as the DNS server client
				< script or compromising DHCP

			DNS query Spoofing
				eavedrop's on a client's DNS queries, then send client false information

Server-Based
	issue of data flow control

	Database security
		
		Aggregation
			=combine records from multiple tables
			aggregation attacks = collect numerous low-level security items and combine to create something of a higher security level or value
			
		Inference
			similar to data aggregation
			use human mind's deductive capability rather than raw mathematical ability of modern database platform
			> maintain constant vigilence over the permissions granted to individuals		

		Data mining and Data Warehousing
			allow analysts to comb though data warehouse and look for potential correlated information
			produce metadata
				metadata is stored in more secure container called data mart

		Data Analytics
			Big Data

		Large Scale Parallele Data Systems
			perform numerous calculations simultaneously
			
Distributed Systems
	processing and storage are distributed
	networks link between clients
		> potential security issue

	needs several security rules:
		email lust be screened
		download/upload policies
		systems robust acces control
		graphical user interface mechanisms and database management
		file encryption
		separate and isolate process
		protection domains
		disks and sensitive materials labeled
		files on desktop machine should be backed up
		Desktop users regular security awareness
		Desktop computers and storage media protected against environmental hazard
		Desktop computers included in DRP and BCP
		Developer of custom software need to take security in account

	Defense in depth
		= common security strategiy used to provide a protective multilayer barrier
		uses of multiples type of access controls in literal or theorical concentric circles

	Cloud Computing
		PaaS	Platform as a Service
		SaaS	Software as a Service
		IaaS	Infra as a Service

	Grid Computing
		= form of paralleled distributed processing that groups number of processing nodes to work toward a specific processing tool
		when system in idle, it could join a group, download a small portion of work and start calculations
		> content of each packet is potentially shared to the world
		 		>  not appropriate for private,confidential, proprietary data
		often uses a central primary core of servers to manage the project

	Peer to Peer
		= networking and distributed application solutions that share tasks and workload among peers
		similar to grid, without core central primary servers
		usually realtime services: VoIP, Bittorrent, Spotify...

Industrial Control System ICS
	= form of computer-management device that controls industrial processes and machines
	
	DCS Distributed control System
		gather data and implement control over a large-scale environment from single location
		controlling elements are ditributed across monitored environment

	PLC Programmable Logic Controllers
		typically used inmanagement and automation fo various industrial electromechanical operations
	
	SCADA Supervisory Control and Data Acquisition
		can operate as stand-alone device, or networked with other SCADA or traditional IT systems network
		often use mechanical button and simple LCD screen interface,but can have more complexe remote controle GUI


Assess and Mitigate Vulnerabilities in Web Based Systems
	open community-focused web project known as OWASP
	include concerns about XMl and SAML (Security Association Markup Language)
	SAML often used to provide a SSO (Single Sign-On)
	
Assess and mitigate vulnerabilities in Mobile Systems
	= Personal Mobile Device PMD = Portable Electronic Device PED = Personnaly Owned Device POD
		use USB to synchronise with desktop
		not immune to eavedrop

	Android
		mobile device OS based on Lunix, acquired by Google in 2005
		made open source through Apache License
		
	IOS
		isn't license on use of any non-Apple product
	
	Device Security
		Full Device encryption = voice encryption possible when use of VoIP (Voice over IP)
		Remote Wiping = delete all data from a device remotly
		Lockout, after few failed credentials
		Screen Locks,do not protect blutooth connection,emergency calling features...
		GPS
		Application Control = limits which app could be installed on device
		Storage Segmentation: isolate device's OS and preinstalled apps from user-installed apps and user data
		Asset Tracking = management process used to maintain oversight on inventory, passive or active
		Inventory Control = hardware asset tracking, RFID or NFC
		Mobile Device Management MDM = software solution to management a wide range of mobile device
		Device Acces control
		Removable storage
		disabling unused features

	Application Security
		
		Key management
			RNG Random Number Genetor accessed from a wireless link
		Credential Management = storage of credential in a central location, with master credentail set
		Authentication	= PIN, RFID, NFC
		Geotagging
		Encryption
		Application Whitelisting = security that prohibits unauthorized software from being able to execute, unless on white list
			= deny by default = implicit deny
		
	BYOD (Bring Your Own device) Concerns
		
		Data ownership
			company wants to wipe out all data including personal ones
			should back up data

		Suport Ownership
		Patch Management
		Antivirus Management
		Forensics
		Privacy: device in use for BYOD should be considered to be quasi-company property
		On-Boarding/Off-Barding = should be procedures of BYOD policy
		Adherence to corporate policy
		User Acceptance
		Architecture/Infrastructure considerations: inscrease Intrusion Detection System IDS and Intrusion Prevention System IPS
		Legal concerns
		Acceptable Use Policy
		On-board Camera/Video

Assess And Mitigate Vulnerabilities in Embedded Devices and Cyber-Physical Systems
	embedded system = computer implemented as part of a larger system
		ex.: network attached printers, smart TVs, HVAC controls, smart appliances, smart thermostats, Ford SYNC,medical devices...
	Static system = any system that is intended to remain unchanged by users and admin
		similar to embedded system
				
	Example of Static and Embedded System
		= portable or non-portable device that has native network ability
		usually for a wireless type of network, provided by a mobile telecomm company
		can also refer to WI-Fi
		=smartphones, mobile phones,tablets,smartTV,set-top boxes, HMDI stock ming media players, network-attached orinters, game systems,...
		
		Cyberphysical Systems = devices that offer a computational means to control something in the physical world
			= essentially key to elements in robotics and sensor networks

		anything that move = robotics
		anything that detect = sensor

		IoT Internet of Things = collection of devices that can communicate over the internet with one another or with a control console in order to affect and monitor the real world
		
	Methods of securing
		
		Network segmentation
			= controlling traffic among networked devices
			using VLANs, or other traffic-control means, including MAC address, IP address, physical ports, TCP or UDP ports, protocols, or application filtering, routing, and access control management
			isole static environment to prevent change and or exploit from reaching them

		Security Layers
			devices with different levels of classification or sensitivity are groupes togetehr and isolated from ohter groups with different levels
			= absolute or one-directionnal
			= logical (network management, OSs, and application) or physical (network segmentation or air gaps)

		Application Firewalls
			= hardware device, called appliance, designed for general networking filtering
			
		Manual Updates
			= ensure that only tested and authorized changes are implemented

		Firmware control version
			= should be implemented on a manual basis, after testing and review

		Wrappers
			= something used to enclose or contain something else
			in relation to Trojan Horses malware
			used as encapsulation solutions

		Control redundancy and Diversity
		
Essential Security Protection Mechanisms

	"software should not be trusted"
	
	Technical Mechanisms
		
		Layering
			= implement a structure similar to ring model for operating mode and apply it to each operating system process
			communication between layer or ring takes place only through the use of well-defined, specific interfaces to provide necessary security

		Abstraction
			fundamental principles behind the object-oriented programming
				= users just need to know the detail of the box but only the proper syntax for using the object and the type of data that will returned as a result
			object groups, or classes, whose access control and operation rights are given by group basis instead or per-object

		Data Hiding
			= assures that data existing on a security level is not visible to process running at a different security level

		Process Isolation
			requires that OS provide separate memory locations for each processs instructions and data
				> prevents unauthorized data access
				> protects integrity of processes
			many modern OS address the need for a process isoliton by implementing VM on a per-user or, per-process basis

		Hardware segmentation
			= similar o process isolation in purpose

		Security Policy and Computer Architecture
			tighlty target a single implementation effort
			called multilevel security policy
			
		Policy Mechanisms
		
		Principles of least privilege
			
		Separation of Privilege
			buildon the principle of least privilege
			require use of granular access permissions

		Accountability
			
Common Architectue Flaws and Security Issues

		some issues and flaws overlap one another and are used as creative ways to attack systems
		
	Covert Channels
		= method to pass information over a path that is not normally used for communication
			< thus, not be protected
		= opposite of an overt channel
		
		Covert Timing Channel
			conveys information by altering the performance of a system component or modifying a resource's timing in a predictable manner
			used to secretly transfer data
			very difficult to detect

		Covert Storage Channel
			conveys information by writing data to a common storage area where another process can read it
			
		Best defense = implement auditing and analyse log files

	Attacks based on design or coding flaws and security issues
		called backdoor = avoid security measures by design
		
		Initialization and Failure States
			many systems unload the security measures as part of their shutdown procedures
			"trusted recovery" ensure that all control remain intact in the event of a crash
		
		Input and parameter checking
			overflow = extra data that dont fit into the input buffer
			In many systems, the overflow is often executed directly by the system at a Highest level of privilege
			Du diligence from developers can eradicate bufferover flow,through proper data validation

		Maintenance hooks and privilege programs
			maintenance hooks are entry to the program that is only know by the developper, also called backdoors
			executing a program whose security level is elevated during execution			

		Incremental attack
			
			data diddling
				= attacker gains acces to a system and make small, random, incremental change to data during storage, processing, inpput ,output...
				countered by encryption and integrity checks
				
			salami attack
				= very small amounts are deducted from assets from balances regularly and routinely
				countered by seperation of duty 

	Programming
		any program that doesnt handle any exception gracefully is in danger of exiting in an unstable state

	Timing, State changes, and Communication Disconnects
		attacks based on predictability of task execution
		Time of check TOC	
		Time of use TOU	
			difference between TOC and TOU is sometimes large enough ofr an attacker to replace the original object with another
			TOCTOU attackk are often called race conditions
		known as "state attack" because they attack timing, data flow control, and transition between one system state to another

	Technologie and process integration
		attention to SPOF and weaknesses in Service Oriented Architecture SOA
		
	Electronic Radiation
		emanations can be intercepted
		pssible to recreate keyboard input or monitor output
		reduce by cable shielding or conduit, block authorization
	
		TEMPEST technologies could provide protection against EM radiation eavedropping
			Faraday cage
			Jamming or Noise generator
			control zones = Faraday cages used to block purposely broadcast interference



============================================================================================================

Chapter 10
Physical Security Requirements

============================================================================================================

============================================================================================================

Appply Secure Principles to Site and FAcility Design

	Secure Facility
		critical path analysis = systematic effort to identify relationship between mission-critical applications processes and operations and all the necessary supporting elements
			complete picture of the interdependencies and interactions necessary to sustain the organization
			serve as a list of items to secure

		technologie convergence = tendency to technology to converge over time
			> can result to SPOF

	Site Selection
		avoid high crime area and natural disasters
		proximity of other buildings and business 
		ensure that the building is designed to withstand fairly extreme weather

	Visibility
	Natural Disaster
	Facility Design
	
Design and Implement Physical Security

	administrative, technical and physical
	
	Administrative physical security controls
		= facility construction and selection,site management, personel control, awareness rtaining, emergency response and procedure
	
	Technical physical security control
		= access controls, intrusion detection, alarms, colsed-circuit television (CCTV), monitoring, heating, ventilating, and air conditioning HVAC
	Physical Control for phusical security
		= fencing, lighting, locks, construction materials, mantraps, dogs and guards

	Functionnal order:
		deterrence (FR=dissuasion): on initial attempts, by boundaries restrictions
		denial: ex. lock vault (FR=voute) doors
		detection: ex. motion sensor
		delay: ex. cable lock on the asset		
		
	Equipement failure
		response time in returning to a fully functioning state is directly proportional to the cost involved in maintaining such a solution
			includes: storage, transportation, pre-purchasing, and maintaining onsite installation and restoration expertise
		Service Level Agreements SLA with the hardware vendor in case onsite replacement is not feasable
		Mean Time to Failure MTTF: replace all elements before MTTF
		Mean time Between failure MTBF
		Mean Time to Repair MTTR:

	Wiring Closets (FR=armoire de cablage)
		= premises wire distribution room
		never use as storage area
		have adequate locks
		keep the area tidy
		do not store flammable items
		set up video surveillance
		use door open sensor to log entries
		do not kgive keys to anyone
		perform regular physical inspections
		include the wiring closet in the organization's environmental management and monitoring

	Server Rooms
		= enclosed, restricted, protected rooms where mission -critical servers and networks devices are housed
		need not be human compatible
		designed to supprt optimal operation of the IT infra and to block unauthorized human access or intervention

	Media Storage Facility
		store blank media, reusable media, and installation media
		secure blank media from planting malware on it
		
		Data remnants = data left aftr deletion or formating process

		some means of implementation:
			store media in lockect cabinet
			have a librarian/custodian
			use a checkin/checkout
			use sanitization or zeroisation to remove all data remnants on reusable data

		Evidence Storage
			important to retain image copies of drives or snapshots of virtual machines for future comparison
			secure evidence storage:
				dedicated storage system
				potentially keep the storage system offline
				block internet connectivity
				tracking all activity
				calculate hashes
				limit access
				encrypt all datasets stored
		
		Restricted and work area security (Operations Centers)
			shoulder surfing = gathering information grom a system byobserving the monitor or the use of the keyboard by operator

		Datacenter Security
		Smart Cards
			= credit card sized ID, badges or security passes with embedded magnetic strip, bar code or integrated circuit chip
			= identity token containing integrated circuit
			= processor ID card
			= IC card with ISO 7816 interface
			can fall prey to physical attacks, logical attacks, trojan horses, social engineering
			use multifactor configurations
		Memory Cards
			= machine readable ID card with magnetic strip
			can reatin small amounts of data but cannot process data like smart card
			often 2 factor control: card = something you have / PIN = something you know
			easy to copy or duplicate
		
		Proximity reader
			= passive device, field powerred device or transponder
			worn or held by authorized bearer
			no active electronics
		
		Intrusion Detection System IDS
			= systems, automated or manual, designed to detet an attempted intrusion, breach, or attack
			burglar alarms = physical intrusion detection systems
				use simple circuit (aka dry  contact switches) consisting of foil tape in entrance point 
			usefull only if conected to an intrusion alarm
			how it gets its power and how it communicates
			heartbeat sensor for line supervision
				= mechanism by whiwh pathway is constantly or periodically checked with a test signal

		Access Abuses
			masquerading = using someone else's security ID
			piggybacking = following someone through a secured gate without being authentified
			needs audit trails and access logs
			CCTV enables you to compare the audit log trails and access log with a visual recording of the event

		Emanation security
			TEMPEST countermeasures
			faraday cage = box design with external metal skin,acts like an EMI absorbing capacitor
			white noise = broadcast false traffic at all time
				can be real signal from another source not confidential, constant signal, arandomly variable signal, or a jam signal that causes equipment to fail
			control zone = prtotected specific area with emanation TEMPEST countermeasure

		Utilities and HVAC considerations
			UPS Uninterruptible power supply 
			surge protectors against power fluctuations
			electric generator (working on fuel tank of liquid or gazeous propellant) are considered as alternatee or backup power sources
			Power issues:
				fault = momentary loss of power
				blackout = complete loss of power
				sag = momentary low voltage				
				brownout = prolonged low voltage
				spike = momentary high voltage
				surge= prolonged high voltage
				inrush = initial surge of power associated with connecting to a power source
				noise = steady interfering power disturbance or fluctuation
				transient = short duration of line noise disturbance
				clean = non fluctuating pure power
				ground = a wire in an electrical circuit that is grounded

		Noise
			2 types of EMI: common mode and traverse mode
			common mode = generated by a difference between hot and ground wires of a power source
			traverse mode noises = generated by a difference between hot and neutral wires of a power source
				
		Temperature Humidity and Static
			Static voltage	Possible damage
			40		sensitive circuit
			1000		scrambling monitor display
			1500		destruction of data stored on hard drives
			2000		abrupt system shutdown
			4000		printer jam or component damage
			17000		permanent circuit damage

		Water issues
			shutoff valves and drainage locations
			monitoring plumbing leaks
		
		Fire Prevention, detection, Suppression
			fire triangle: Heat-Oxygen-Fuel-Chemical Reaction
			water suppresses temperatures
			soda acid or dry powders suppress fuel supply
			CO2 suppress O2 supply
			halon substitutes and other nonflammable gases interfere with the chemistry of combustion and/or suppress O2 supply

			4 stages:
				incipient stage: air ionization but no smoke
				smoke stage: 
				flame stage
				heat stage		

			Most fires in a datacentr are caused by overloaded electrical distribution outlets

		Fire extinguisher classes:
			A 	common combustibles	Water, soda acid
			B	Liquids			CO2, Hallon, Soda Acid
			C	Electrical		CO2, halon
			D	Metal			Dry Powder

		Fire Detection Systems
			fixed temperature detection system
			rate of rise detection system: speed at which the temp changes
			flame actuated: infrared energy of flame
			smoke-actuated: photoelectric or radioactive ionization

		Water suppression systeù	
			wet pipe system = closed head system, always full of water
			dry pipe system = contains compressed air
			deluge system = larger pipes, inappropriate for electronics
			preaction system = combination of dry pipe/wet pipe

		Gas discharge system
			usually remove oxygen from air
			should not be used where people are located
			use Halon, CO2 or FM-2000 (halon replacement)

			Halon: effective fire suppression compound, degrades into toxicat 900 F°, not environment friendly
				replaced by: FM-200 (HFC-227ea), CEA-410 or CEA-308, NAF-S-III (HCFC Blend A), FE-13 (HCFC-23), Argon (IG55) or Agonite (IG01), Inergen (IG541)
			
		Damage
			100 F°can damage storage tapes,175 °Fcomputer hardware, 350 °F paper products
			
			
Implement and manage Physical Security
		
	Perimeter: Access control and Monitoring
		
		Fence = perimeter defining device
		Gate = control exit and entry point in a fence
		turnstile = form of gate that prevent more than one person at a time, entry or exit but not both
		mantrap = double set of doors often protected by a door
				= delay feature

	Lightning
		= not strong deterrent
		2 candle feet of power minimum
		pole should be placed same distances as diameter of illuminated area
		
	Security Guards and dogs
		can make deicision and adapt
		vulnerable to social engineering
		
	Internal security (escort requirment/visitor control, keys, locks)
		keys and combination locks
			lock = crude form of an identification au authorization
			preset lock = subject to picking (included in mechanism attacks called shimming)
			EAC = Electronic Access Control Lock
					
		badges
			= form of physical identification and EAC
			can be a simple name tag or a complex smarcard or token device

		Motion detectors
			infrared, heat-based, wave pattern, capacitance, photoelectric, passive audio

		Intrusion Alarms
		Deterrent Alarms
		Repellant alarms
		Notification Alarms = often silent to the intruder
		Local alarm system = easily heard up to 400 feet aay
		Central Station System 
			Proprietary system = organization has its own onsite security system
		Auwiliary station

	Secondary Verification Mechanisms
		to reduce false alarms
		

============================================================================================================

Chapter 11
Secure Network Architecture and Securing Network components

============================================================================================================
OSI functionnality
	7.Application	
	6.Presentation
	5.Session
	4.Transport				
	3.Network
	2.Data Link
	1.Physical


============================================================================================================

OSI model
	early 1980, by ISO 7498
	= abstract framework, or theorical model, for how protocols should function with in an ideal world on ideal hardware
	
	OSI functionnality
		7 distinct layers, numbered from bottom to top
		each layer communicate with the upper layer, the layer above and the peer layer on the communication partner system

		7.Application	
		6.Presentation
		5.Session
		4.Transport				
		3.Network
		2.Data Link
		1.Physical

	Encapsulation/Deencapsulation
		encapsulation = addition of a header, and possibly a footer, to the data received by each layer from the layer above before it's handed off to the layer below
				previous layer's header and payload combine to become the payload of the current layer
	
		from application layer to the session layer the message is called the data stream
		Transport layer: segment (TCP Protocols) or datagram (UDP Protocols)
		Network layer: packet 
		Data Link layer: Frame
		Physical: bits

	OSI Layers
		
		Physical Layer
			receives bits from the physical connection and convert them into a frame for the Data Link layer	
			electrical specifications, protocols, and interface standards:
				EIA/TIA-232 and EA/TIA-449
				X.21
				High Speed Serial Interface
				Synchronous Optical Network SONET
				V.24 and V.35
			network hardware: 
				Network Interface Cards (NICs), hubs, repetitors, concentrators, amplifier

		Data Link	
			responsible for formatting the packet from the Network layer into the proper format for transmission
			depends on networks and the technology of the network:
				Ethernet (IEEE 802.3)
				Token Ring (IEEE 802.5)
				Asynchronous Transfer Mode (ATM)
				Fiber Distributed Data Interface (FDDI)
				Copper DDI (CDDI)
			adds hardware source and destination addresses to the frame
			protocols:
				SLIP: Serial Line Internet Protocol
				PPP: Point to Point Protocol
				ARP: Address Resolution Protocol
				RARP: Reverse ARP
				L2F: Layer 2 Forwarding
				L2TP: Layer 2 Tunneling Protocol
				PPTP: Point to Point Tunneling Protocol
				ISDN: Integrated Services Digital Network
			hardware address = MAC (Media Access Control) address
				6 bytes (48 bits) written in hexadecimal rotation: 00-13-02-1F-58-F5
				OUI Organizationally Unique Identifier = first 3 denote vendor or manufacturer: 00-13-02
				device cant have the same MAC address on the same local ethernet broadcast domain > conflicts occur
				EUI-48: adds 2 octets between the OUI and the unique NIC: cc:cc:cc:FF:FF:ee:ee:ee
					EUI: Extended Unique Identifier
				EUI-64 as preparation to IPv6: cc:cc:cc:FF:FE:ee:ee:ee
				ARP Address Resolution Protocol: used to resolve IP address using MAC addresses
				RARP Reverse Address REsolution Protocol: resolve MAC address into IP address
			contains 2 sublayers:
				LLC Logical Link Control (IEEE 802.2)
				MAC 
			hardware: switches and bridges
			
		Network Layer
			responsible for adding routing addressing information to the data, including error detector and node data traffic, not for verifying  guaranteed delivery ( > transport protocol)
			accepts segment from the transport Layer and adds information to it to create a packet, including source and destination IP address
			routing protocol:
				ICMP Internet Control Message Protocol
				RIP Routine Information Protocol
				OSPF Open Shortest Path First
				BGP Border Gateway Protocol
				IGMP Internet Group Management Protocol
				IP Internet Protocol
				IPsec Internet Protocol Security
				IPX Internet  Packet Exchange (Novell Netware, part of IPX/SPX protocol)
				NAT Network Address Translation
				SKIP Simple Key Management for Internet Protocol

			nonIP protocol: IPX, Appletalk (by Apple in 1984) and NetBEUI (NetBIOS Extended User Interface)
				deadzone: network segment unis an alternative Network layer protocol instead of IP
				NetBEUI (aka NetBIOS Frame Protocol or NBF) by Microsoft in 1985 support file and printer sharing
					devised by NetBIOS over TCP (NBT) which support SMB (Server Message Block) or CIFS (Common Internet File Sharing)
				routers cant filter packet from nonIP protocol, even if encapsulated: set to an allow-all or deny-all configuration

			hardware device: 
				Routers
					determine the best logical path for the transmission of the packets based on speed, hops, preference,...
					use IP address
				Brouter (bridge routers) work primarely in layer 3, but if fails, defaults to bridging
				
			distance vector routing protocol: maintain a list of destination networks along with metrics and distance of direction (hops)
				ex.: RIP (Routing Information Protocol), IGRP (Interior Gateway Routing Protocol), BGP (Border Gateway Protocol)
			Link State routing protocol: maintains a topography map of all connected networks and use it to determine the shortest path to destination
				ex.: OSPF (Open Shortest Path First)

		Transport Layer
			responsible for managing the integrity of a connection and controlling the session
			accepts PDU (Protocol Data Unit or Packet Data Unit, or Payload Data Unit) from the session layer and convert it into a segment
			controls how devices on the network are addressed or referenced, establish communication between nodes (or devices) and define rules of a session
			session rules:
				specify how much data a segment can contain
				how to verify integrity of data transmitted
				how to determine if data have been lost
				establish through handshaking process
				provides end-to-end transport services: segmentation, sequencing, error checking, flow control, error correction, multiplexing, network service optimization
			protocols:
				Transmission control Protocol TCP
				User Datagram Protocol UDP
				Sequenced Packet Exchange SPX
			Secure Sockets Layer SSL
			Transport Layer Security TLS	
			
		Session Layer
			responsible for establishing, maintaining, terminating communication sessions between 2 computers
			manage dialogue discipline or dialogue control:
				-simplex (one way direction)
				-half duplex (2 way but only one direction at a time)
				-full duplex (2 way, both direction at a time))
			establishes checkpoints for grouping and recovery
			retransmits PDU failed or lost since last verified checkpoint
			Protocols:
				NFS Network file System
				SQL Structure Query Language
				RPC Remote Procedure Call
		
		Presentation Layer
			responsible for transforming data received from the Application Layer into a format that any system following OSI can understand
			imposes common and standardized structure and formatting rules
			encryption and compression
			Formats
				ASCII American Standard Code for Information Interchange
				EBCDIC Extended Binary-Coded Decimal Interchange Mode
				TIFF Tagged Image File Format
				JPEG Joint Photographic Expert Group
				MPEG Moving Picture Expert Group
				MIDI Music Instrument Digital interface

		Application Layer
			responsible for interfacing user applications, network services or the operating system with the protocol stack
			allows applications to communicate with the protocol stack
			determines whether a remote communication partner is available and accessible
			assure that sufficient ressources are available
			application-specific protocol:
				HTTP Hypertext Transfer Protocol
				FTP File Transfer Protocol
				LPD Line Print Deamon
				SMTP Simple Mail Transfer Protocol
				Telnet
				TFTP Trivial File Transfer Protocol
				EDI Electronic Data Interchange
				POP3 Post Office Protocol v3
				IMAP Internet Message Access Protocol
				SSNMP Simple Network Management Protocol
				NNTP Network News Transport Protocol
				S-RPC Secure Remote Procedure Call
				SET Secure Electronic transaction 

			Hardware components:
				gateway	(serves as protocol translation tool)
				Application layer firewall

TCP/IP Model
	= DARPA or DOD model
	consists of 4 layers
		Application <> Application+Presentation+Session
		Transport (= host to host) <> Transport
		Internet (= internetworking) <> Network
		Link (= network interface/network access) <> Physical+Data Link

	TCP/IP Protocol Suite Overview
		= platform-independant protocol based on open standard
		easy to hack < designed for ease of use rather than for security
		
		Layer:		Protocols:
		Application	FTP / Telnet / SNMP / LPD / TFTP / SMTP / NFS / XWindows
		Transport	TCP / UDP
		Internet	ICMP / IGMP / IP
		Link		Ethernet / Fast Ethernet / Token Ring / FDDI

		can be secured using VPN between systems
		VPN linked are encrypted, use the PPTP protocol (Point-to-Point Tunneling Protocol), layer 2 Tunneling Protocol (L2TP), and IPsec
		TCP wrappers = application that can serve as a basic firewall based on user IDs and system IDs
			using TCP wrapper = form of Port Based Access Control

		Transport Layer Protocol
			= TCP (fullduplex, connection oriented) and UDP (simplex connectionless protocol)
			have each 65 536 ports (16-digits binary number)
			port (port + ipaddress = socket) allows a single IPaddress to be able to support mmultiple simultaneous communications
				ports 0-1023 called welll-known ports or service ports (standardized assignement)
					port 80 = standardized for HTTP
					port 23 = telnet
					port 25 = SNMP
				
				ports 1024-49151: registered software ports (registered with IANA (International Assigned Numbers Authority))
		 		ports 49152-65535: random, dynamic, or ephemeral ports

				not all OS respect IANA classification:
					BSD uses 1024-4999
					Many Linux kernel use 32768-61000
					Windows until Server 2003: 1025-5000
				
			TCP
				operates at layer 4
				full-duplex
				connection oriented (handshake process)
				support reliable sessions
			
				Handshake process:
					1. Client sends a SYN (synchronize) flagged packet to the server
					2. Server responds with SYN/ACK flagged packet back to the client
					3. Client respond with ACK

				2 methods for ending:
					use of FIN (finish) flagged packets instead of SYN
					use RST (reset) flagged packet
				
				segments of TCP are tagged with sequenced number > receiver can rebuild by reordering segments
				communication periodically verified with acknowledgment
				Data flow control through sliding windows (different number of transmitted packets between acknowledgement)
					TCP header = 20 to 60 bytes
					16bits		Source port
					16bits 		Destination port
					32bits		Sequence number
					4		Data offset
					4		Reserved
					8		Flags
					16		Window size
					16		Checksum
					16		Urgent pointer
					Variable	Options, must be multiple of 32bits

				TCP Header Flag field value (memory hack (only last 6 flags): Unskilled Attackers Pester Real Security Folk)
					CWR	Congestion Window Reduced
					ECE	ECN-Echo (Explicit Congestion Notification)
					URG	Urgent
					ACK	Acknowledgement
					PSH	Push
					RST	Reset
					SYN	Synchronization
					FIN	Finish
				
				IP header protocol field value for TCP is 0x06
				protocol field value = label found in every IP packet that tells the receiving system type of packet
				hex representation of TCP header is typically offset position 0x2F in raw data display  of capturing tool (like Wireshark)	

			UDP
				operates at layer 4
				connectionless 'best effort' communications protocol
				no error detection or correction, no sequencing, no flow control, no preestablish session, unreliable
				transmit data quickly
				realtime or streaming communication
				IP header protocol field value for UDP: 0x11 (17)
				UDP header = 8bytes
					source port
					destination port
					message length
					checksum

		Network Layer Protocols and IP Networking Basics
				
			IP
				operates at Network layer (layer 3)
				provides route addressing for data packets
				connectionless,unreliable datagram service	

			IP classes
				Class	First Binary Digits	Decimal Range of First Octet
				A	0			1-126
				B	10			128-191
				C	110			192-223
				D	1110			224-239
				E	1111			240-255	

			IP classes default subnet mask
				Class	Default subnet Mask	CIDR Equivalent
				A	255.0.0.0		/8
				B	255.255.0.0		/16
				C	255.255.255.0		/24	

			CIDR Classless Inter-Domain Routing: combine multiple noncontiguous sets of adresses into a single subnet	
			
			ICMP
				used to determine the health of a network or specific link
				utilized by ping, traceroute, pathping
				exploited in bandwidth based DoS attacks: ping of death, smurf attacks and ping floods
					ping of death: sends a larger than 65535bytes 
					smurf attack: generate enormous amounts of traffic on a target network by spoofing broadcast pings
					ping floods: classic DoS attack
				
				IP header protocol field value is 1 (0x01)
				type field in ICMP header defines types or purpose of the message in the ICMP payload
					40 types but only 7 commonly used:
						0	Echo reply
						3	Destination unreachable
						5	Redirect
						8	echo request
						9	router advertisement
						10	router solicitation
						11	time exceeded

			IGMP
				allows system to support multicasting (= transmission of data to multiple specific recipients)
				single initial signal is multiplied at the router if divergent pathways exist to the intended recipients
				IP header field value is 2 (0x02)

			ARP and RARP
				essential to interoperability of logical and physical addressing schemes
				use casting and broadcasting
				first step = check the ARP cache (abused by ARP cache poisoning)
				
		Common Application Layer Protocols
			telnet port 23
			FTP port 20 and 21
			TFTP, UDP port 69
			SMTP, TCP port 25
			POP3, TCP port 110
			IMAP, TCP port 143
			DHCP, UDP port 67 and 68
			HTTP, TCP port 80
			SSL, TCP port 443 (for HTTP encryption)
			LDP, TCP Ports 515
			X Windows, TCP ports 6000-6063
			BootP/DHCP, UDP port 67 and 68
			NFS, TCP port 2049
			SNMP, UDP port 161 (162 for trap messages)

		Implication of Multilayer Protocols
			HTTP encapsulated in TCP, encapsulated in IP, encapsulated in Ethernet:
				[ Ethernet [ IP [ TCP [ HTTP ] ] ] ]
			adding SSL/TLS encryption:			
				[ Ethernet [ IP [ TCP [ SSL [ HTTP ] ] ] ] ]
			encapsulated in IPsec:
				[ Ethernet [ IPsec [ IP [ TCP [ SSL [ HTTP ] ] ] ] ] ]
			HTTP tunnel encapsulated FTP to by pass a FTP restriction:
				[ Ethernet [ IP [ TCP [ HTTP [ FTP ] ] ] ] ]
			Loki (ICMP transformed into a tunnel protocol to support TCP communications):
				[ Ethernet [ IP [ ICMP [ TCP [ HTTP ] ] ] ] ]
			unbounded encapsulation support jump between VLAN: VLAN hopping
				[ Ethernet [ VLAN1 [ VLAN2 [ IP [ TCP [ HTTP ] ] ] ] ] ]
					first encountered switch will strip away the first VLAN tag, and then the second will be fooled by the interior VLAN tag dans move traffic into the other VLAN

			multilayer protocols benefits:
				wide range of protocol used at higher layers
				encryption can be used at various layers
				flexibility and resiliency in complex network structures is upposrted
			multilayer protocols drawbacks:
				covert channels are allowed
				filters can be bypassed
				logically imposed network segment boundaries can be overstepped

			DNP3 (Distributed Network Protocol)
				primarily used in electric and water utility
				multilayer protocol similar to TCP/IP, with link, trnasport and transportation layer
			
		TCP/IP vulnerabilities
			buffer overflows, SYN flood, DoS, fragment, oversized packet, spoofing, man-the-middle, hijack, coding error
			network monitoring: monitoring traffic patterns to obtain informatino about a network
			packet sniffing: capturing packets to extract usefull information like usernames, passwords, email address, encryption keys, credit card number, IP address, system names...
			
		Domain Name Resolution
			third, or bottom, layer: MAC address = permanent physical address
			second, or middle: IPaddress = temporary logical adress
			first, or top: domain name = temporary  human-friendly convention assigned name

			use DNS/DNS reserve lookup and ARP/RARP
				Kamininsky DNS vulnerability

Converged Protocol
		
	FCoE (Fiber Channel over Ethernet)
		encapsulate FC communications over Ethernet networks
		operates at layer 3, replacing IP as the payload of a standard Ethernet networks

	MPLS (Multiprotocol Label Switching)
		= high throughput high performance network technology, based on short path labels
		saves significant time over traditional IP-based routing processes
		design to handle wide range of protocols through encapsulation, not limited to TCP/IP
		enables uses of other networking techno: T1/E1, ATM, Frame relay, SONET, DSL

	Voice over IP
		tunnel mechanism used to transport voice and/or data over a TCP/IP network
		software only(Skype) or hardware (magicJack)
	
	Software defined networking (SDN)
		separate infrastructure layer from control layer
		allows mix hardware instead of single vendor
		settings can be changed dynamically

	Content Distribution Network (CDN)
		media distributed in nmuerous locations across the network
		CloudFlare,Akamai, Amazon Cloudfront, Cachefly, Level 3 Communications
		client-based CDN = P2P, most recognized is BitTorrent

Wireless Network
	Data emanation = transmission of data across electromagnetic signals

	Securing Wireless Access Points
		Wire cells = areas within physical environment where wireless device can connect
		to maximize authorized user acces and minimize intruder access: placement of wireless access points, sheiling, and noise transmission

		Amendements	Speed		Frequency
		802.11		2Mbps		2.4 GHz
		802.11a		54Mbps		5 GHz
		802.11b		11Mbps		2.4 GHz
		802.11g		54Mbps		2.4 GHz
		802.11n		200+ Mbps	2.4 GHz or 5 GHz
		802.11ac	2Mbps		5 GHz

		b,g and n use same frequency > maintain backward compatibility

	ad hoc mode: 2 networking device can communicate without centralized control authority
	infrastructure mode: wireless access point is required, different modes:
		stand-alone: no wired resources, serves as wireless hub
		wired extension: link wireless clients to wired network
		enterprise extended: multiple Wireless Acces Points (WAP) used to connect a large physical area
			each WAP use a ESSID (Extended Service Set Identifier)
		bridge: link 2 wired network

		SSID (Service Set Indentifier)
			ESSID: WAP used in infrastructure mode
			BSSID (Basic SSID):ad-hoc and peer-to-peer mode
			in infrastructure mode: BSSID = MAC address of the base station hosting the ESSID, to diffirentiate multiple base stations supporting a single extended wireless network

	Wireless Channel
		= subdivision of the frequency of the wireless signal
		= lane on a highway
		11 channel in US, 13 in EU, 17 in Japan
		set channels as diffrently as possible to avoid interference

	Securing the SSID
		SSID = silimar to the name of a workgroup
		broadcast by WAP via a special transmission called a "beacon frame"
		disabling SSId is not true security: SSID is needed to direct packets to and from base station and can be sniffed
			WPA2 for authentication and encryption is !

	Conducting a Site Survey
		site Survey = process of investigating the presence, strengh, and reach of wireless access points deployed
		
	Using Secure Encryption Protocols
		IEEE 802.11 standard defines 2 methods of authentifcation:
			OSA (Open System Authentication) = no real authentication
			SKA (Shared Key Authentication) = some of authentication must take place
				defines WEP (Wired Equivalent Privacy), later: WPA and WPA2

	WEP
		defined by IEEE 802.11 standard
		provides protection against packet sniffing and eavedropping against wireless networks
		uses a predefined shared secret key, shared among all WAP and device interfaces, to encrypt packets
		hash value is used for integrity
		employs Rivest Cipher 4 (RC4), a symmetric stream cipher
		cracked in less than one minute

	WAP (Wifi Protected Access)
		replacement of WEP
		802.11i defined WAP, but name was allready widely used, so named it WPA2
		similar to IPsec
		based on LEAP and TKIP encryption, often use passphrase (abused by brute force)
		
	WAP2
		amended by 802.11i
		new encryption: Counter Mode Cipher Block Chaining Message Authentication Code Protocol (CCMP)
 			based on AES encryption scheme
		not allready cracked 
		
	802.1x/EAP
		= enterprise authentication
		= standard port-based network access
		other techniques can be integrated: RADIUS, TACACS, certificates, smart cards, token devices, biometrics...

	EAP (Extensible Authentication Protocol)	
		= authentication framework
		= design for use over physically isolated channels
		more than 40 different EAP methods of authentication are supported: LEAP, EAP-TLS, EAP-SIM, EAP-AKA, EAP-TTLS
		EAP-MD5 and pre-release EAP known as LEAP are also crackable

	PEAP (Protected EAP)
		encapsulate EAP into TLS tunnel
		provide encryption for EAP methods
		
	LEAP (Lightweight EAP)
		Cisco alternative to TKIP for WPA
		cracked by Asleap, in 2004
		
	MAC filter
		= list of authorized wireless client interface MAC address authorized only
		abused by MAP address spoofing

	TKIP
		designed as replacement for WEP
		implemented in 802.11 as WPA
		include combines IV with the secret root key before using that key for RC4 encryption
		sequence number to prevent packet replay attacks
		strong integrity check named Michael is used
		officially replaced by WPA in 802.11i in 2004
		WPA abused by coWPAtty and GPU-based cracking tool

	CCMP
		use AES with 128bit Key
		prefered encryption indicated in 802.11i
		not yet successfull attack on AES/CCMP encryption
			
	Determining Antenna Placement
		use central location
		avoid solid physical obstruction
		avoid reflective or flat surface metal
		avoid electrical equipment
		
	Antenna types
		omnidirectionnal: base antenna or rubber duck antenna
		directionnal: Yagi, cantenna, panel, parabolic
		parabolic: focus very long distance or weak source

	Adjusting Power level Control
		reset/rebot the WPA before re performing site survey
		lowering sometimes improve performance

	Using Captive Portal
		redirects newly connected wireless Web client to a portal access control page
		
General Wi-Fi Security Procedure
	1. Change default administrator password
	2. Disable SSID broadcast
	3. change SSID to something unique
	4. enable MAC filtering (when few clients only)
	5. Consider using static IP address or DHCP with reservation
	6. turn on highest form of authentication and encryption supported (currently WPA2)
	7. treat wireless as remote accces, and manage access using 802.1X
	8. treat wireless as external access, and separate WAP from the wired network using a firewall
	9. treat wireless as an entry point for attackers, and monitor all the WAP-to-wired-network communications with an IDS
	10.require a VPN link (encryption between all wireless clients and WAPs)

	Secure Network components
		intranet = private network with same information service as internet
		extranet = cross between intranet and internet, acts like intranet for private network but serves information to the public Internet
			often reserved for specific use by partner and customers
			typically labeled as Demilitarized zone DMZ
		networks are usually segmented into smaller organization units
			boosting performance: systems that often communicate are located in the same segment
			reducing communication problems: reduces congestion and contain communication problems (like broadcast storm) to individual subsections
			provides security: isolating traffic and user access
		
			created by using Switch-based VLANs, routers, firewalls

	Network Access Control (NAC)
		= controlling access in order to:
			prevent/reduce zero-day attacks
			enforce security policy through the network
			uses identities to perform access control
						
		802.1X is just a component of NAC
		preadmission NAC: system meets all the requirement before allowed to communicate
		postadmission NAC: allows and denies acces based on user activity, based on predefined authorization matrix

		issues about:
			client/system agent versus overall network monitoring (agent-less)
			out-of-band versus in-band monitoring
			resolving remediation, quarantine, captive portal strategies

	Firewall
		tools in managing and controlling network traffic
		typically deployed between intranet and a link to internet, or between segments in an organization
		filter traffic based on a defined set of rules called filters or access control list
		most effective against unrequested traffic and attemps to connect from outside
		can block known malicious data, messages, or packets based on content,application, protocol, port, or source address
		capable of hiding structure and addressing scheme of a privte network
		offers extensive logging, auditing, and monitoring capabilities like alarms and basic IDS functions
		should log:
			a reboot of the firewall
			proxies or dependencies being unable to start or not stating
			proxies or other important services crashing or restarting
			changes to the configuration file
			configuration or system error while firewall is running
		
		Static-Packet filtering firewalls:
			first generation firewalls
			filters traffic by examining data from a message header
			operates at layer 3
			unable to provide user authentication 
			easely fooled by spoofed attack
			= screening routers or common routers

		Application-level Gateway Firewalls
			second generation firewalls			
			operate at application layer
			= proxy firewalls
			proxy = mechanism that copy packets from a network to another network
				copy process changes source and destination to protect the identity of internal or private network
			each type of application should have its own unique proxy server
			affects performance due to processing all packets	

		Circuit-level Gateway Firewalls
			establish communication sessions between trusted partners
			operates at session layer
			SOCK (from Socket Secure)
			= circuit proxies
			manage commnication based on the circuit, not the content
			second generation < represent a modification of the application-level gateway firewall

		Stateful Inspecion Firewall
			= dynamic packet filtering firewall
			examines source and destination, application usage, source of origin, relationship between current packet and the previous packet
			third generation firewalls
			operates at layer 3 and 4 (Network and Transport)
	
		Multihomed firewalls
			= at least 2 interface to filter traffic (dual-homed firewall)
			IP forwarding disable
	
			bastion host (or screened host) 
				= firewall system logically positioned between  a private network and an untrusted network
				behind the router, all inbound traffic is routed to the bastion host, which act like as a proxy for all the trusted systems within the private network
			screened subnet
				= similar to bastion host, except the host is located is placed between 2 routers in a subnet
				= concept of DMZ (= network area that is accessible from extarnal user but still isolated from the private network)
					often host of public web, email, files, and other resource server

		Firewall deployment architecture
			
			single tier
				internet -- router -- firewall -- Private network

			two tier I
				internet -- router -- firewall --- Private network
								|		
								-- DMZ
			two tier II
				internet -- router -- firewall -- DMZ -- Firewall -- Private network
		
			three tier I
				internet -- router -- firewall -- DMZ -- Firewall -- Transaction Subnet -- Firewall -- Private network

			Three tier II
				internet -- router -- firewall -- Transaction Subnet -- Firewall -- Private network
								|		
								-- DMZ	

		Endpoint Security
			
			each individual device must maintain local security
			any weakness in the network presents a risk to all elements
			threat now exists from within as well as from without
			network is as secured as its weakest element

		Other Network Device
			
			collision: 2 systems transmit data at the same time onto a connection medium that supports only a single transmission path
			collision domain: grouped of networked systems that could cause a collision
				divided by using layer 2 or higher device

			broadcast: a single system transmits data to all possible recipients
			broadcast domain: group of network systems which receive a broadcast signal when one of the members transmit it
				divided by using layer 3 or higher device

			Repeaters, concentrators and amplifiers
				OSI layer 1
				stregthen the communication signal over a cable segment

			Hubs
				OSI layer 1
				connect multiple systems and network segments that use the same protocol
				repeat inbound rtaffic over all outbound ports

			Modems
				communications device that covers or modulates between an analog carrier signal and digital information

			Bridges
				OSI layer 2
				connect 2 different networks that use the same protocol
				may use buffer in case of different speed network = store and forward device	
	
			Switches
				OSI layer 2, sometimes 3
				switch repeats traffic only to the ports on which the destination is known to exist													
			Routers
				OSI layer 3
				control traffic flow and connect similar networks
				can use a defined routing tables or deploy a dynamic routing system
				routing protocol: RIP, OSPF, BGP
			Brouters
				combines router and bridge
				OSI layer 3, but 2 if necessary
			Gateways
				connect networks that are using different protocols
				= protocol translators
				stand-alone hardware device or software device (IP-to-IPX gateway)
				typically operate at layer 7
			Proxies
				= form of gateway that does not translate across protocols
				serve as mediators, filters, chaching servers, and even NAT/PAT servers for a network
				perform a function or requests a service on behalf of another system and connects network segments that use the same protocol
				often used to provide clients on a private network with internet access while protecting identity of the client
				accepts requests from clients, alters the source address of the client, maintain a mapping of requests to clients and ends the altered packet out
					= NAT (Network Address Translation)
			LAN extenders
				= remote access, multilayer switch used to connect distant networks over WAN links
				= WAN switch or WAN router

Cabling, Wireless, Topology abd communications Technology
	
	LAN (Local Area Network) = network typically spanning single floor or building
	WAN (Wide Area Network) = long distance connections between geographically remote networks

	Network Cabling

		Coaxial Cable
			center core of copper wire, surrounded by a layer of insulation, which is surrounded by a conductive braided shielding
			allow 2 way connection
			resistant to EMI, longer usable lenght as twisted pair
			require use of segment terminator (50 ohm sector)
			Thinnet (or 10base2): connect systems to backbone trunks, 185m span distance at 10Mbps
			Thicknet (or 10base5): 500 span distance at 10Mbps
		
		Baseband and Broadband Cables
			syntax XXyyyyZZ
				XX = maximum speed
				yyyy = baseband (single signal) or broadband (multiple signal)		
				ZZ = maximum distance in x100m

		Twisted Pair
			extremely thin and flexible compared to coax
			if there is a metal foil wrapper > Shielded Twisted Pair STP, if not > Unshielded Twisted Pair UTP
			refer as 10Base-T, 100Base-T or 1000Base-T
			the tighter the twist (twits per inch) the more resistant to internal and external resistance
			maximum 100m

		5-4-3 Rule
			used whenever a Ethernet or other IEEE 802.3 shared-access network are deployed
			defines the number of repeaters/concentrators and segments that can be used in network design
			> between any 2 nodes, there can be a maximum of 5 segments connected by 4 repeater/concentrators, only 3 of those segments can be populated

	Network technologie
		= grouping of networked systems into trusted collectives
		
		Ring: connects each system as points in a circle
			connection medium acts like an unidirectional transmission loop
			onlyone system can transmit data at a time
			traffic management is performed by a token
			sometimes dual loop > bidirecionnal and avoid SPOF of the single loop

		Bus Technologie: connects each system to a trunk or backbone cable
			all system on the bus can transmit data simultaneously > possible colision
			colision avoidance mechanism that listens for any currently occuring traffic
			if a system fails, all communication continue
			backbone trunk = SPOF
			Ethernet = bus-based techno

		Star Topologie: employs a centralized  connection device (= switch or hub)
			central hub = SPOF
				
		Mesh Topologie:
			connects systems to other systems using numerous paths
			partial mesh connects each systems to many other systems
			provide redundant connections, no SPOF

	Wireless Communications and Security
		
		General Wireless concept
			employ radio waves to transmit signals over a distance
			finite amount of radio wave spectrum, needs to be manage to avoid interference between multiple simultaneous uses
			Radio waves: 3Hz to 300GHz
				900MHz, 2.4GHZ and 5GHz are most commonly used because of unlicensed categorization
			spread spectrum: communication over multiple frequencies at the same time

			Frenquency Hopping Spread Spectrum (FHSS): 
				transmit data in series while constantly changing frequence of use
				receiver has to follow the the same hopping pattern to pick up the signal

			Direct Sequence Spread Spectrum (DSSS)			
				employ all available frequencies simultaneously in parallele
				higher rate of data than FHSS
				encoding mechanism as chipping code to reconstruct data (same way as RAID5)
				
			Orthogonal Frequency-Division Multiplexing (OFDM)
				uses a digital multicarrier  modulation scheme
				modulated signal are orthogonal, and do not cause interference with each other
				smaller frequency set, greater data throughput

		Cell Phones
			xG refers to generation
			1G = mostly analog phones
			2G+ = mostly digital

			transmit not only voice, but text, data, and are not secure
			provider's tower can be simulated to conduct man-in-the-middle attack
			can be sniffed
			can act like a bridge, creating unsecure access into the network

			Wireless Application Protocol (WAP)
				= functionning industry-driven protocol stack to connect to internet
				= suit of protocols working together
					including WTLS (Wireless Transport Layer Security)

			Communications Assistance for Law enforcement Act (CALEA) mandates that telco must make it possible to wiretap voice and data > no encryption allowed
				> secure link is established using WAP/WTLS, data is converted into clear form before being reencapsulated in SSL, TLS, IPsec
				> whenever possible, feed pre-encrypted data into the telco link...

		Blutooth (802.15)
			= personal area networks
			use pairing, system scan for available device at 2.4GHz
			4 digit used to authorize pairing
			bluejacking: allow attacker to transmit SMS-like messages to your device
			Bluesnarfing: connect to bluetooth device without our knowledge and extract data
			Bluebugging: grants hackers remote control on the device
			
			sometimes use encryption, but easely crackable
			
		Cordless Phones
			designed to use at 900MHz,2.4GHz or 5GHz
			signal rarely encrypted

		Mobile Devices
			

	LAN Technologie
		
		Ethernet
			=shared-media LAN technologie (= broadcast technology)
			devices take turns communicating and performing collision detection and avoidance
			cupport full-duplex communications and usually employs twitsted-pair cabling
			often star or bus topology
			based on IEEE 802.3 standard
			individual unit are called frame
			Fast Ethernet support 100Mbps, Gigabit Ethernet 1Gbps, 10 Gigabit Ethernet 10Gbps

		Token Ring
			employs token-passing mechanism
			
	Fiber Distributed Data interface (FDDI)
		high speed token-passing techno that empoys 2 rings with traffic flowing in opposite directions
		often used as backbone in large enterprise network
		CDDI (Copper Distributed Data Interface) use twisted pair cables

		Subtechnologies
			
			Analog and digital
				analog: uses continuous signal that varies in frequency, amplitude, phase, voltage...
					variance produce a wave shape (opposed to square shape of digital signal)
					more subject to interference and attenuation
				digital: uses discontinuous electrical signal and a state of change or on-off pulse

			synchronous and asynchronous
				synchronous:  rely on timing or clocking mechanism based on an independant clock or time stamp embedded in the data stream
					support typically high rate of data transfer
				Asynchronous: rely on stop and start delimiter bit to manage the transmission of data
					best suits for smaller amount of data
					ex.: PSTN (Public switched tekehone network)
			
			Baseband and Broadband
				baseband: support only a single communication channel
						uses a direct current applied to the cable, high level means 1, lower level means 0
						form of digital signal
						ex.: ethernet
				Broadband: support multiple simultaneous signals
						uses frequency modulation to support numerous channel
						suitable for high throughput rates, especially when several channels are multiplexed
						ex.: cable television, cable modems, ISDN, DSL, T1, T3

			Broadcast, Multicast, Unicast:
				Broadcast: supports communications to all possible recipients
				Multicast: supports communications to multiple specific recipients
				Unicast: supports only a single communication to a specific recipient

			LAN Media Access
				at least 5 LAN media acces techno that are used to avoid or prevent transmission collisions

				Carrier-Sense Multiple Acces (CSMA)
					1. host listen to the LAN media to determine whether it is in use
					2. is not used, host transmits communication
					3. host wait for aknowledgement
					4. if no aknowledgement in a time-out period, back to step 1

				Carrier-Sense Multiple Access with Collision Avoidance (CSMA/CA)
					1. host have 2 connection: inbound and outbound. Host listens to inbound
					2. if Lan media is not used, host request permission to transmit
					3. if permission is not granted in a time-out period, host starts over at step 1
					4. if permission granted, host transmits its communication over the outbound connection
					5. host waits for aknowledgment
					6. if no acknowledgement receive in a time-out period, the host starts over at step 1

					requires designation of a master or primary system to responds requests and grants permission
					ex.: appletalk and 802.11 wireless networking

				Carrier-Sense Multiple Access with Collision Detection (CSMA/CD)
					1. host listen to the LAN media to determine whether it is in use
					1. if Lan media is not used, host transmits its communication
					3. while transmitting, hosts listens for collisions
					4. if collision is detected, hosts transmits a jam signal
					5. if a signal jam is received, all hosts stop transmitting, each host waits for a random period and start over at step 1

					allowing collision and responding to them causes delay in transmission as well as a required repetition of transmissions> 40%loss in potential throughput
					ex.: ethernet
		
				Token Passing
					Lan acces media techno that performs communication usin a digital token
				
				Polling
					master-slave configuration
					master polls each secondary system in turn whether they have a need to transmit data
					can be configured to grant one system priority over other systems, ex: 1, 2, 1, 3, 1, 4, 1,...
					ex.: SDLC (Synchronous Data Link Control)
					= opposite to CSMA/CA, where slave ask for permission

============================================================================================================

Chapter 12
Secure Communications and network attacks

============================================================================================================

============================================================================================================

Network and Protocol Security Mechanisms
	TCP/IP = primary protocol suite used on most networks and on the internet
	
	Secure Communications Protocols
		
		SKIP (Simple Key Management for Internet Protocol)
			layer 3
			encryption tool to protect sessionless datagram protocol
			designed for IPsec but can encrypt any subprotocol of TCP/IP, 
			replaced by IKE (Internet Key Exchange) in 1998
		
		swIPe (Software IP encryption)
			layer 3
			encapsulation protocol for CIA

		S-RPC (Secure Remote Procedure Call)
			authentication service
			prevent unauthorized execution of code on remote systems

		SSL (Secure Socket Layer)
			encryption tool developed by Netscape to protect communication between web server and web browser
			session-oriented protocol that provides Integrity and confidentiality
			use 48bit key or 128bit key
			superseded by TLS (Transport Layer Security)

		TLS (Transport Layer Security)
			stronger authentication and encryption protocol than SSL
			support secure client-server communication, preventing spoofing, eavedropping, tampering 
			support one-way authentication and two-way authentication using digital certificates
			often implemented as the initial payload of a TCP package
			can be implemented at lower layer, such layer 3, to operate as a VPN: OpenVPN
			can encrypt UDP and session initiation protocol (SIP, associated to VoIP)
		
		SET (Secure Electronic Transaction)
			security protocol for transactions over internet
			based on RSA and DES
			SSL/TLS encrypted sessions are the preferred mechanism for secure e-commerce

	Authenticaton Protocol
		
		CHAP (Challenge Handshake Authentication Protocol)
			used over PPP (Point to Point Protocol) link
			encrypts usernames and passwords
			use a challenge-response dialogue that cannot be replayed
			periodically reauthenticates the remote system

		PAP (Password Authentication Protocol)
			standardized authentication protocol for PPP
			no encryption of usernames and passwords
			provide a means to transport the logon credentials from the clients to the authentication server

		EAP (Extensible Authentication Protocol)
			more like a framework for authentication than a protocol
			allows customized authentication security solutions (smart cards, tokens,biometrics)

Secure Voice Communications
	Private Branch Exchange (PBX) and POTS/PSTN voice communication are vulnerable
	
	Voice over Iternet Protocol (VoIP)
		VoIP encapsulates audio into IP packets
		potential attacks:
			Caller ID can be falsified > viphing (VoIP fishing) or SPIT (Spamm over Internet Telephony)
			Call manager systems and VoIP phones vulnerable to host OS and DoS attack
			Spoofing call manager or endpoint connection negotiations > man-in-the-middle
			deploying VoIP on the same switch as servers and desktop servers > 802.1X authentication falsification / VLAN and VoIP hopping
			decoding VoIP traffic when it's encrypted

	Social Engineering
		unknown, untrusted, unauthorized person gains the trust of someone inside the organization
		usually used to open a back door
		some guidelines:
			always caution whenever voice communication seen odd, out of place or unexpected
			always request proof of identity
			require callback authorization on all voice-only requests for network alterations
			classify information
			never give-out or exchange password via voice-only communications
			
	Fraud and Abuse
		PBX security solution:
			replace remote access or long-distance calling through PBX with credit card or calling system
			restrict dial-in dial-out to authorized individuals
			for dial-in modem, use unpublished phone numbers
			block or disable any unassigned codes or accounts
			define acceptable use policy
			log and audit all activities in PBX
			disable maintenance modem and accounts
			change all default configuration
			block remote calling
			deploy direct inward system access (DISA)
			keep the system current with vendor/serice provider updates

		DISA = assign access codes to users > full acces to PBX of company once cracked

		Phreaker tools (= colored box)
			Black box = manipulate line voltage to steal long-distance services
			Red box = simulate tons of coins being deposited into a pay phone (small tape recorder)
			Blue Box = simulate 2600Hz tones to directly interact with telephone network trunk system
			White box = dual-tone multifrequency (DTMF) generator (= keypad)

		cell Phone security
			captured Electronic Serial Number (ESN) and Mobile Identification Number (MIN) to create clones

	Multimedia Collaboration
		
		Remote meeting
			used for any product hardware, or software that allows for interaction between remote parties

		Instant Messaging
			allows for real-time text-based chat between two users
			some allow file transfer, voice and videoconferencing
			
Manage Email Security
	
	email infra employed on the internet primarely consists of email servers using Simple Mail Transfer Protocol (SMTP)
	clients retrieve email using POP3 or IMAP
	many internet-compatible email systems rely on X.400 standard
	Sendmail most common SMTP server for UNIX
	Exchange most common SMTP server for Windows

	SMTP = mail relay system
		important to configure inbound and outbound mail
		open relay (open relay agent or relay agent) = does not authenticate senders before accepting and relaying email
		
	Email security goals
		basic email is not secure
		
		adding security for:
			provide nonrepudiation
			restrict access to messages to their intended recipients
			maintain the security of messages
			authenticate and verify source of message
			verify the delivery of message
			classify sensitive content

		within security policy, must address several issues:
			acceptable use policies for email
			access control
			privacy
			email management
			email backup and retention policy
	
	Understand Email Security Issues
		email =common delivery for viruses, worms, trojan horses, documents with descructive macro, malicious code
			hyperlink is a serious damage < scripting languages, autodownload capabilities,  autoexecute features
		email header can be modified at their source or any point during transit
		deliver email directly by connecting to the email server's SMTP port
		DoS attack on specific SMTP server = mail-bombing
		Spamming = little more than a nuisance

	Email Security Solutions
			
		Secure Multipurpose Internet Mail Extensions (S/MIME)
			authentication through X.509 digital certificates
			encryption through PKCS (Public Key Cryptography Standard)	
			provide:
				signed message: integrity, sender authentication and nonrepudiation
				enveloped message: integrity, sender authentication and confidentiality

		MIME Object Security Services (MOSS)
			CIA and nonrepudiation
			MD2 and MD5 algorithms
			RSA public key and DES 

		Privacy Enhanced Mail (PEM)
			CIA and nonrepudiation
			RSA DES and X.509

		Domain Keys Identified Mail (DKIM)
			verification of domain name identity > mail sent by an organization

		Pretty Good Privacy (PGP)
			private key system to encrypt files and messages
			v1: RSA algo
			v2: IDEA algo
			= not standard but independently developed product
			free: GnuPG

	Fax security
		can be eavesdropped
		avoid automatic printing of CONFIDENTIAL or PRIVATE

Remote Access Security Management

	remote access can take the form of:
		using a modem to dial up directly to a remote access server
		connecting to a network over the internet through VPN
		connecting to a terminal server system through a thin-client connection

	
	remote access techniques
		service specific: remote connect and manipulate single service (like email)
		remote control: grants a remote user the ability to fully control another system
		screen scraper/scraping: 
			remote control, remote access or remote desktop services = virtual applications or virtual desktops 
				> screen scraped and shown to a remote operator (important to employ encrypted screen scraper solutions)
			can allow an automated tool to interact with a human interface, ex.: SiteBigger
		remote node operation: = dial-up connectivity

	POTS/PSTN refers to traditional landline telephone connections, in use for home-user internet when broadband and wireless services are not available
	
	security to implement:
		remote access users should be stringently authenticated before being granted access
		only users who specifically need remote acces should be granted permission to do so
		be protected from interception and eavesdropping (usually require encryption solution)

	potential concern:
		benefits of physical security is reduced
		telecommuters might use insecure or less-secure remote systems
		remote systems might be exposed to malicious code
		remote systems might be less physically secure
		remote systems might be more difficult to troubleshoot
		remote systems might not be as easy to upgrade or patch due to their potential infrequent connections

	Plan Remote Access Security
		
		Remote connectivity Technology: 
			each type of connection has its unique security issue
			include DSL, ISDN, wireless networking, satellite, and cable modems
		
		Transmission protection: 
			encrypted protocol, connection system, network services or applications
			include VPNs, SSL, TLS, Secure Shell, IPSec, L2TP				

		Authentication Protection
			Password Authentication Protocol (PAP)
			CHAP, EAP, LEAP, PEAP, RADIUS
			Terminal Access Controller Access Control System Plus (TACACS+)
			
		remote User assistance
			Network Access Control (NAC)
			use of callback and caller ID:
				callback: disconnect a remote user upon initial contact and immediatly attemps to reconnect to them using a predefined phone number (= number defined in the user account's security database)
				Caller ID: potentially verifying the physical location of the authorized user

	Dial-Up Protocol
		secure authentication is needed, adding option for data encryption is preferred
		PPP and SLIP provide link governance, for dial-up and some VPN links

		PPP = full duplex protocol used for transmitting TPC/IP packets over various non-LAN connections (modem, ISDN, VPN, Frame relay...)
			protected by CHAP and PAP
			= replacement for SLIP, can support any LAN protocol, not just TCP/IP

		SLIP = Serial Line Internet Protocol
			older techno to support TCP/IP over asynchronous serial connections (as serial dial-up or modem dial-up)
			support only IP
			require static IP addresses
			no error detection or correction, no compression

		MNP = Microsoft Networking Protocol
			found in Microcom modem in the 1990s
			own form or error control called Echoplex

	Centralized Remote Authentication Services
		add layers of security between remote user and private network
		ex.: TACACS+ and RADIUS
			provides seperation of the authorization and authentication process for remote clients

		RADIUS
			remote access user passes user dial-up logon credential to the RADIUS server for authentication
			similar to domain clients sending logon credential to a domain controller for authentication

		TACACS
			= alternative to RADIUS
			3 versions: TACACS, Extended TACACS (XTACACS) and TACACS+
			XTACACS provide separate process for authentication, authorization and accounting
			TACACS+ improve XTACACS, most current and relevant version

Virtual Private Network
	= communication tunnel that provide point-to-point transmission of both authentication and data traffic over an intermediary untrusted network
	commonly associated with establishing secure communication paths through the internet between two distant network
	can link 2 network or 2 individual systems
	no availability assured
	provides Confidentiality and integrity
	get around location requirements for Netflix and Hulu and provides level of anonymity

	Tunneling
		= network communication process that protects the contents of protocol packets by encapsulating them in packets of another protocol
		virtual path exist between the encapsulation and deencapsulation entities
		can be used if the primary protocol is not routable and to keep the total number of protocol supported on the network to a minimum
		ex.: sending a letter, access a website through SSL or TLS connection, VoIP

		but:
		creates larger packets or more packets, can saturate a network
		point to point communication, don't handle broadcast traffic
		makes difficult to monitor the traffic

	How VPN Works
		can be established over any other network communication connections
		acts like a typical direct LAN scale connection (only difference: speed)
		can connect 2 individual systems or 2 entire networks
		data only protected in the VPN tunnel
		remote access server and firewall act as a endpoint and starting point for VPN
		
	Common VPN protocols
		software or hardware solution
		layer 2: PPTP, L2L, L2TP 
		IPsec
		PPTP and IPsec are limited for use on IP networks
		SSL/TLS can also be used as a VPN protocol
		
		Point-to-Point Tunneling Protocol (PPTP)
			developed from PPP
			operates at layer 2
			used on IP networks
			create a Point-to-Point tunnel and encapsulates PPP packets
			support same authentication protocol than PPP: MS-CHAP, CHAP, PAP, EAP, SPAP
			initial tunnel initiation process is not encrypted > abused by interception
			often replaced by L2TP,which use IPsec which use traffic encryption for VPN

		Layer 2 forwarding Protocol and Layer 2 Tunneling Protocol
			L2F, developed by Cisco
				mutual authentication tunneling mechanism
				does not offer encryption
				not widely deployed and replaced by L2TP

			L2TP derived by combining L2T and PPTP
				creates a point-to-point tunnel
				relies on IPsec for encryption (commonly used)
				support TACACS+ or RADIUS

		IP Security Protocol
			IPsec = most common protocol used
				= stand alone VPN protocol and the security mechanism of L2TP
				used only for IP traffic
				provides encryption and secured authentication
				2 primary components:
					authentication Header (AH): authentication, integrity and nonrepudiation
					Encapsulating Security Payload (ESP): 
						layer 3
						transport mode: only encrypt IP packets data, not the header
						tunnel mode: entire IP packet encrypted + new header added 

		Virtual LAN (VLAN)
			used for hardware-imposed network segmentation
			logically segment a network wihout altering its physical topology
			created by switches
			port by port assignement on switch by administrator
			multiple logical network segments can be created on the same physical network
			routing can be provided by external router or by internal software of the switch

			perform several traffic management functions:
				control and restrict broadcast traffic, block broadcast between subnets and VLAN
				isolates traffic between network segments, possible to allow communications between certain VLAN by deny filter between them
				reducce network's vulnaribility to sniffers
				protect against broadcast storm
		
			port isolation or private port:
				= private VLANs configured to use a dedicated or reserved uplink port
				can only interact with each other or over the predetermined exit port
				common utilization in hotels: each room isolated on unique VLAN, but all can path out to internet

			>> "deny by default/allow by exeption"

Virtualization
	= host one or more OS (guest OS) within the memory of a single host computer (host OS)
	VMWare, Microsoft's Virtual PC, Microsoft Virtual Server, Hyper-V with Windows 2008, Virtualbox, Apple's Parallels
	malicious code compromise or infection rarely affects the host OS 

	Virtual Softwares
		virtual applicaton = software product deployed fooled to be interacting with full host OS
			packaged or encapsulated to make it portable and able to operate without full installation or its original host OS
			encapsulation bubble = VM
			can be used on portable apps, like USB drive

		virtual desktop:
			-remote acces tool that grant the users access to a distant computer
			-extention of the virtual application concept encapsulating multiple applications for portabbility or cross-OS operation
			-extended desktop larger than the display allows the user to employ multiple applications layouts

	Virtual Networking
		combination of several hardware and software networking into a single integrated entity
		a single management console can be used to oversee every aspects of the network
		
		software-defined networking (SDN)
			aims at separing the infra from the control layer
			new network design that is programmable from a central location, vendor neutral and open standards based
			allows data transmission paths, communication decision trees and flow control to be virtualized in the SDN control layer

	Network Adress Translation (NAT)
		= goal of hiding indentity of internet client, masking the design of the private network and keeping public IP address leasing costs to a minimum
		= mechanism for converting the IP address found in packet header into public IP address for transmissions over the internet
		developed to allow private network to use any IP address set  without causing collusion with public internet hosts
		translates IP adresses of internal clients to leased address outside the environment

		Benefits:
			connect an entire network to the internet using a single leased public IP address
			can use private IP address defined in RFC 1918 and still connect to internet
			hide IPaddress scheme and topography from the internet
			restricts connections, only traffic stemming from connections originating from the internal protected network is allowed back to the network
				> intrusion attacks are automatically repelled

		NAT maps one internal IP address to one external IP address: must lease as many public IP adress as simultaneous internal connections
		PAT maps one internal IP address to one external IP address and port number combination: lease fewer IP addresses, with a reasonable 100:1 ratio

	Private IP Adresses
		defined in RFC 1918
		block of address for private, unrestricted use:
			full Class A range: 10.0.0.0 - 10.255.255.255
			16 Class B range: 172.16.0.0-172.31.255.255
			256 Class C range: 192.168.0.0-192.168.255.255

		not possible to re-NAT the same sub-net
			ex.: 192.168.1.x need to be NATed on 192.168.5.x

		private IP addresses are not routed by default
	
	Stateful NAT
		NAT maintain a map between requests made by internal IP address and IP address of the Internet service contracted
		NAT operate on one-to-one basis between internal IP address and external leased IPaddress > bottleneck
			ex.: if a 6th internal client of a 5 external leased IP adress must wait until an external IP adress is released before communicating		
		NAT employ multiplexing on ports > PAT or over loaded NAT

	Static and Dynamic NAT
		static NAT = IP address is assigned to a permanent external IP address
			allows external entities to access system inside your network even if using RFC 1918 IP addresses
		dynamic NAT = grant multiple internal client access to a few leased public IP address
			keeps IP address abuse to a minimum and helps keep Internet access costs to minimum

		often NAT is combined with a proxy server or proxy firewall to provide additional Internet access and content-caching features
		NAT not directly compatible with IPsec < because modify IP packet header
			version of NAT proxies designed to support IPsec over NAT:
				NAT-Traversal (RFC 3947): support IPsec VPNs though the use of UDP encapsulation of IKE

	Automatic Private IP addressing (APIPA)
		= primarily feature of Windows
		= link-local address assignement (RFC 3927)
		assign IP address to a system in case of DHCP failure with an IP address from range 169.254.0.1 to 169.254.255.254 with a Class B subnet mask 255.255.0.0
		allow systems to communicate with other APIPA-configured client within the same broadcast domain but not with any other system across a router or correctly assigned IP address
		indicates a problem: 
			-mundane (FR=banal): bad cable , or power failure on DHCP server
			-malicious attack on DHCP server

		discern whether an address is public, RFC 1918 private address, APIPA address or loopback address			

		Converting IPaddress
			IP adress and subnet masks are binary numbers
			ex.: 172.16.1.1 > 101011000001000000000000100000001
	
		Loopback Address
			= purely software entity
			= an IP address used to connect itself via TCP/IP
			allows for the testing of local network setting
			127.x.x.x networks is reserved for loopback use (127.0.0.1 is widely used)
			Windows XP SP2 restricted to use of 127.0.0.1 as loopback address
				> caused several applications that used other address in 127.x.x.x network service to fail			
		
Switching Technologies
	
	Circuit Switching
		= originally developed to manage the telephone calls over public switched telephone network
		dedicated physical pathway is created between the 2 communicating parties
		once call establish, path remain the same during the communication

		Real-world circuit switching = POTS and PSTN, gone with digital switching and VoIP

	Packet Switching
		communication or message broke into small segment (usually fixed-lenght packets) sent accross intermediary networks to destination
		each segment has a header with source and destination
		
		Cicuit Switching	vs	Packet Switching
		Constant traffic		Bursty Traffic
		Fixed known delay		Variable Delays
		Connection oriented		Connectionless
		Sensitive to connection loss	Sensitive to data loss
		Used primarely for voice	Used for any type of traffic

	Virtual Circuits
		= communication paths
		= logical pathway or circuit created over a packet-switches network
		
		Permanent virtual circuits (PVC)
			= dedicated leased line
			can be closed when not in use, but instantly reopened whenever needed
		Switched Virtual Circuits (SVC)
			= dial-up connection, virtual circuit is created using best paths currently available
			packets may use diffent SVC from source to destination

WAN Technologies

	Fault tolerance < deploy 2 redundant connections, from possibly 2 different telco or service provider	

	dedicated line: (= leased line or point-to-point link)
		link between the customer's LAN and dedicated WAN is always open and established
		connected 2 specific endpoints and only those two endpoints
		cost based on distance

		ex.:
		Techno					Connection Type		Speed
		Digital Signal Level 0 (DS-0)		Partial T1		64Kbps to 1.544 Mbps
		Digital Signal Level 1 (DS-1)		Partial T1		1.544 Mbps
		Digital Signal Level 3 (DS-3)		Partial T3		44.736 Mbps
		European digital transmission format 1	E1			2.108 Mbps
		European digital transmission format 3	E3			34.368 Mbps
		Cable modem or Cable routers					10+ Mbps

	non dedicated line:
 		need connection to be establish before data transmission
		ex.: DSL and ISDN
			maximum distance from DSL line to central office: 1000m

			ISDN (Integrated Service Digital Network)
				= fully telephone network that support voice and high-speed data communication
				
				Basic Rate Interface (BRI)
					2 B channel (64Kbps for data transmission) and 1 D channel (16Kbps for call establishment, management and tear-down)
						> 144Kbps

				Primary Rate Interface (PRI)
					multiple B channel (2 to 23) and 1 D channel (64 Kbps)
					 	> 1.544 Mbps max

			Satellite connections offers high-speed solutions, even for local, inaccessible to cable-based, radio-waved-based
				insecure < large surface footprint, anyone with a receiver can get the signal everywhere: need strong encryption

	WAN Connection Technologie
		border device = channel service unit / data service unit (CSU/DSU)	
			contains data terminal equipment/data circuit-terminating equipment (DTE/DCE) = connection point for the LAN's router  (DTE) and WAN carrier network's switch (DCE)
		CSU/DSU acts like a translator, store and forward device
		carrier networks, or WAN connection technology: X.25, Frame Relay, ATM, SMDS

		X.25 WAN connection
			= older packet-switching technology, widely used in europe
			permanent virtual circuit
			predecessor to Frame Relay
			lower performance and throughput compared to Frame Relay and ATM

		Frame Relay Connections
			packet switching techno, use PVC
			supports multiple PVC over a single WAN carrier service connection
			layer 2 connection mechanism
			requires use of DTE/DCE at each connection point
			customer owns DTE, provider owns DCE
			cost based on the amount of data transfered 
			CIR (Commited Information Rate) = guaranteed minimum bandwidth by provider
				may by overthrow over short intervals: bandwidth on demand
			
		ATM (Asynchronous Transfer Mode)
			= cell-switching WAN communication techno
			connection-oriented packet-switching techno
				fragments communication into fixed-lenght 53-bytes cells > very efficient and high thoughput
			use either PVC or SVC	
			
		SMDS (Switched Multimegabit Data Service)
			= connectionless packet-switching technologie
			connect multiple LAN to form a metropolitan area network (MAN)
			support high speed bursty traffic and bandwidth on demand
			= forerunner to ATM

	Specialized Protocol
			
		SDLC (Synchronous Data Link Control)
			permanent physical connections of dedicated leased lines for mainframes
			use polling
			layer 2
			bit-oriented synchronous protocol
		
		HDLC (High Level Data Link Control)
			refined SDLC for serial synchronous connections
			supports full duplex communications and both point-to-point and multipoint connections
			use polling
			layer 2
			flow control and error detection and correction

		HSSI (High Speed Serial Interface)
			= DTE/DCE interface standard
			defines how routers and multiplexors connect to high-speed network carrier services (as ATM or Frame Relay)
			layer 1

	Dial-Up Encapsulation Protocol
		PPP = encapsulation protocol designed to support transmission of IP traffic over dial-up or point-to-point links
			allow vendor interoperability of WAN devices supporting serial links
			all dial-up and most point-to-point are serial in nature
			initially designed to support CHAP and PAP (for authentication)
				recent version support: MS-CHAP, EAP, SPAP
			support IPX and DECnet protocols
			internet standard defined in RFC 1661
			replaces SLIP
	
Miscellaneous Security Control Characteristics
	
	Transparency
		= ensures to be unseen to users
		lack of direct evidence that a feature, service, or restriction exists
		impact performance is minimal

	Verify Integrity
		use checksum, called hash total
		
	Transmission loggings
		= form of auditing focused on communications
		troubleshooting and  track unauthorized connection

	Transmission error correction
		

Security Boundaries
	= line of intersection between 2 areas, subnets or environnement
	
	between high secure and low secure area
		defines what function can be performed by each area

	between physical environment and logical enrionment
		one security policy for each, must be assessed separatly
	
	when transforming security policies into actual control, must consider each environment separatly

	Prevent or Mitigate Network Attack
		
		DoS and DDoS
			preventing legitimate activity on a victimized system
				attack exploiting a vulnerability in HW or SW
				attack that flood the victim's communication pipeline with garbage network traffic
			
			most DoS employ intermediary system (usually unwilling and unknowing participant) to hide attacker from the victim
			bots, zombies or agents = remote-control tools installed onto secondary victim systems
			attacks involving Zombies = Distributed DoS (DDoS)
			
			countermeasures:
				add firewalls routes and IDS that detects DoD
				maintain contact with provider, to request filtering services when DoS occurs
				disable echo replies on external systems
				disable broadcast features on border systems
				block spoofed packets from entering or leaving the network
				keep systems updated
				consider commercial DoS protection/response
					Cloudflare's DDoS mitigation or Prolexic

		Eavesdropping
			= listen communication traffic to duplicate it
			usually requires a physical acces to implement a physical device or extraction program
			often facilitated by sniffer (traffic capture or monitoring program, or protocol analyzer system)
			difficult to detect < =passive attack
			tools ex.: wireshark, Netwitness, T-Sight, Zed Attack Proxy, Cain and Abel
			
			countermeasures:
				physical access security
				encryption
				one-time authentication methods
				
		Impersonation/Masquerading
			=  act of pretending to be someone or something you are not
			usually implies that authentication credentials have been stolen of falsified
			different from spoofing (false identitty without any proof)

			countermeasure:
				one-time pads
				token authentications, using Kerberos
				using encryption to increase difficulty of extracting authentication

		Replay Attack
			= reestablish a communication session by replaying captured trafic against a system
			
			countermeasures:
				one-time authentication
				sequenced session identification

		Modification Attack
			captured packets are modified and played against a system
			modified packets are designed to bypass restrictions
		
			countermeasures:
				digital signature
				packet checksum

		Address Resolution Protocol Spoofing
			tools: Ettercap, Cain&Abel, arpspoof
			provides false MAC adress for requested IP-addressed systems to redirect address to alternate destinations
			often an element of man-in-the-middle attack

			countermeasures:
				defining static ARP mappings for critical systems
				monitoring ARP caches
				use IDS

		DNS Poisoning, Spoofing and Hijacking
			= resolution attack
			alter domain-name-to-IP-address mappings on DNS server
			2008 Kavinsky discovered hsignificant vulnerability in DNS server
			
			countermeasure: upgrade DNSto DNSSEC (see dnssec.net)

		Hyperlink Spoofing
			= similar to DNS spoofing
			or be an alteration of the hyperlink URLs in the HTML code of the documents sent to clients


======================================================================================================================
Chapter 13
Managing Identity and Authentication

======================================================================================================================
======================================================================================================================

Controlling Access to Assets

	Comparing subjects and objects
		
		subject = active entity that accesses passive object to receive information from, or data about, an object
			can be user, program, processes, computers
			when authorized, subject can modify object

		object = passive entity that provide information to active subject
			can be file, databases, computers, programs, processes, printers and storage media

	Type of access control
		
		access control = any hardware, software or administrative policy or procedure that control access to resources
			the goal is to provide access to authorized subjects and prevent unauthorized access attempts
			includes steps:
				1. identify subject attempting to access ressources
				2. determine whether the access authorized
				3. grant or restrict access based on the subject's identity
				4. monitor and record access attempts

		Types of access control:
			preventive access control = thwart or stop unwanted or unauthorized activity to occur

			detective access control = discover or detect unwanted or unauthorized activity
				operates after the fact and discover the activity after it has occured

			corrective access control = modifies the environment to return systems to normal after an unwanted or unauthoized activity has occured
				ex.: reboot, terminating malicious activity, antivirus solution, backup and restore plans, active intrusion detection systems

			deterrent access control = discourage security policy violations (depends on individual deciding not to take an unwanted action)
				ex.: policies, security awereness training, locks, fence, security badges, mantraps, security cameras

			directive access control = direct, confine or control the action to force or encourage compliance with security policies
				ex.: security policies requirement or criterias, posted notifications, escape route exit signs, monitoring, supervision, and procedures

			compensation access control = alternative when its not possible to use a primary control; or increase the effectiveness of a primary access control
				ex.: hardware tokens to compensate use of smartcard (that is long to get for new employees)

			
		How they are implemented:
			
			administrative access control = policies and procedures defined by organization's security policy and other regulations or requirements
				= management control
				focus on personel and business practices
				ex.: policies, procedures, hiring practices, background checks, classifying and labeling data, security awareness and training efforts

			Logical/technical controls = hardware or software mechanisms used to manage access and to provide protection for resources and systems
				ex.: authentication methods, encryption, constrained interfaces, access control lists, protocols, firewall, routers, IDS, clipping levels

			Physical control = items that can be physically touch
				ex.: guards, fences, motion detectors, locked doors, sealed windows, lights, cable protection, laptop locks, badges,swipe cards, video cameras, mantraps, alarms

			
Comparing Identification and authentication

	identification = process of a subject claiming, or professing, an identity
		ex.: typing a username, swiping a swipe card, wving a token device, speaking a phrase, positioning your face, hand or finger
		core principle: each subject must have unique identities

	authentication = verifies the identity of the subject by comparing one or more factos against a database of valid identities
		authentication information used to verify identity is private and need to be protected (hashes of passwords within the authentication database)
	
	identification and authentication always occur together has a 2 step process
		ex.: identitification with username, authentication with inserting password
	
	Registration and proofing of Identity
		user first given identity: HR departments begin the process of creating a User ID
		
	Authorization and Accoyntability
		
		Authorization = subjects are granted access to objects based on proven identities and based on the privileges assigned to the subjects
		Accountablity = subjects can be held accountable for their actions when autiding is impleted
			auditing = process of tracking and recording subject activities within logs
				one or more logs create an audit trail
			relies on effective identification and authorization, but does not require effective authorization

	Authorization factors
		
		type 1: something you know
			ex.: password, PIN, passphrase

		type 2: something you have
			ex.: smart card, hardware token, memory card, USB drive
			smart card process information =/= memory card only stores data

		type 3: something you are or something you do
			ex.: 	something you are: fingerprints, voice prints, retina patterns, iris patterns, face shapes, parm topology, hand geometry
				something you do: signature and keystrokes dynamics = behoavioral biometrics

		= progressively stronger when implemented correctly

		"somewhere you are": location based on a specific computer,  phone number identified by call ID, geographyc location based on IP address
			not reliable by itself but effective when used in combination with other factors

	Passwords
		type 1
		typically static = stays the same for a lenght of time
		static password = weakest form of authentication:
			users often choose easy passwords that are easy to remember or crack
			randomly generated passwords are hard to remember, thus many users write them down
			users often share their password, or forget them
			attackers detect passwords through many means: observation, sniffing, stealing security database
			password are something transmited in clear text
			password database are sometimes stored in public location
			brute-force attacks can quickly discover weak passwords

		password encryption: 
			use a hash algorithm, such as PBKDF2 (Password-Based Key derivation Function 2) 	
			users enter password, the system hash the passord and compare to hashed password database

		Creating strong password
			organization often include a written password policy
			technical password policy is enforced by the password restriction requirements:
				maximum age = require to change password periodically
				password complexity = how many characters, and how many type of characters
				password lenght = number of characters in the password
				password history = remember a certain number of previous passwords
	
			basics:
				dont use any part of name, logon name, email address, employee number, national identity number or social security number, phone number, extension...
				dont use information available from social network profiles: pet's name, family member's name, birth date
				dont use dictionnary words
				do use nonstandard capitalization and spelling
				do replace letters with special characters and numbers

		Password Phrases
			= often similar to password but has a unique meaning to the user

		Cognitive password
			= series of questions about facts or predefined responses that only the subject should know
			
	Smart Cards and Tokens
		type 2
		commonly combined with another factor of authentication, providing multifactor authentication
		
		Smartcard 
			= credit-card size ID or badge that has an integrated circuit chip embedded
			contains microprocessor and one or more certificates, used for asymetric cryptography
			tamper resistant and provide easy way to carry and use complex encryption keys
			provide both identification and authentication, but not identification

			CAC = Common Access Card
			PIV = Personal Identity Verification

		Tokens
			= password generating device that users can carry with them
			use dynamic one-time passwords, more secure than static passwords

			synchronous dynamic password tokkens: time-based and synchronized with an authentication server
			asynchronous dynamic pasword tokens: doesnt use clock, based on algorithm and incrementing counter

	Biometrics
		type 3
		one-to-many: multiple identity match with biometric factor, user for identification
		ono-to-one

		fingerprints = visible patterns on the fingers and thumbs ofpeople
		face scans = geometric patterns of faces for detection and recognition
		retina scans able to differentiate identical twins (forbidden as they can detect medical conditions)
		iris scan = focus on the colored area around the pupil
		
	Biometric Factor Error Ratings
		type 1 error = valid subject is not authenticated > False Rejection Rate (FRR)
		type 2 error = invalid subect is authenticated > False Acceptance Rate (FAR)
		
		compare the overall quality of biometric device with Cross Error Rate (CER)
		
	Biometric registration
		enrollment = subject biometric factors are stored and sampled in the device's database = reference profile (or reference template)
		throughput rate = amount of time the system requires to scan a subject and approve or deny access

	Multifactor
		= any authentication requiring 2 or more factors
		
	Device authentication
		SecureAuth Identity Provider (IdP)
			

Implementing Identity Management

	centralized access control: all authorization verification is performed by a single systems in the network
		administrative overhead is lower: all changes are made in a single location, single change effects the entire system

	decentralized/distributed access control: implies that various entitoes located throughout a system authorization verification
		administrative overhead is higher: changes must be implemented across numerous locations

	Single Sign-on
		= centralized access control technique that allow a subject to be authenticated once on a system and access multiple resources without authenticating again
		very convenient to user, increase security
		but: once an account is compromised, attacker gains unrestricted access to all the authorized resources

	LDAP and Centralized Access Control
		
		directory service = centralized database that includes information about subjects and objects
		LDAP = Lightweight Directory Access Protocol		
			Microsoft Active Directory Domain Services are based on LDAP
			= telephone directory for network services and assets
			subjects must authenticate to the directory service before performing queries and look up activities

		security domain = collection of subjects and objects that share a common security policy
		trusts = established beteen the domains to create a security bridge and allow users from one domain to access resources in another domain
			can be one way only or two ways
		
	LDAP and PKIs
		PKI uses LDAP when integrating certificates into transmissions
		LDAP is one of the protocol used to query a certificate authority (CA) for information on a certificate

	Kerberos
		= tickets authentication system that employs a third-party entity to prove identification and provide authentication
		(from greek anthology: Kerberos is a 3 headed dog that guards the gate to the underworld, preventing escape rather than denying entrance)
		offers single sign-on solution for users and provides protection for loggon credentials
		current version = v5
		relies on symetric-key cryptography using AES protocol
		
		Key distributor center = trusted third-party that provides authentication services
			uses symmetric cryptography to authenticate clients to server
			all clients and servers are registered to KDC
			maintains secret key for all network members

		Kerberos Authentication Server = hosts the functions of the KDC: TGS and AS
			ticket-granting services (TGS): possibly being installed on an another server
			authentication services (AS):  verifies or rejects the authenticity and timeliness of tickets
			server often called as the KDC

		Ticket-Granting Ticket (TGT) = provides proof a subject has authenticated to the KDC and is authorized to request tickets to access other objects
			encrypted and includes a symmetric key, expiration time, and user's IP address
			subjects present the TGT when requesting tickets to access objects

		Ticket = encrypted message that provides proof that a subject is authorized to access an object
			sometimes called a service ticket (ST)
			subjects requests tickets to access objects, if they are authenticated and are authorized to access objects, Kerberos Issues them a ticket
			have specific lifetimes and usage parameter

		process work of Kerberos:
			1. user types username and password into the client
			2. client encrypts the username with AES for transmissions to the KDC
			3. KDC verifies the username against a database of known credentials
			4. KDC generates a symmetric key that will be used by the client and the kerberos server. Encrypts with a hash of the user password
				KDC also generate a time-stampeded TGT
			5. KDC transmits the encrypted symmetric key and the time-stamped TGT to the client
			6. the client installs the TGT for use until it expires, client also decrypts the symmetric key using a hash of the user's password
			
		Note: the client's password is never transmitted over the netork, but it is verified

		when client wants to access the subject:
			1. client send its TGT back to the KDC with a request to access to the resource
			2. KDC verify the TGT is valid and check its access control matrix for client's privilege to the resource
			3. KDC generate a service ticket and sends it to the client
			4. client sends the ticket to the server or service hosting the resource
			5. server or service hosting the resource verifies the validity of the ticket with the KDC
			6. once identity and authorization is verified, the server or service opens a session with the client and begins communications or data transmission

		Kerberos = versatil authentication mechanism that works over local LANs, remote access, and client-server resource request
		SPOF = KDC, if KDC is offline, no one can access resources
		all systems must be time-synchronized over 5 min of each other

	Federated Identity Management and SSO
		
		Federated Identity management = SSO for internet
		multiple organization can join a federation, or group
		often use the Security Assertion Make Up Language (SAML) or Service Provisioning MArkup Language

		Hypertext Markup Language (HTML)
			commonly used to display static web pages
			derived from the  Standard Generalized Markup Language (SGML) and Generalized Markup Language (GML)
			describes how data is displayed using tags to manipulate size and color of the text: ex.: <H1>I passed the CISSP exam</H1>
					
		Extensible Markup Language (XML)
			display the data by describing the data
			include tags to describe data as anything desired ex.: <ExamResults>Passed</ExamResults>
			databases from multiple vendor can import and export data to and from an XML format
			many specific schemas have been created so that companies know exactly what tags are being used for specific purposes

		Security Assertion Make Up Language (SAML)
			XML-based language that is commonly used to exchange Authentication and Authorization (AA) information between federated organizations
			often used to provide SSO capabilities to browser access

		Service Provisioning Markup Language (SPML)
			newer framework based on XML, specifically designed for exchanging user information for federated identity single sign-on purposes
			based on Directory Service Markup Language (DSML), which display LDAP-based directory service information in an XML format

		Extensible Access Control Markup Language (XACML)
			used to define an Access Control policies within an XML format
			commonly implements role-based access controls

	Other example of SSO
		
		scripted access
			can simulate process to transmit logon credentials at the start of a logon session
			script and batch files should be stored in a protected area because they contain access credentials in clear text

		Secure European System for Applications in a Multivendor Environment (SESAME)
			ticket-based authentication system developed to address weaknesses of Kerberos
			no longer considered a viable product

		KryptoKnight
			ticket-based authentication system developed by IBM
			similar to Kerberos but uses peer-to-peer authentication instead of a third party
			incorporated in NetSP product
			never took off

		OAuth
			= open standard design to work with HTTP
			Google support OAuth 2.0 (which is not backward compatible with OAuth 1.0)
			documented by RFC 6749

		OpenID
			= open standard
			maintained by the OpenID Foundation rather than an IETF RFC Standard
			can be used with OAuth or on its own

	Credential Management System
		provides a storage space for users to keep their credentials when SSO isn't available
		secures the credentials with encryption
		ex.: KeePass

	Integrating Identity Services
		provides additional tools for identification and authentication
		
		IDaaS (Identity as a Service or Identity and Access as a Service) is a third-party service that provides identity and access management
			provides SSO for the cloud
			usefull for SaaS applications
			implemented by Google, Office 365, Microsoft with Onedrive

	Managing Sessions
		automatic log off after time of inactivity: screensaver, bank internet site,...

	
	AAA Protocols
		Authentication, Authorization and Accountability service = AAA services
		used in VPN, local networks or Mobil IP

		RADIUS (Remote Authentication Dial-In User Service)
			centralizes authentication for remote connections
			used by many internet service providers (ISP)
			users call in, and after authentication, RADIUS server terminates the connection and initiates a call back to the user's predefined phone number
			use the UDP and encrypt only the exchange of the password
			defined in RFC 2865

		TACACS+
			alternative to RADIUS
			separate Authentication, Authorization and Accountability, that can be hosted on different servers
			encrypts all of the authentication information
			TACACS and XTACACS use UDP port 49
			TACACS+ uses TCP port 49

		Diameter
			= new version of RADIUS
			built on RADIUS and TACACS
			suppports wide range of protocols, like IP, VoIP and Mobile IP
			not backward compatible to RADIUS
			uses TCP port 3868 or Stream Control Transmission Protocol (SCTP) port 3868			
			support IPsec and TLS encryption

Managing the identity and Access Provisioning Life Cycle
	= creation, management and deletion of password
		
	Provisioning
		called an enrollment or registration
		creates a new identity and establish the factors the system needs  toperform authentication
		many organization have automated to process
		
	Account Review
		should be periodically to ensure security policies are being enforced
		many administrators use scripts to check for inactive accounts periodically
		
	Excessive privilege and creeping privileges
		creeping privilege = accumulated privilege overtime as job roles and additional privilege are added
		violate principle of least privilege

	Account revocation
		important for terminated employee: other employee could use the account to sabotage
		possible that the account will be needed, for accessing encrypted data, it should not be deleted right away...

	
======================================================================================================================
Chapter 14
Controlling and Monitoring Acccess

======================================================================================================================
======================================================================================================================
	
Comparing Access Control Models
	DAC, MAC, role-BAC, rule-BAC

	Comparing Permisions, Rights , and privileges
		
		permissions
			= access granted for an object and determine what you can do with it
			permisions to create, read, edit or delete (CRED)
			= rights in this context

		rights
			= the ability to take an action on an object
			ex.: user might have rights to change system time

		privilege
			= combination of rights and privileges
			ex.: an admin for a computer will have full privilege: granting the admin full rights and permissions on the computer

	Understanding Authorization Mechanisms

		implicit deny
			= ensures that access to an objects is denied unless access has been explicitly granted to a subject

		Access Control Matrix
			= tables that includes subject, objects and assigned privileges
			objects focused
			when a subject attempt an action , the system checks the access control matrix  to determine if the subject has the appropriate privileges to perform the action

		Capability Tables
			= different from ACL because they focus on subjects
			subject focused
			identify for each subject, the objects that it can accesses

		Constrained Interface
			or restricted interface
			= applications use constrained interface to restrict what users can do or se based on their privileges
			users wih full privileges have access to all the capabilities of the application
			common method = hide the capabilities to user that doesnt have permissions to use it

		Content-dependant control
			= restricts access to data based on the content whitin an object
			ex.: database view, a customer based view will show only the names and email address of the all customer table

		Context-dependant control
			= requires specific activity before granting user access
			ex.: data flow for a transaction selling digital products online
			  	system denies access to the download page if the user don't go through the purchase process
		
		Need to know
			= subjects are granted access only to what they need to know for their work tasks and job functions

		Least Privileges
			= subjects are granted only the privileges they need to perform their work tasks and job functions

		Separation of Duties and Responsabilities
			= sensitive functions are split into tasks performed by 2 or more employees

	Defining requirements with a Security Policy
		
		security policy = document that defines the security requirements for an organization
			identifies assets and security solutions to protect them
			help personnel understand what security requirements are important

	Implementing defense in depth
		= uses multiple layers or levels of access controls to provide layered security
			ex.: physical access control > Logical/Technicl Control > Administrative Access Control > assets

		> an organisation policy provides a layer of defense for assets by defining security requirements
		> personel are key components of defense
		> combination of administrative, technical, and physical access control provides a much stronger defense

	Discretionary Access control (DAC)
		allows owner, creator, or data custodian of an object to control and define access to that object
		Ex.: user create a new spreadsheet, that user is owner of the file. this user can modify permissions of the file to grant or deny access to other users

		DAC is implemented using ACLs on objects
		doesnt offer centrally controlled management system
		admin can suspend user privileges while they are away, or disable accounts when they leave the organization
		= very flexible

	Nondiscretionary Access Control
		administred by administrators, that change access controls that affect the entire environment
		acces doest not focus on user identity, but a static set of rules governing the whole environment manages access

	role-based access control
		or task-based access control
		define a subject's ability to access an object based on the subject's role or assigned tasks
		often implemented using groups
		helps enforce the principle of least privilege by preventing privilege creep 
		
		privilege creep = tendency for privilege to accrue to users over time aas their roles and access needs change

		usefull in dynamic environment with frequent personnel changes 

		Task Based Access Control (TBAC)
			similar to role-BAC
			= each user is assigned an array of tasks
			
	rule-based access control
		uses a set of rules, restrictions, or filters to determine what can and cannot occur on a system
			includes granting a subject access to an object, or granting the subject ability to perform an action
			have global rules that apply to all subjects
		ex.: Firewall: include a set of rule + a final rule (= implicit deny rule)

	attribute based access control  (ABAC)
		= advanced implementation of rule-BAC
		use policies that include multiple attributes for rules
		ex.: CloudGenix defines a software-defined wide area network (SD-WAN) solution that implements policies to allow or block traffic

	Mandatory Access Control (MAC)
		= relies on the use of classification labels
		each classification label represents a security domain, or realm of security
		
		security domain = collection of subjects and objects that share a common security policy
		subjects are only able to access objects with the secret label, when they have a matching secret label
		subjects have labels assigned to them based on their clearance level, which is a form of privilege
		the requirement for subjects to gain the secret label is the same for all subjects
		
		often referenced as a lattice-based MAC model (= reminiscent of a lattice in a garden (such as a rose lattice used to train climbing roses)
		
		allows labels to identify more defined security domains:
			within confidential section, they are 4 separate security domains labels Lentil, Foil, Crimson, and Matterhorn
			users with confidential label also require te additional label to access data within these compartments

		assures "need to know" principles
		prohibitive rather than permissive, uses an implicit deny philosophy
		MAC model more secure than the DAC model but not as flexible and scalable

		Classifications:
		
			Hierarchical Environment: 
				relates various classification labels in ordered structure from low security to high security
				clearance in one level grants the subject access to objects in that level and below, but prohibits access to object above

			Compartmentalized environment
				no relationship between one security domain and another
				subject need specific clearance for the security domain of the object
	
			Hybrid Environment
				combines both hierarchical and compartmentalized


Understanding Access Control Attacks

	Risk elements
		risk = possibility that a threat will exploit a vulnerability resulting in a loss such as harm of an asset
		threat = potential occurence that can result in an undesirable outcome
		vulnerability = type of weakness, due to a flow or limitation in HW or SW, or abscence of security control
		
	Identify Assets
		asset valuation 

	Identify Threats
		threat modeling = process of identifying, understanding, and categorizing potential threats

		Threat modeling Approaches
		
			focused on assets: uses asset valuation results and attempts to identify threats to the valuable assets
			focused on attackers: identify potential attacker and identify the threats they represent based on the attacker's goals
			focused on software: 

		Advanced persistent threat (APT)
			= group of attackers who are working together and are highly motivated, skilled and patient

	Identify Vulnerabilities
		vulnerability analysis = attempts to identify the strenghs and weaknesses of the different access control mechanisms
			ongoing process and can include both technical and administrative steps

	Common access control attacks
		= attempts to bypass or circumvent access control methods
		often try to steal user credentials
		impersonation attack = logging in as the user and accessing the user's resources

		Access aggregation attacks
			= collecting multiple insensitive information and aggregate them to learn sensitive information

			= reconnaissance attacks: combine multiple tools to identify multiple elements of a system

		Password attacks
			strong passwords helps prevent password attacks
			more common for an attacker to steal the account database and then crack the passwoords offline

		Dictionnary attacks	
			= attempts to discover passwords by using every possible password in a predefined database or list of common or expected passwords
			one-upped-constructed password = previously used password, but with one character different
					= often used approach to build rainbow tables

		Brute-Force Attacks
			= systematically attempting all possible combinations of letters, numbers, and symbols
			usually programs that can automatically try all the combinations
			
			passwords and username are commonly stored in an account database file on secured systems
				systems and applications commonly hash passwords and store the hash values
				users authenticate by hashing the password prior to send it the system, sytem compares the hash values		
					> password dont cross the network in clear form
					> password databases do not store passwords in clear text

			many attackers are using GPU (Graphic Processor Unit in brute-force attacks
			12-character password using 4 character types can take thousands of years to crack

		Birthday Attacks
			= focuses on finding collisions
			names comes from the statistical phenomena called 'the birthday paradox' 
			Birthday paradox = if there is 23 person in a room, 50% chance that 2 of them are born the same day of the year
			reduce the success of birthday attacks by using hashing algorithms and salts (rainbow tables)

			MD5 is no more collision free
			SHA-3 use 512bits and is considered collision free, for now

		Rainbow Table Attacks
			= uses of large database of pre-computed hashes to reduce time of guessing a password and its hash
			the password cracker simply compares hashes until it find a match
			14 character with 4 types of characters > 7.5GB rainbow table
			15 character with 4 types of characters > beat most rainbow tables
 
 			many systems salt passwords to reduce effectiveness of rainbow tables
				salt = group of random bits , addded to a password before hashing it		
			
		Sniffer Attacks
			or snopping attack, or eavesdropping attacks
			sniffing captures a packets sent over a network with the intent of analyzing the packets
			
			Countermeasures:
				encrypt all sensitive data
				use one-time password when encryption is not possible
				protect network device with physical security
				monitor the network for signatures from sniffers

		Spoofing Attacks
			or masquerading
			= pretending to be someone, or somthing, else
			
			email spoofing = spammers commonly spoof the email address in the From field to make an email appearto come from another source		
					reply to field can be a different email address...

			phone nmber spoofing = allows a caller to replace the number with another one
					spoof the actual calling number with aphone number that includes the same area code as the called number, making it look local call

		Social engineering attack
			= gain the trust of someone by using deceit, such as false flattery or impersonation
			shoulder surfing: placed filters over a monitor, password masking

		Phishing
			= giving up sensitive information by opening an attachment or clicking a link

		Spear phishing
			= form of phishing targeted to a specific group of users, such as employees within a specific organization

		Whaling
			= variant of phishing that taget senior or high-level executives such as CEOs and presidents withi a company

		Vishing
			= phishing via Instant Mesaggers and VoIP

		Smartward Attacks
			side-channel attack is a passive, non invasive attack intended to observe the operation of a device

		Denial-of-Service Attacks
			= prevents the system from processing or responding to legitimate traffic or requests for resources
			often occurs on a network, as internet

	Summary of protection methods
		
		Control physical access to systems
		Control electronic access to files
		Encrypt password files
		Create a strong password policy
		Use Password masking
		Deploy Multifactor authentication
		Use account lockout controls: lock an account aftr incorrect password is entered a predefined number off times
			typically use clipping levelsthat ignore some user errors but take action after reaching a threshold
		Use last logon notification
		educate users about security

======================================================================================================================
Chapter 15
Security Assessment and testing

======================================================================================================================
======================================================================================================================
		
Building a Security Assessment and Testing Program

	Security Testing
		= verifies that a security control is functionning properly
		includes automated scan, tool-assisted penetration testing and manual attempts to undermine security
		should take place on a regular schedule, with attention paid to each of the key security controls
		should consider the following factors:
			availability of security testing resources
			criticality of the systems and applications protected by the tested controls
			sensivity of information contained on tested systems and applications
			likelihood of technical failure of the mechanisme implementing the control
			likelihood of a misconfiguration of the control that would jeopardize security
			risk that the system will come under attack
			rate of change of the control configuration
			other changes in the technical environment that may affect the control performance
			difficulty and time required to perform a control test
			impact of the test on normal business operations

		strategy may include frequent automated tests supplemented by infrequent manual tests
		security professionals must also review the results of those tests to ensure they was successfull
			some tests require human interpretation and must be performed by trained analysts

	Security Assessment
		= comprehensive review of the security of a system, application, or other tested environment
		perform a risk assessment that identifies vulnerabilities in the tested environment 
		work product = assessment report addressed to management that contain the results of the assessment in nontechnical language and concludes with specific recommandations

	Security Audit
		= same techniques followed during security assessment, but performed by independant auditors
		demonstrating the effectiveness of controls to a third party
		auditor provide impartial, unbiased view of the tests of security controls

		internat audit = performed by internal audit staff and are typically intended for internal audiences
		external audit = performed by outside auditing firm

		auditors have generally carte blanche access to all information within an organisation and security staff should comply with those requests

Performing Vulnerability Assessment

	Vulnerability Scans
		automatically probe systems, application and networks, looking for weaknesses that may be exploited by an attacker
		scanning tools provide quick, point-and-click tests or scheduled scanning without requiring manual intervention
				
	Network discovery Scan
		uses a variety of techniques to scan a range of IP addresses, searching for systems with open network ports
		
		TCP SYN Scanning: 
			or "half-open" scanning
			sends a single packet to each scanned port with SYN flag set, this indicate a request to open a new connection
			if the scanner receive the SYN and ACK flag set, system is moving to the second phase in the three-way TCP handshake and that the port is open. 
			
		TCP Connect Scanning
			opens a full connection to the remote system on the specified port
			used when the user running the scan doesnt have the necessary permissions to run a half-open scan

		TCP ACK scanning
			sends a packet with the ACK flag set, indicating that it is part of an open connection

		Xmas scanning
			sends a packet with the FIN, PSH, and URG flags set

		nmap is the most common tool
			released in 1997
			identifies the current state of each network port on the system, providing a status:
				open: port open and there is an application actively accepting connections on that port
				closed: port accessible on the remote system, meaning the firewall is allowing access, but no application accepting connections on that port
				filtered: nmap unable to determine if the port is open or closed because firewall is interfering with the connection attempts

	Network vulnerability scanning
		dont stop on detecting open ports but continue on to probe a targeted system or network for the presence of known vulnerabilities
		contains databases of thousands of known vulnerabilities
	
		false positive report = vulnerability shown on nmap but there is no problem
		false negative report = misses a vulnerability and fail alert the administrator

		authenticated scans of systems = scanner has read-only access to the server, can use it to access read configuration information from the target system and use that information when analyzing vulnerability  testing results
			reduce false positive and false negative reports

		TCP 		Ports
		FTP		21
		SSH		22
		Telnet		23
		SMTP		25
		DNS		53
		HTTP		80
		POP3		110
		NTP		123
		HTTPS 		443
		SQL Server	1433
		Oracle 		1521
		H.323		1720
		PPTP		1723
		RDP		3389

	Web Vulnerability Scanning
		servers running many web applications must expose services to internet users
		= special-purpose tools that scour web applications for konwn vulnerabilities

		Nessus vulnerability scanning tool

		Good practice to run scans in the following circumstances:
			scan all appplications when begin performing web vulnerability scanning for the first time: detect issues with legacy applications
			scan any new applications before moving it into a production environment for the first time
			scan any modified application before code changes move into production
			scan all applications on a recurring basis
			scan web application to meet compliance requirements

		Penetrating testing
			= goes beyond vulnerabilities testing techniques, attempts to exploit system
			some vulnerability scanning techniques may disrupt a system
			includes following steps:
				performing basic reconnaissance to determine system function
				network discovery scans to identify open ports
				network vulnerability scans to identify unpatched vulnerabilities
				web application vulnerability scans to identify web application flaws
				use of exploit tools to automatically attempt to defeat the system security
				manual probing and attack attempts

			use a tool called metasploit: use scripting language to allow the autmatic execution of common attacks

			White box penetration testing
				provides the attackers with detailed information about the system they attack

			Gray Box penetrating test
				or partial knowledge test
				balance the advantages and disavantages  of white and black box penetration tests

			Black Box Penetation tests
				does not provide information to attackers prior to the attack: simulates an external attacker trying to gain access to information
	
Testing your Software

	think about following characteristics:
		software application often have privileged access to the operating system hardware and other resources
		software applications routinely handle sensitive information, including credit card numbers, social security numbers, and proprietary business information
		many software applications rely on databases that also contain sensitive information
		software is the heart of the modern enterprise and performs business-critical functions

	Code review and testing
		provide third-party reviews of the work performed by developers before moving code into a production environment
		may discover security, performance, or reliability flaws in applications before they go live and negatively impact business operations

		Code review
			or peer review
			= foundation of software assessment programs
			performed by developers others than the one who wrote the code review
			may result in approval of an application's move into a production environment

			Fagan inspections, most formal review process:
				1. Planning
				2. Overview
				3. Preparation
				4. Inspection
				5. Rework
				6. Follow-up

			each steps has well-defined entry and exit criteria

			found only in high restrictive environments where code flaws may have catastrophic impact
			most companies follows the following:
				dev walking through their code in meeting with other team members
				senior developer performing manual code review and signinf off
				use automated review tools

	Static testing
		= evaluates the security of software without running it by analyzing either the source code or the compiled application
		usually involves the use of automated tools designed to detect common software flaws, such as buffer overflows
		could be use throughout the dein, build and test process

	Dynamic testing
		= evaluates the security of software in runtime environment
		often the only option for organizations deploying applications written by someone else
			< testers often dont have access to source code
		ex.: web application scanning tools to detect the presence of cross-site scripting, SQL injection or other flows
		should be carefully coordinated to avoid an interruption of service
		include use of "synthetic transactions" to verify system performance

		synthetic transactions = scripted transactions with known expected results

	Fuzz testing
		= specialized dynamic testing that provides many different types of input to software to stress its limits and find previously undetected flaws
		suppplies invalid input , randomly generated or specially crafted, to trigger known software vulnerabilities
		fuzz tester monitors the performance , software crashes, buffer overflows...

		Mutation (Dumb) Fuzzing
			take previous input values  and manipulates it to create fuzzed input
			ex.: alters the characters of the content, appends string to the end of the content

			zzuf automate the process of mutation fuzz
				> bit flipping


		Generational (Intelligent) Fuzzing
			develops data models and created fuzzed input based on understanding of the types of data used by the program

	Interface Testing
		asses the performances of modules against the interface specifications to ensure that they will work together properly

		Application Programming Interfaces (APIs)	
		User Interface (UI): include Graphcial UI and command-line
		Physical interfaces

	Misuse Case testing
		or abuse case testing
		software users might attempt to misuse the application
		testers first enumerate the known misuse cases

	Test Coverage Analysis
		estimate the degree of testing conducted against the new software:
			test coverage = number of use cases tested / total number of use cases

Implementing Security Management Processes
	critical feedback loop in  the security assessment process
	provide management oversight
	have a deterrent effect against the threat of insider attacks

	Log Reviews
		Security Incident and Event Management (SIEM)
			automates much of the routine work of log review
		Information security managers should also periodically conduct log reviews, to ensure privilege users dont abuse their privileges
		
	Account Management
		ensure that users only retain authorized permissions and that authorized modifications do not occur
		conduct full review of all accounts
		typically done only for higly privilege accounts because of the amount of time consumed
		
		1. manager ask system admin to provide a list of users with privileged access and rights
		2. manager ask the privilege approval authority to provide a list of authorized users and the privileges they should be assigned
		3. managers then compare the two lists

		could include more checks:
			verify terminated users
			checking paper trail

	Backup Verification
		reviewing logs, inspecting hash values, requesting an actual restore of a system file

	Key Performance and Risk Indicators
		may include:
			number of open vulnerabilities
			time to resolve vulnerabilities
			number of compromised accounts
			number of software flaws detected in preproduction scanning
			repeat audit findings
			user attempts to visit known malicious sites


======================================================================================================================
Chapter 16
Managing Security Operations

======================================================================================================================
======================================================================================================================
		
Applying Security Operations Concepts

	primary purpose = safeguard information assets
	due care and due diligence= taking reasonable care to protect the assets

	Need to know and least privilege
		
		need a well-defined job description that personel understand		

		Need to know: focus on permissions = allow access to objects
			need to know principle = grants users access only to data or resources they need to perform assigned work task
			associated with security clearance

		Least privileges: focus on privileges = ability to take actions and allow access
			states that subjects are granted only the privileges necessary to perform assigned work tasks or more
			for data: write, create, alter or delete data
			protects confidentiality and data integrity
			
			entitlement = amount of privileges granted to users
				typically when first provisioning an account
				should follow the principle of least privilege

			transitive trust = allows subject of a domain to access objects of the subdomain
				nontransitive trust exists between 2 domains, enforces principle of least privilege

	Separation of Duty and Responsabilities
		= ensure that no single person has total control over a critical function or system
		but: two or more people can conspire or collude against the organization
		separation of duty can create a "checks-and-balances" system: verify each other's actions
		ex.: movie theatre: one person sells tickets, another collects tickets

	Separation of privileges
		= similar to separation of duty
		built on principle of least privilege, and applies it to applications and processes
		requires use of granular rights and permissions
		administrator grant each service account only the privileges needed to perform its function within the application

	Segregation of Duties
		ensure that individuals do not have excessive system acces that may result in a conflict of interest
		highly relevant in case of Sarbanes-Oxley Act of 2002 (SOX): it requires it !
			SOX applies to all public company that have registered equity of debt securities with the Security and Exchange Commission (SEC)
		ensure that security duty is separate from other duty in the company

	Two-person control
		or two-man rules
		requires the approval of 2 individuals for critical tasks
		ex.: safety deposit in bank: customer has one key, bank employee has the other key
		ensure peer review and reduce collusion and fraud
		
	split knowlege combine two-person control and segregation of duties

	Job rotation
		or rotation of duties
		= employees are rotated through jobs, or some job responsabilities are rotated to different employees
		provides peer review, reduces fraud, enable cross-training
		act as deterrent and detection mechanisms

	Mandatory Vacations
		provides a form of peer review, helps detects fraud and collusion
		similar to benefit of job rotation
		act as deterrent and detection mechanism
	
	Monitor Special Privileges
		special privilege operations = activities that require special access or elevated right and permissions to perform many administrative and sensitive job tasks
		ex.: creating new user accounts, adding new routes to a table, altering firewall configuration, accessing system log and audit files
		principle of least privileges ensures only a limited number of people have these privileges
		monitoring that users granted dont abuse them
		accounts granted = privileged entities
			usually trusted employees
		privileged operation to monitor:
			accessing audit log
			changing system time
			configuring interfaces
			managing user accounts
			controlling system reboot
			controlling communication paths
			backing up and restoring systems
			running script/task automation tools
			configuring security mechanism controls
			using operating system control commands
			using database recovery tools and log files
	
	Managing the information cycle of life
		
		marking data
			or labeling
			ensure that personal easily recognize the data's value
			personel should mark data as soon as possible after creating it
			same for systems processing or backing up sensitive data
			configure screen saver and wallpaper to clearly indicate the system's value

		Handling data
			provide the same level of protection for the data during transport as it has when stored
			
		storing data
			require protection against losses
			physical security methds against theft
			environmental controls against loss du to corruption
		
		Destroying data
			data should be destroyed when no longer needed
			destroyed such a way it is not readable
	
	Service Level Agreements
		= agreement between an organization and an outside entity
		Memorandum of understanding (MOU)
		Interconnection Security Agreement (ISA)
			specify the technical requirements of the connection: how 2 parties establish, maintain and disconnect, also minimum encryption
		NIST 800-47 includes details information on MOU and ISA

	Addressing personnel Safety
		

Provisioning and Managing Resources
		
	managing hardware and software assets
	
		hardware inventories
			use databases and inventory application to perform inventories and track hardware assets trough the entire equipment life cycle
				bar codes, RFID tags and readers
			sanatizing = remove all data to ensure unauthorized personel dont acces access it
				use inventory to track to-be-diposed material
			
		software licensing
			protect license to ensure against theft or loss
			protect against unauthorized software installed
				Microsoft's System Center Configuration Manager (ConfigMgr) can query each system on the networ :
					identify installed OS and installed applications, including antivirus
					can connect to mobile device, including Windows OS, iOS, Android
					
	Protecting Physical Assets
	
	Managing Virtual Assets
		VM is a huge cost saving
		SDx = software defined everything
			VM, SND Software Defined Network, VSAN
		need Hypervisor = manages VM, Virtual Data Storage, virtual network components
		
	Managing Cloud-Based Assets
		SaaS, PaaS, IaaS
		NIST SP 800-145 provides standard definition for many cloud-based services and deployment models
		NIST SP 800-144 provides in-depth details on security issues related to cloud-based computing

	Media Management
		media = everything that can hold data
		primary risk of USB drive = malware infections and data theft
		Imation sells IronKey flashdrive that include multiple level of built-in protection
			AES 256-bit hardware based encryption
			silver bullet service: remote deny all access to data, diable the device or initiat self-destruct sequence

	Mobile device
		Sim: Subscriber Identity Module
		encryption, remote wipe signal, screen lock, GPS
		BYOD policies within security policies

	Managing Media Life Cycle
		MTTF: Mean Time To Failure
		important to monitor, media should be destroyed once MTTF reached
		degauss highly classified tapes
		destroy tapes in bulk shredder or incinerators	
		MTBF: Mean Time Between Failure

Managing Configuration
	
	Baselining
		= starting point
		starting configuration for a system
		can be created with checklists
			but manuel baseline can be subject to error or misconfigure
		scripts and operating system tools used to implement baselines
		Microsoft operating system include Group Policy

	Using Images for Baselining
		3 steps process:
			1. admin starts installing the OS and all desired applications on a computer (labeled as baseline)
				personnel perform extensive testing to ensure the system operates as expected
			2. admin capture an image of the system, and store in on a server (labeled image server) or USB drive or DVD
			3. personnel deploys image to systems as needed: often require a unique name

		common to combine imaging with other automated methods for baselining
		US Government Configuration Baseline (USGCB) includes baseline for several different OS
			Office of Management and Budget (OMB) mandates the use of these images
			NIST maintains and updates the images as needed

Managing Change
	
	important to ensure the system retains the same level of security
	change management heps reduced unanticipated outages caused by unauthorized changes
	primary goal of change management: change does not cause outage
	ensure that appropriate personel review and approve changes gefore implementation, and that personel document changes
	unauhtorized changes directly affect the A in CIA-triad
	some changes can weaken or reduce security
	derived from ITIL

	Security Impact Analysis
		change management process:
		1. request a change
		2. Review the change
		3. approve/reject the change
		4. schedule and implement the change
		5. document the change

		= mandatory element for some Security Assurance Requirement (SAR) in the ISO Common Criteria

	Versioning
		= version control used in software configuration management 
		
	Configuration documentation
		identifies current configuration of systems, who is responsible for the system and the purpose of the system, and list all changes applied to the baseline
		

Managing patches and reducing vulnerabilities
	
	Patch Management
		= ensure that systems are kept up-to-date with current patches
		Patch = blanket term for any type of code writeen to correct a bug or vulnerability, or improve the perf of existing software
		referred as update,quick fixes, and hot fixes
		Service Pack = collection of patch
		
		Evaluate patches:
			to determine if they apply to the systems
		
		Test Patches
			on an isolated system, to determine any unwanted side effects
	
		Approve the patches
			automatic method to approve and deploy patches

		Deploy patches
			automated methods to deploy patches, third party product or product provided by software vendor
		
		Verify that patches are deployed

		Patch Tuesday and Exploit Wednesday
			Microsoft refgularly releases patches on the second tuesday every months
			support contracts with Microsoft have advance notification of the patches
			some are released 'out-of-band'
			exploit Wednesday = some attackers reverse engineering patches to identify underlying vulnerabilities

	Vulnerabilities management
	
		Vulnerability Scans
			= software tools used to test systems and networks for known security issues
				 ex.: missing patches or weak passwords
				used by attackers as well as security admin
			include a database of known security issues
			Nessus is a popular  Vulnerability Scanners
				by Tenable Networks Security
				analyze packets sent out from systems
				port scans to detect open ports and identify service and protocols
				discover potentially malicious systems, like IP probes and ping sweeps
				scan database for default password and deafult acounts
				scan web-site for protection against injections, like SQL injection or cross-site scripting
 		
		Vulnerability Assessment
			often includes results from vulnerability scans
			can be performed annually to analyze all of the vulnerability scans report
			often done as a part of the risk analysis or risk assessment
			can look at how sensitive information is marked, handled, stored, and destroyed
		
		Common Vulnerabilities and exposure (CVE)
			MITRE (from MIT) receives founding from the US government to maintain the CVE database
		
======================================================================================================================
Chapter 17
Preventing and responding to incident

======================================================================================================================
======================================================================================================================

Managing incident response

	Defining an incident
		= any event that have a negative effect on a CIA of an organization's assets.
		ITIL v3: un unplanned interrution in IT Service or a reduction in the quality of IT service
		
		computer security incident = result of an attack, or the result of malicious or intentional actions on the part of users
		RFC 2350: security incident and computer seecurity incident = any adverse event which compromises some aspects of computer or network security
		NIST 800-61: a violation or imminent threat of violation of computer security policies, acceptable use policies, or standard security practice

	Incident Response Steps
		
		Detection > Response > Mitigation > Reporting > Recovery > Remediation > Lesson Learned
			  ^------------------------------------------------------------|

		NIST SP 800-61: Preparation > Detection and Analysis > Containment, eradication and recovery > postincident recovery

	Detection
		intrusion detection and prevention system send alerts to an administrator
		anti-malware software with pop-up windows
		many automated tools regularly scan audit log looking for predefined events
		end users sometimes detect irregular activity
			< care to false alarms

		IT professionals need specific training to determine difference between a typical problem  that need troubleshooting and a security incident that need to escalate

	Response
		vary depending on the severity of an incident
		Computer Incident Response Team (CIRT) or computer Security Response Team (CSIRT)
			activate only for major security incident
			have training on incident response  and the organization's incident response plan
			help with root cause analysis
			the quicker the better
		important to protect data as evidence during the investigation > management may decide to prosecute responsible individuals
		computer should be turn off when containing an incident: loose temporary files and RAM
			forensics experts have tools they can use to retrieve data in temporary files and RAM

	Mitigation
		attempt to contain an incident
		
	Reporting
		upper-level management does need to know about serious security breaches
		often a legal requirement to report some incidents outside of the organization, specially if customer datas (PII) are impacted
			in US: report to FBI
			in EU: report to INTERPOL (International Criminal Police Organization)

	Recovery
		= return the system to a fully functioning state, with same security level
			double check the ACL, ensuring unneeded service and protocol are disabled or removed

	Remediation
		identify what allowed the incident to occur, and implement methods to prevent it from happening again
		root cause analysis: examine the incident to determine whant allowed it to happen
		
	Lesson Learned
		examin the incident and the response to see if there is any lesson to learn
		the output can be fed back to the detection stage of incident management
		create a report when they complete a lessons learned review
			> may recommand changes to procedures, addtition of security controls, or even changes to policies
		
		delegating incident response to users
			
Implementing Preventing Measures

	Basic Preventive Measures
		
		keep systems and applications up-to-date
			patches

		remove and disable unneeded services and protocols
			attackers cannot attack a service or protocol that isnt running
	
		use intrusion detection and prevention system

		use up-to-date anti-malware software

		use firewalls: host based firewall and network-based firewalls

	Understanding attacks
		
		Denial of Service Attack
			= prevent a system from processing or responding to legitimate traffic or requests for resources and objects
			exploiting a known fault often results in a system crash or 100% CPU utilization
				> system crashes, system reboots, data corruption, blockage or services...
			common for internet-facing system
		
			DDoD: Distributed Denial of Service = multiple systems attacks a single system at the same time
				group of attacker or botnets  coordinate attacks against a single system

		SYN flood attack
			= common DoS attack
			disrupt the standard three-way handshake used by TCP to initiate communication sessions
				send pultiple SYN packets but never complete the connection with an ACK
				each SYN packet provoke the server to send a ACK/SYN back
				server often wait for ACK for as long as 3 min, leaving an incomplete session, taht consumes resources
				attacker often spoof a the source adress, each SYN comes from a different address
				
				IDS and firewalls often include mechanisms to counter this attack				
				using SYN cookie is one method of blocking the attack
				reduce time of waiting the ACK		
			
			TCP reset attack = spoof sender and send a RST packet > session need to be reestablish, and data may need to be recreated

		Smurf and Fraggle attack
			= DoS attacks
			floods the victim with ICMP echo packets instead of with TCP SYN packets
			= spoof broadcast ping request using the IPaddress of the victim as the source IP address
			take advantage of an amplified network (= smurf amplifier) by sending a directed broadcast through a router
			RFC 2644 (in 1999) changes the standard default for configure router not to forward directed broadcast traffic
				> limit smurf attack to a single network
			common to disable ICMP on firewalls, routers and servers to prevent any attack using ICMP

			fraggle atack = similar to smurf attacks
				uses UDP packets over UDP ports 7 and 19

		Ping Flood
			= flood a victim with ping requests
			very effective using botnets (as a DDoS attack)
			counter by blocking ICMP traffic
				IDS can detect a ping fllod and modify environment to block ICMP traffic during the attack

		Botnets
			= robots or zombies
			bot herder = criminal who controls all the computer in the botnet via commands and control servers
			computers often oin a botnet after being infected by a malicious code of software
			botnet of over 40000 computers are relatively common, 1M of systems have been seen in the past
			some bot herders control more than 1 botnet
			counter: use anti-malware software, keep browser and plug-in up-to-date
			ex.: 	GOZ (Gameover Zeus) infected between 500,000 and 1M systems by June 2014
					Operation Tovar (international cooperation between several law enforcement agencies) temporarly cut the communication lines to the GOZ command
				Simda controlled more than 770,000 computers
					took down in Avril 2015
					was infecting 128,000 new computers each months for 6 months		
				Esthost botnet (or DNSChanger) infected 4M computers
					maniputaled DNS settings to use DNS servers controlled by the bot herders and manipulated advertising
					took down in 2011

		Ping of Death
			employs an oversized ping packet
			ping packets are normally 32B or 64B
			ping-of-death attack changed the size of the packets to over 64KB: 
				in most cases, the system crashes
				in other cases, it creates a buffer overflow error
			counter: patches and updates remove the vulnerability

		teardrop
			attackers fragment traffic in such a way that a system is unable to put data packets back together
			counter: patches, IDS can detect the malformed packets

		Land Attack
			attackers send SYN packets to a victim using the victim's IP address as both the source and the destination IP address
			tricks the system into constantly replying to itself and cause it to freeze, crash or reboot
			discovered in 1997 and resurfaced attacking different ports
			counter: keep system up-to-date, filtering traffic with identical source and destination addresses

		Zero-day exploits
			attacking a vulnerability that is unknown to others

			attacker first discovers a vulnerability: common definition of zero-day exploit

			Vendor learns of vulnerability: vendor evaluate the seriousness of the threat and  prioritize the development of the patch (could take days to months)
				attack during the development of the patch is considered zero-day, as the public is unaware of the vulnerability

			Vendor releases patch: 'exploit wednesday' often referred as a zero-day attack
			
			counter: basic preventive measures: disable unneeded services and protocols, enable firewalls, use IDS and IPS, use honeypots and padded cels

		Malicious code
			= any script or program that performs an unwanted, unauthorized, or unknown activity on a computer system
			= virus, worms, trojan horses, documents with destructive macros, and logic bombs
			often called malware, or malcode
			most common form of security breach today
			distributed:
				in the past: floppy disks, hand-carried from system to system
				email with attachment or embedded script
				today: drive-in downloads

			drive-in download = code downloaded and installed on a user's system without the user's knowledge
				attackers modify the code on a web page and when the user visit, the code downloads and installs malware on the user's system...
				counter: keep system up-to-date
				Zeus spread to drive-by downloads and phishing attempts and stole credentials for bank sites
				Gumblar redirected users to another site, which then download and open an infected PDF file

			Criminals can pay website to host their malware = fake anti-malware (or rogueware)
			some malware are transmitted via USB flash drives

		Man-in-the-middle 
			= attacker a position between the 2 end-points of an ongoing communication
				can copy or sniff the traffic > sniffing attack
				act as a store-and-forward or proxy mechanism > attacker can collect logon credentials and sensitive data, or change the content of the messages exchanged
			need impersonate the client from the server, and the server from the client
			often need a combination of multiple attacks
				-alter routing information and DNS values
				-falsify ARP lookup

			counter: keep system out-to-date with patches
					IDS cant usually detect this attack, but can detect abnormal activities occurring over communication links

		War Dialing
			using a modem to search for a system that accepts inbound connection attempts
			dial phone numbers and listen for computer carrier tones
			can search any range of numbers
			newer form: uses VoIP to make calls without use of modems
			Metasploit incorporated an update version of WarVOX = war-dialing tool that uses VoiP
			counter: imposing strong remote access security (including strong authentication), 
				using callback security, ensuring that no unauthorized modems, restricting what 
				using call logging
		
		Sabotage
			= destruction or disruption committed by an employee
			counter:employee termination should be handle swiftly, account access should be disabled as soon as possible
				intensive auditing, monitoring, keeping lines of communication open between employees and managers

		Espionage
			= malicious art of gathering proprietary, secret, private, sensitive or confidential information

		IDS and IPS
			IDS:
				intrusion occurs when an attacker bypass or thwart security mechanisms and gain access to an organization's resources
				effective method of detecting DoD and DDoS attacks
				can raise alarms and send alerts
				automates the inspection of logs and real-time system events
				can modify the environment to stop an attack

			IPS:
				all the capability of an IDS but can also take additional steps
				user can disable extra features to make it function as a IDS
				
			often referred as IDPS

		Knowledge and Behavior based  detection
			knowledge-base use signatures detection
				or signature-base detection or pattern-matching detection
				use database of known attacks developed by IDS vendor
				
			behavior-base compare activity against a baseline of normal performance
				or statistical intrusion detection, or anomaly detection or heuristic-based detection
				create a baseline over a limited time of activity (usually 1 week)
					some continue to monitor the activity and update the baseline
				but: often raise a high number of false alarms, false alerts or false positive

		IDS response
			passive response: log the event and sends a notification
				many Network Operation Center (NOC) have central monitoring screens viewable by anyone

			active response: changes the environment to block activity in addition to logging and sending a notification
				modify ACL to block traffic based on ports
				disabling all communications over specific cable segments

			can measure a firewall's effectiveness by placing passive IDS before and after the firewall
		
		Host and Network based IDSs
			
			Host based IDS (HIDS)
				monitors activity in a single computer
				can often examine events in more detail than an NIDS can
				can pinpoint specific files compromised in an attack
				but: expensive, cost to manage, use system resources, cannot detect network attacks, easier for an intruder to discover and disable
			
			Network based IDS (NIDS)
				evaluates network to detect attacks or event anomalies
				cannot monitor content of encrypted traffic but can monitor packet details
			
				switches are often used as a preventive measure against rogue sniffers
					mirror all traffic to a specific port used by the IDS (port mirroring)
					on CISCO, the port used for port mirroring is called the Switched Port ANalyzer port (SPAN)
			
				central console often installed on a single-purpose computer that is hardened against attacks
					reduce vulnerabilities in the NIDS and can allow it to operate almost invisibly
					very little negative impact on network resources and doesn't impact any other system
					can add additional systems to balance the load
			
				NIDS can discover the source of an attack by using RARP or reverse DNS lookups
				can detect the initiation of an attack or ongoing attack, but they can't always provide information about the success of an attack
				can use NIDS as part of an Audit Trail

		Intrusion Prevention Systems (IPS)
			or IDPS
			= special type of active IDS that attempts to detect and block attacks before they reach target systems
			placed in line with the traffic
				IDS in not place in line with the traffic and can only check the activity after it has reached the target
			use knowledge-based or behavior-base detection

		Understanding darknet
			= portion of allocated IP addresses that are not used
			
	Specific Preventive Measures

		Honeypots/Honeynets
			= individual or networked computers created as a trap for intruders
			they act like legitimate systems, but they dont host of any real value for an attacker
			admin often configure honeypots with vulnerabilities to tempt intruders
			legitimate users wouldn't access the honeypot
			gives admin the opportunity to observe an attacker's activity without compromising the live environment
			effective countermeasures against zero-day exploit
			often hosted on virtual systems, simpler to recreate after an attack
			enticement vs entrapment
				entrapment = actively solicits visitors to access the site and then charge them with unauthorized intrusion
					illegal !

		Pseudo Flaws
			= false vulnerabilities or apparent loophole intentionally implanted in a system in an attempt to tempt attackers
			more sophisticated pseudo flaws simulate the penetration and convince the attacker that they have gaines additional access privileges to a system

		Padded Cells
			= similar to honeypot
			= simulated environment that offers fake data to retain an intruder's interest
				the IDS transfers the intruder into the padded cell without informing the intruder that the change has occurred

		Warning Banners
			inform users and intruders about basic security policy guidelines
			wording important from a legal standpoint

		Anti-malware
			= most important protection against malicious code
			installed on firewall, email server, and each systems
			recommended to install only one system
				consue system resources
				can results in problem due to collusion
			
		Whitelisting and Blacklisting
			= effective preventive measure blocking users from running unauthorized applications
			whitelisting identify a list of applications allowed
				some use a hashing algorithm of the application to detect virus that change application, and so the hash			
				iOS is a typical extreme version of whitelisting
			blacklisting identify a list of applications forbidden
				
		Firewalls
			= provide a protection to a network by filtering traffic
			based on IP address, port, protocol
			include rules with ACL
			
			application-level gateway firewall filters traffic based specification application requirement
			circuit-level gateway firewalls filters traffic based on the communication circuit
			stateful inspection firewalls and dynamic packet filtering firewalls, filter traffic based on its state within a stream of traffic
			
			next-generation firewall functions as Unified Threat Management (UTM)
				combine several filtering capabilities
				able to perform packet inspection techniques

		Sandboxing
			= security boundary for applications and prevents the application from interacting with other applications
			anti-malware applications use sandboxing techniques to test unknown applications
			often hosted on virtual environment
			
		Third Party Security Services
			auditing or penetration testing
			provide assurance to an outside entity that third-party services providers comply with specific security requirements
			some SaaS vendors provide security services via the cloud

		Penetration Testing
			= mimic an actual attack in an attempt to identify what techniques attackers can use to circumvent security
			= intrusive and can affect the availability
			important to get approval from senior management
			often use vulnerability scan, or vulnerability assessment and go further and attempts to exploit weaknesses
			goals:
				determine how well can a system tolerate an attack
				identify employee's ability to detect and respond to attacks in real time
				identify additional controls that can be implemented to reduce risks

			risks of penetration testing
				some methods can cause outages
					ex.: exploiting a buffer overflow vulnerability can cause a server to shut down or reboot
				whenever possible pentest are performed on test system instead of live production systems
				
			obtening permission for pentest
				should be performed after careful consideration and approval of senior management
				
			penetration-testing techniques
				blackbox testing by zero-knowledge team = knows nothing about the target site except publicly available information
				whitebow testing by full-kwnoledge team = have full access to all aspects of the target environment (including source codes, patches and upgradesinstalled
				gray-box testing by partial knowledge team = 
			
				social-engineering techniques and physical breach are often used
			
			protect Reports
				report should be protected as sensitive information
				
			ethical hacking
				= another name of pentesting
				ethical hacker will always stay within legal limits

Logging, Monitoring and auditing

	Logging and monitoring
		logging record events into various logs
		monitoring reviews these logs
		
		Logging techniques
			ex.: event viewer in Microsoft server 
				
			common log types

				security logs = record access to resources
				system logs = record system events
					system start/stop, service start/stop
				application logs = record information for specific application
				firewall logs = record events related to any traffic that reaches a firewall
					including allowed and blocked traffic
					commonly key packet with source and destination IP addresses, or ports
						but not actual content of the packets
				proxy logs = record what sites a specific user visit
				change logs = record change request, approvals and actual changes to a system as a part of an overall change management process
					useful to track approved changes

		protecting log data
			attackers can modify logs to erase their activity
			common to centralize logs on a central system to protect them
			important to destroy logs when they are no longer needed	
			
	the role of monitoring
		
		monitoring and accountability
			necessary function to ensure that subjects can be held accountable for their actions and activities
			users aware of logs recording their activity are less likely to try to circumvent security controls or to perform unauthorized or restricted activity
			legislation requires specific monitoring and accountability practices
				Sarbanes-Oxley Act of 2002
				HIPAA
				EU privacy laws

		monitoring and Investigations
			audit trails give investigators the ability to reconstruct events log long after they have occurred
			logs should have correct time stamps, which remain consistant throughout the environment: set up a NTP server

		monitoring and problem identification
			audit trails can record system failures, OS bugs, and software errors or malicious attacks
			some log files can capture the contents of memory when an application or system crash

		monitoring techniques
			= process of reviewing information logs looking for something specific
			
			log analysis = detailed and systematics form of monitoring in which the logged information is analyzed for trends and patterns and policy-violating activities
			IDS actively monitor multiple logs to detect and respond to malicious intrusions in real time
	
		Security Information and Event Management
			Security Information and Event Management (SIEM)
			Security Event Management (SEM)
			Security Information Management (SIM)
				can monitor a group of email servers
				have agent for any type of server or network device, monitor network flow for traffic and trend analysis
				use data mining techniques to retrieve relevant data
				security professionals can create reports and analyze the data
			
		Audit Trails
			= records created when information about events and occurences is stored in one or more databases or log files
			security professionals extract information about an incident from an audit trail to prove or disprove culpability
			= passive form of detective security control
			= deterrent, such as CCTV or security guards

		Sampling
			or data extraction
			= full process of extracting specific elements from a large collection of data

		Clipping Level
			= form of nonstatisitcal samplings
			select only events that exceed a clipping level, which is a predefined threshold for the event
			often associated with a form of mainframe auditing known as violation analysis: system is monitored for error occurences
			nonstatistical sampling is discretionary sampling (or sampling at the audtor's discretion)
				less expensive and easier to implement than statistical sampling
				less reliable and mathematically less defensible
		
		Other monitor tools
			CCTV
			keystroke monitoring = recording keystrokes a user performs on a physicall keyboard
				< keylogger
				compared to wiretapping
			traffic analysis and trend analysis
				examine the flaw of packets rather than the actual packet contents
				sometimes referred as network flow monitoring
			
	Egress Monitoring
		= monitoring outgoing traffic to prevent data exfiltration = unauthorized transfer of data outside the organization
		
		Data loss prevention (DLP)
			attempt to detect and block data exfiltration attempts
			can scan files for words Confidential, Proprietary, Private and Sensitive, and detect them
			pattern-matching DLP systems look for specific patterns
				ex.: US Social Security Number have the pattern: nnn-nn-nnn

			network-based DLP
				scans all outgoing data looking for specific data
				admin would place it on the edge of the negative to scan all data leaving the organization

			endpoint-based DLP
				scan files stored on a system as well as files sent to external device, such as printers
					ex.: prevent users from copying to USBdrive, or sending sensitive data to a printer

			have the ability to perform deep-level examinations, even in compressed files, but not in encrypted files

		Steganography
			= embedding a message within a file
			ex.: modify bits within a picture file
			possible to extract embedded message if you have the original file, by creating a hash of both files
			an organization can periodically capture hashes of internal files that rarely change (as jpeg or gif files)
			
		Watermarking
			= embedding an image or pattern in paper that ins't readily perceivable
			DLP can detect watermark and block transmissions or raise alert
			digital watermarking = embedded marker in digital file
				ex.: movie studios digitally mark copies of movies sent to different distributors

	Auditing to assess Effectiveness
		auditing = methodical examination or review of an environment to ensure compliance with regulations and to detect abnormalities, unauthorized occurrences, or crime
		auditors = responsible for testing and verifying that processes and procedures are in place to implement security policies or regulations
				also verifies that personnel follow these processes and requirements
				auditor perform the auditing

		auditing can refer to 2 meanings:
			-use of audit logs and monitoring tools to track activity
			-inspection or evaluation			

		inspection audits
			important to define and adhere clearly to the frequency of audit reviews
			frequency typically determined based on risks
			= key elements of the due care
			
		access review audits
			verify that users do not have excessive privileges and that accounts are managed appropriately

		user entitlements audits
			refers to the privileges granted to users
			follow the principle of least privileges
			
		audit of privileged groups
			many organization use groups as part of a role-based access control
			important to limit the membership of the groups, and to make sure group members are using high-privilege accounts only when necessary

		High Level Admin group
			admin group is typically granted full privilege on a system
			ex.: Microsoft domain include a group known as Enterprise Admins group
			possible to use automated methods to monitor membership in privileged accounts

		Dual Administrator accounts
			many organization require admin to maintain 2 accounts:
				one account for regular day-to-day use
				one account with additional privileges, for administrative work
			auditing can verify that administrator are using the privileged account appropriately
			administrator account typically requires a stronger password

	Security Audit and Reviews
		should include:
			Patch management
			vulnerabilities management
			configuration management: ensure original config are not modified
			change management

		reporting audit reviews
			reports should address a few basic or central concept:
				purpose of the audit
				scope of the audit
				results discovered or revealed by the audit
			include wide rande of content, including:
				problems, events, and conditions
				standards, criteria, and baselines
				causes, reasons, impact, and effect
				recommended solutions and safeguards

		Protecting Audit Results
			audit reports include sensitive info
			auditors sometimes create a separate audit report with limited data for other personel

		Distributing audit reports

		using external auditors
			some laws and regulations require external audits				
			interim report = written or verbal report given to the organization about any observed security weaknesses
			often hold an exit conference			


======================================================================================================================
Chapter 18
Disaster Recovery Planning

======================================================================================================================
======================================================================================================================

The nature of Disaster

	Natural disaster
		= reflects the occasional fury of our habitat
			violent occurences that result from changes in the earth's surface or atmosphere that are beyond human control
			
		earthquake
			82% of the 50 states in US are concerned
			
		flood
			anywhere and any time
			flash floods = sudden severe storm dumps more rainwater on an area that the earth can absorb
			responsible for 1billion $ in damage to business and homes in US/year
			most general businees assurance policies dont cover flood damage
				investigate obtaining specialized government-backed flood insurance under FEMA's National Flood Insurance Program
			100-year flood plan / 500-year flood plan: 1 chance on 100 (or 500) that a significant flood strike each year
		
		Storms
			threat of wind exceeding 100miles/hour
			provoke lightnings: severe damage to electronic components
			
		Fires
	
		Other Regional Events
			localized and specific natural events:
				volcanic eruptions
				monsoons
				tsunamis
				avalanches
				mudslides
			
	Man-made disaster
		intentional and unintentional
		
		Fires
			1000 building fire in the US every day
			
		Acts of terrorism
			9/11 estimated total damage of 40billion $
			
		Bombings/explosion
			effect of bombings and explosion = large-scale fire in disaster planning perspective

		power outages
			check Uninterruptible Power Supply (UPS) regularly !
			many UPS contain self-testing mechanisms
			check how many devices are connected to each UPS
							
		Other utility and Infrastructure Failure
			do the business rely on water, sewers, natural gas ?
			consider supply employees

		Hardware/Software failures
			BCP/DRP teams must provide adequate redundancy in their systems
				> fully redundant failover servers in separate locations attached to separate communications links and infra
			how replacement parts can be quickly obtained and installed
		
			ensure that alternate processing sites are far enough away from your main site that they are unlikely to be affected y the same disaster
			remember that threats to your organization are both internal and external
			disaster usually don't come with advance warning
		
		Strikes/picketing
			
		Theft/vandalism
			insurances provides some financial protection
			common mistake to assume that fixed infra is unlikely to be theft target

	Understand System Resilience and Fault Tolerance
		
		Single Point Of Failure (SPOF) = any component that can cause an entire system to fail
		Fault tolerance = ability for a system to suffer a fault but continue to operate
		System Resilience = ability of a system to maintain an acceptable level of service during an adverse event
					= ability of a system to return to a previous state after an adverse event

	Protecting Hard Drives
		RAID protection
		software and hardware RAID are available
		include spare drives, supporting hot swapping

	Protecting Servers
		failover cluster include one or more servers
			provides fault tolerance
		failover = other server in the cluster take over its load in an automatic process
		
	Protecting Power sources
		UPS usually provides battery-supplied power for 5min to 30min
			enough to complete a logical shutdown or until a generator is powered
		offline or standby UPS: provides surge protection and battery backup

	Trusted Recovery
		= provides assurance that after a failure or crash, the system is just as secure as it was before the failure or crash occurred
		can be manual or automated
		fail-secure state = will default to a secure state in the event of a failure
			ex.: firewalls < implicit deny philosophy
		fail-open state	= will fail in an open-state, granting all access
			ex.: bank vault

		Manual recovery = not fail in secure state, admin is required to manually perform the actions to implement a secured or trusted recovery
		Automated recovery = able to perform trusted recovery activities to restore itself against at least one type of failure
			ex.: RAID
		Automated Recovery without Undue Loss = similar to automated recovery + mechanisms to ensure that specific objects are protected to prevent their loss
		Function Recovery = able to automatically recover specific functions

	Quality of Service (QoS)
		QoS controls protect the integrity of data networks
			bandwidth = capacity available to carry communications
			latency = the time it takes aa packet to  travel from source to destination
			Jitter = variation in latency between different packets
			packet loss = packets loss between source and dest, need retransmission
			interference = electrical noise, faulty equipment...
		some traffic are prioritize among others, ex.: videoconference traffic from the executive conference room

Recovery Strategies
	Actual cash value (ACV): clause included in the property insurance
	
	Business Unit and Functional Priorities
		identify and prioritize critical business functions: which functions to restore after a disaster , and in what order
		= prioritization task included in the BIA (Business Impact Assessment) (= part of the BCP)
		deliverable  contains:
			business units in priority order
			specific business processes listed in order of priority and percentage of needed recovery
				ex.: restore highest-priority unit to 50% then move on to lower-priority units
			Mean time to recovery (MTR)

	Crisis management
		individual who are the most likely to first notice an emergency situation should be fully trained in DR procedures
		
	emergency communications
		when disaster strike , important to be able to communicate internally and with the outside world
		
	Workgroup recovery
		keep goal in mind: restoration of workgroups to the point that they can resume their activities in their usual work locations
		
	Alternate processing Site
		
		cold sites
			= standby facility large enough to handle the processing load of an organization and equipped with appropriate equipments
			has no computing facility preinstalled, no active broadband communication links
			low cost, but tremendous lag between Disaster and recovery
			switchover takes weeks

		Hot Sites
			= exact opposite of the cold site
			= maintained in constant working order, with full complement of server, workstations, and communications links ready
			data are periodically or continuously replicated  to correspond servers at the hot site
			options to activate:
				- force relocation between 2 sites right before the transition of operational control
				- managers may carry up backup tapes of the transactions logs from the primary site to the hot site and manually reapply any transactions lost
				- accept the loss of some portion of data
			
			cost extremely high, double budget for hardware, software and services
			hold the copies of data > provide same security controls as on primary site
			switchover time in seconds to minutes

		Warm Site
			= middle ground between cold and hot site
			contain equipment and data circuit necessary to rapidly establish operations
			usually preconfigured and ready to run appropriate applications
			do not typically contains copies of the client's data
			switchover typically less than 12h
		
		sites can be obtained on a shared facility basis: be sure to have a "no lock out" policy written into your contract

		Mobile sites
			= non mainstream alternative to traditional recovery sites
			typically consist of self-contained trailers or other easily relocated units
			usually cold site or warm site
			
		hardware replacement options:
			- in-house: store extra and duplicate equipment
			- SLA-type agreement with a vendor

		Service Bureaus
			= company that leases computer time
			access on site or remote
			contract include testing and backups as well as response time and availability
			they often oversell their actual capacity > potential resource contention in the wake of a major disaster

		Cloud Computing
			IaaS providers offer on-demand service at a low cost

		Mutual Assistance Agreement (MAA)
			or reciprocal agreements
			popular in DR literature but rarely implemented
			= 2 organization pledge to assist each other in the event of a disaster by sharing computing facilities or others resources
			but:
				difficult to enforce, parties must trust each other
				should be located in proximity to each other > means vulnerable to the same threat
				confidentiality concern often prevent business

	Database recovery
		database specialist should be on the DRP team		
		
		electronic Vaulting
			DB backups are moved to a remote site using bulk transfers
				remote site = dedicated (hot site) or offsite location
			significant delay
			technician need to retrieve the appropriate backups from the electronic vault and apply them
			need to periodically test the electronic vaulting setup

		remote journaling
			= data transfer in a bulk transfer mode, on frequent basis: usually once per hour
			entire database backup files are transferred
			transfers copies of the database transaction logs, containing transactions that occured since the previous bulk transfer

		remote mirroring
			most expensive, most advanced database backup solution
			= live database is maintained at the backup site
			> hot site

Recovery Plan Development
	
	various types of documents:
		executive summary providing a high-level overview of the plan
		department-specific plans
		technical guides for IT personnel
		checklists for individuals
		full copies of the plan for critical disaster recovery team members

	emergency response
		= checklists provided to responders, according to the type of incident
		checklists will be executed in the midst of a crisis
		extremely likely that responders will not execute the entire checklist > put the most essential tasks

		personnel and communication
				key members of the DRP team
				personnel who execute  critical disaster recovery tasks
				alternate means of contact (page numbers, mobile phones...)
				back up contact for each role

			power of checklists = provide a sense of order
				telephone tree notification scheme
				add a safety net
			
		assessment
			assess the situation, in a rolling fashion: triage activity and get the disaster response underway
		
	Backup and Offsite Storage
		
		Full Backups: full copy of the data contained on the protected device
			duplicate all the files on the system regardless of the setting of the archive bit
			once complete, archive bit of all files is reset, turned off, or set to 0

		Incremental Backup: store only those file that have been modified since the time of the most recent full or incremental backup
			only files that have the archive bit turned on, enabled, or set to 1 are duplicated
			once complete, archive bit of all files is reset, turned off, or set to 0

		Differential Backup: store all files that have been modified since the time of the most recent full backup
			only files that have the archive bit turned on, enabled, or set to 1 are duplicated
			does not change the archive bit

		differential take less time to restore, but longer to create
		
		Using Backup: 
			full backup on Monday, and differential backups every other night of the week:
				failure on Saturday morning: restore full backup of Monday and differential of Friday
			full backup on Monday, and incremental backups every other night of the week:	
				failure on Saturday morning: restore full backup of Monday and each incremental backup of the week, in chronological order

		Backup strategy utilize more than one of the three backup types along with a rotation scheme

		Backup tape format:
			rotation cycle = frequency of backup and retention length of protected data
			Digital Data Storage (DDS)/ Digital Audio Tape (DAT)
			Digital Linear Tape (DLT) / Super DLT
			Linear Tape Open (LTO)

		Disk-to-disk (D2D) backup
			
		Backup Best Practices
			backup and restore can be bulky and slow
			should be performed on low peak periods
			amount of backup data increase over time, so the amount of time to backup

		Tape rotation
			Grandfather-Father-Son (GFS)
			Tower of Hanoi
			Six Cartridge Weekly Backup

			Hierarchical storage management (HSM)
			 	= automated robotic backup jukebox consisting of 32 or 64 optical or tape backup devices, all configured as a single drive array

	Software Escrow Arrangements
		= unique tool to protect company against the failure of a software developer to provide adequate support for its products or possibility that developer software will go out of business
	
		developer provides copies of the application source code to an independent third-party organization, which maintain backup copies
			trigger events, third party release copies

	External Communications
		during disaster, necessary to communicate with parties outside the company
		DRP include appropriate channel of communication to the outside world
		usually , not the CEO as the spokesperson, but a hired trained and prepared personnel

	Utilities
		
	Logistics and Supply
		DRP should contain provision

	Recovery and restoration
		sometimes useful to separate DR tasks from disaster restoration tasks
			recovery = operations and processes
			restoration = facility and environment

	Training, awareness and documentation
		orientation training for all new employees
		initial training for employees taking on a new disaster role for the first time
		detailed refresher training for DR team members
		brief awareness refreshers for all other employees
		
		should be full documented
		DRP document should be treated as an extremely sensitive document and provided to individuals on a compartmentalized, need-to-know basis
		remember intranet could be down consequently to a disaster

Testing and Maintenance
	
	Read-through test
		distribute copies of the DRP to the DRP team members for review, accomplishes 3 goals:
			+ ensures key personnel are aware or responsibility
			+ provides individuals with an opportunity to review the plans for obsolete information
			+ helps identify situations in which key personnel have left the company and have not been replaced

	Structured Walk-through
		or table-top exercise
		= role play a disaster scenario
		
	Simulation test
		DRP team are presented with a scenario and asked to develop an appropriate response

	Parallele test
		relocating personnel to the alternate recovery site and implementing site activation procedures

	Full-interruption test
		involve actually shutting down operations at the primary site and shifting them to the recovery site

	Maintenace of DRP
		must adapt DRP to living change in the company
	
======================================================================================================================
Chapter 19
Incidents and ethics

======================================================================================================================
======================================================================================================================

Investigations
	
	investigations type
		some involve law enforcement and must follow rigorous standards designed to produce evidence that will be admissible in court
	
		Operational Investigations
			examine issues
			primary goal : resolving operational issues
			may quickly transition to another type of investigation, ex.: performance issue may uncover evidence of intrusion
			loosest standard for collection of information
			not intended to produce evidence < internal operation purposes only
			= root cause analysis
				often highlights issues that require remediation to prevent similar incidents in the future
	
		Criminal Investigation
			typically conducted by law enforcement personnel
			may result in charging suspects for a crime
			must meet the ÇÊbeyond a reasonable doubtÊÈ standard of evidence
				presenting facts from which there are no other logical conclusions
				must be follow very strict evidence collection and preservation

		Civil Investigation
			typically involve no law enforcement but rather internal employee and outside consultants working on behalf a legal team
			prepare evidence necessary to present a case in civil court
			they use the ÇÊweaker preponderance of the evidenceÊÈ standard
				the evidence demonstrate that the outcome of the case is more likely than not

		Regulatory Investigations
			when individual or corporation has violated administrative law
			standard of proof commensurate with the venue where they expect to try their case
			vary widely in scope
			almost always conducted by government agents

		Electronic discovery
			applies to both paper records and electronic records
			standard process with 9 steps:
				Information governance: ensures that information is well organized for future eDiscovery efforts
				Identification: locates the information that may be responsive to a discovery request
				Preservation: ensures information is protected against alteration or deletion		
				Collection: gather the responsive information centrally for use in the eDiscovery process
				Processing: screens the collected information to perform a "rough cut" or irrelevant information
				Review: examines the remaining information to determine what information is responsive to the request and removing any information protected by attorney-client privileges
				Analysis: performs deeper inspection of the content and context
				Production: places the information into a format that may be shared
				Presentation: displays the information for witnesses, the court, and other parties

	Evidence
		to successfully prosecute a crime, the prosecute attorney must provide sufficient evidence to prove an individual guilty beyond a reasonable doubt

		Admissible evidence
			must meet all these 3 requirements:
				relevant to determine a fact
				material (= relative) to the fact
				competent (= obtained legally)

		Types of evidence
			
			real evidence
				or object evidence
				= things that may actually be brought in court
					ex.: seized computer equipment,...
				could be "conclusive evidence" = incontrovertible (as DNA)

			Documentary evidence
				include any written item 
				must be authenticated
					ex.: computer log as evidence, must bring a witness into court to prove authentification

				best evidence rules: original document must be introduces
					=/= copies (= secondary evidence)
				parole evidence rule: no verbal agreements may modify the written agreement

				chain of evidence
					or chain of custody
					documents everyone who handles evidence
					evidence labeled:
						general description of the evidence
						time and date the evidence was collected
						exact location the evidence was collected from
						name of the person collecting the evidence
						relevant circumstances surrounding the evidence
		
			Testimonial Evidence
				= testimony of a witness
					verbal testimony in court
					written testimony in a recorded deposition

				direct evidence: oral testimony that proves or disproves a claim based on their own direct observation
				expert opinion: based on the other facts presented and their personal knowledge of the field

				must not be hearsay evidence = what someone else told them outside court

		Evidence collection and Forensic Procedure
			= tricky process, should be attempted only by professional forensic technicians
			the International Organization on Computer Evidence (IOCE) outlines 6 principles:
				+ all of the general forensic and procedural principles must be applied
				+ actions taken should not change that evidence
				+ person that access to original digital evidence should be trained for the purpose
				+ all activity relating to the seizure, access ,storage, or transfer of digital evidence must be fully documented, preserved, and available for review
				+ an individual is responsible for all action taken with respect to digital evidence while it is in their possession
				+ any agency that is responsible for seizing, accessing, storing, or transferring digital evidence is responsible for compliance with these principles

			important to preserve the original evidence
				ex.: make an image of the drive, seal the original drive in an evidence bag, and use disk image for investigation

			Media analysis: identification and extraction of information from storage media
				include recovery of deleted files, live analysis of storage media and static analysis of forensic images of storage media

			Network analysis: often difficult due to the volatility of network data, not preserved if not deliberately recorded

			Software analysis: forensics analyst may be asked to conduct a review of software code, looking for backdoors, logic bombs,...
				may be asked to review and intercept the log files from application or databases servers

			Hardware embedded Device Analysis: content of personal computers, smartphones, tablets, embedded computers in car,security systems,...

	Investigation Process
		first assemble a team of competent analysts
		policy that clearly outlines the scope of investigation: authority, role, responsibilities of investigators, and any rule of engagement

		Calling in Law enforcement
			2 major factors a company could be to shy to call the authorities:
				investigation become public
				law enforcement authorities are bound to the 4th amendment and other legal requirements

			search warrant
				4th amendment outlines the burden placed on investigators to have a valid search warrant
					to search a person's private belongings
						number of documented exceptions to this requirement: individual consent, evidence of a crime, life-threatening emergency
					warrant can be issued only based on probable cause
						probable cause is much weaker that the standard of evidence required to secure a conviction
							> most warrant are ÇÊsworn outÊÈ based solely on the testimony of investigators
					warrant must be specific in their scope: detailed description of the legal bounds of the search and seizure

		Conducting the investigation
			never conduct investigation on an actual compromised system: take system offline, make backup to use in investigation
			never attempt to hack back and venge a crime
			in doubt, call in expert assistance: law enforcement or private investigation firm
			begin with informal interviewing techniques:
				suspects should be questioned using interrogation techniques: open-ended questions to gather information

		
Major Categories of Computer Crime

	computer crime = crime that involves a computer
		crime could be against the computer, or computer could have been used in the actual commission of a crime
	attacker = individual who violates one or more or your security policies
	
	Military and Intelligence attacks
		launch primarily to obtain secret and restricted information from law enforcement or military and technological research ressources	
		disrupt of these information could compromise investigations, disrupt military planning or threaten national security
		attacker may looking for:
			military descriptive information: deployment, readiness, battle plans
			secret intelligence
			description and storage locations of evidence
			any information that could be used in later attack

		advanced persistent threats (APT): nation-state, organized, crime, terrorist group  > highly effective attacks against a very focused target

	Business attack
		illegally obtain an organization's confidential information
			secret recipe
			information that could damage the organization's reputation if disclosed, ex.: personal info on employees
		industrial espionage = gathering competitor's confidential information
		use of information gathered usually cause more damage that the attack itself
		
	Financial attack
		goal: steal credit card number, increase the balance of bank account, or place "free" long-distance telephone calls (phone phreaking)
		ex.: shoplifting, burglary
			
	terrorist attack
		goal: disrupt normal life and instill fear
		intelligence gathering is generally preceded by any type of terrorist attack
		typical targets: regulation of power plant, control telecommunication or power distribution

	grudge attack
		goal: damage an organization or a person
		motivation: feeling of resentment
		dont underestimate the insider threat
			
	thrill attack
		launched for the fun
		attackers often called script kiddies (< they copy other's scripts)
		website defacements: replace web content with other pages
		hacktivist compile political motivations with the thrill of attacking

Incident Handling

	event = any occurrence that takes place during a certain period of time
	incident = an event that has a negative outcome affecting the confidentiality, integrity or availability of an organization's data
	
	common type of incidents
		
		Scanning
			= reconnaissance attacks that usually precede another more serious attack
			burglar (FR=cambrioleur) casing a neighborhood for targets
			look for any unusual activity, ex.: high volume of SSH packets on port 22
			may not be illegal, depending on your local laws
			good idea to treat scans as incidents and collect evidence of scanning attacks
			common occurrence of the attack > automatic evidence collection

		Compromise
			= any unauthorized access to the system or information the system stores
			unauthorized use of a valid user ID is compromise attack
			difficult to detect, most often the data custodian detect unusual activity on data

		Malicious code
			= virus, spyware, and many other types
			detected by end user or automatic alert reporting
			protection: implement virus and spyware scanners, and keep signature db up-to-date
		
		Denial of Service (DoS)
			= easiest to detect: user or automated tools reports that service or entire machine are unavailable
			protection: try to dynamically alter firewall rules to reject DoS attack
					so many variations of DoS: very difficult to automate

	response team
		Computer Incident Response Team (CIRT)
		primary responsibilities:
			+ determine the amount and scope of damage caused by the incident
			+ determine whether any confidential information was compromised during the incident
			+ implement any necessary recovery procedures to restore security and recover from incident-related damages
			+ supervise the implementation of any additional security measures to improve security and prevent recurrence of the incident

 			+ facilitate a postmortem review: ensure that key player in the incident share their knowledge and develop best practices to assist in future incident response efforts

		put together  a cross-functional group of individuals:
			+ representative of senior management
			+ information security professional
			+ legal representatives
			+ public affairs / communications representatives
			+ engineering representatives

	incident response process

		Step 1: Detection and Identification
			goals: detecting security incidents and notifying appropriate personnel
			detect abnormal or suspicious activity by monitoring any relevant events that occur
				intrusion detection / prevention systems
				antivirus software
				firewall logs
				system logs
				physical security systems
				file integrity monitoring software
			
			always use multiple sources of data
			be suspicious
			evaluator must notify the incident response team: concludes the incident detection and identification phase

		Step 2: response and Reporting
			choose an appropriate response
			security policy should specify steps to take for various types of incidents								
			must ensure that the chain of evidence in intact

			isolation and containment
				= first actions to take is limiting the exposure and preventing further damage
				> disconnect computer from the network, to prevent intruders from accessing, and from the computer to affect other resources
				critical to leave the system in a running state: do not power down ! > that would destroy and volatile memory and thus, possible evidences

			gathering evidence
				manner of which the evidence is confiscated is important

				voluntarily surrender: generally when attacker is not the owner
					provides sufficient notice for someone to alter the evidence and make it unusable in court
				subpoena (or court order): compel an individual or organization to surrender evidence and then have the subpoena served by law enforcement
					provides sufficient notice for someone to alter the evidence and make it unusable in court				
				search warrant: only when you have access to evidence without tipping off the evidence's owner or other personnel
					must have a strong suspicion
	
				all 3 apply to confiscating equipment inside and outside the organization
					common to have all new employees sign an agreement that provide consent to search and seize any necessary evidence

				following source of data:
					computer systems involved
					logs from security systems
					logs from network devices
					physical access logs
					
			analyzing and reporting
				summarize to determine the most likely course of events leading up to your incident
				summarize in a written report to management
					distinguish facts from opinion
				
		Step 3: Recovery and Remediation
			
			restoration: remediate any damage and limit the damage incurred by similar incidents in the future
				key actions:
					+ rebuild compromised systems, and remediate any security vulnerabilities
					+ restore backup datas, eventually replace data of questionable integrity
					+ supplement existing security controls, fill gaps identified during the incident analysis

			lessons Learned: incident response team review action during the incident, and look for improvement

	Interviewing individuals

		interview = only gather information
		interrogation = suspect the person, and intend to use the information gathered in court

	Incident data integrity and retention

		protect integrity before and after collecting evidence
		take measure to protect logging and deter modifications:
			implement remote logging
			use digital signatures to prove log files were not tampered with after initial capture

	Reporting and documenting incident

		choose a single individual that will act as a liaison with law enforcement
			law enforcement hears a single perspective from organization, and knows the go-go for update
			allows predesignated contact to develop working relationships with law enforcement

		use FBI's Infraguard: special forums

		document:
			what is nature of incident, how was initiated, by whom
			when did it occur
			where did it occur
			what tools did the attacker use
			what was the damage resulting

Ethics
	= rules that governs personal conduct
	
	(ISC)² codes of ethics
		safety and welfare of society and the common good
		strict adherence to this Code is a condition of certification

	Code of Ethics cannon:
		protect society, the common good, necessary public trust and confidence, and the infrastructure
		act honorably, honestly, justly, responsibly, and legally
		provide diligent and competent service to principals
		advance and protect the profession

	Ethic and the internet
		in 1989 Internet Advisory Board (IAB) issued a statement of policy		
		RFC 1087 'Ethics and the Internet"
			seeks to gain unauthorized access to the respires of the internet
			disrupt the intended use of internet
			wastes resources (people, capacity, computer) through such actions
			destroys the integrity of computer-based information
			compromises the privacy of users

		Ten Commandments of Computer Ethics:
			1. thou shall not use a computer to harm other people
			2. thou shall not interfere with other people's computer work
			3. thou shall not snoop around in other people's computer files
			4. thou shall use a computer to steal
			5. thou shall use a computer to bear false witness
			6. thou shall not copy proprietary software for which you have not paid
			7. thou shall not use other peopleÕs computer resources without authorization or proper compensation
			8. thou shall not appropriate other people's intellectual output
			9. thou shall think about the social consequences of the program that you are witing or the system you are designing
			10.thou shall always use a computer in ways that ensure consideration and respect for fellow humans

		Generally Accepted System Security Principles (GASSP)

======================================================================================================================
Chapter 20
Software DEvelopment Security

======================================================================================================================
======================================================================================================================		

Introducing Systems Development Controls

	Software development
		much easier to build security into a system than add security to an existing system	
		
		Programmning Language
			machine language = instructions that computer follows, consisting of a long series of binary digit
				1GL = First Generation Language

			assembly language = higher-level alternative that uses mnemonics to represent the basic instruction set of a CPU
				2GL= Second Generation Language
	
			high level language = allow programmers to write instructions that better approximate human communication
				reduce length of time and programmers needed to craft app
				allows portability

			compiled languages
				3GL = Third Level Language
				C, Java, Fortran
				use a tool to convert the High Level language into an executable file designed for use on a specific operating system
				+: less prone to manipulation, 
				-: easier for malicious programer to embed back door/security flows < original instructions cant be viewed by user
								

			interpreted languages
				JavaScript or VBScript
				programer distribute the source code, which contains instructions in the higher-level languages
				end-user use an interpreter to execute the source code
				-: users have the ability to modify program's original instructions
			
			4GL = attempt to approximate natural languages, including SQL
			
			5GL = allow programmers to create code using visual interfaces

		Object-oriented programing (OOP)
			C++, Java, .NET
			=/= functional programming: focused on the flow of the program itself, attempted to model the desired behavior as a series of steps

			OOP focused on the objects involved in an interaction
			object work together to provide a system's functionality or capabilities
				ex.: banking programs can have 3 object class: accounts, accounts holder and employees
			each object in a OOP has methods that correspond to specific actions that can be taken on the object
				ex.: the account object can have methods to add funds, deduct funds,close the account, transfer ownership
			objects can be subclasses of other objects
				ex.: account object may have subclasses that correspond to specific types of accounts: saving, checking, mortgages,auto loans
				use all the methods of parent class and have class-specific methods
					ex.: checking object might have a method called write_check(), whereas the other subclasses not

			provides a black box approach to abstraction: users need to know the detail of an object's interface (inputs/outputs) but not the inner workings of objects
			objects are encapsulated (self-contained) , can be accessed only through specific message

			some terms:
				Message = communication to or input of an object
				Method = internal code that defines the actions an object can perform in response to a message
				Behavior = results or output exhibited by an object, results of a message being processed through a method
				Class = collection of the common methods from a set of objects that defines the behavior of those objects
				Instance = objects are instances of or example of classes that contain their methods
				Inheritance = occurs when methods from a classe (parent or superclass) are inherited by another subclass (child)
				Delegation = forwarding of a request by an object to another object
				Cohesion = describes the strength of the relationship between the purposes of the methods within the same class
				Coupling = level of interaction between objects
					lower coupling: objects more independent, easier to troubleshoot and update


	Assurance
		assurance procedures = formalized process by which trust is built into the life cycle of a system
		TCSEC (Trusted Computer System Evaluation Criteria) = life cycle assurance				 
				
	Avoiding and Mitigation System Failure
		
		input validation
			limit check = verifies that the values provided by a user match the programer's expectation before allowing further processes
			escaping output = transform the input to remove risky character sequences, and replace with safe values
			should always occur on the server side
		
		fail-secure and fail-open
			
			fail-secure failure state = puts the system into a high level of security until an admin can diagnose the problem and restore the system to normal operations
			fail-open state = allows users to bypass failed security controls, erring  on the side of permissiveness

		Blue Screen Of Death (BSOD), indicates the occurrence of STOP error = fail-secure response

				  Security
				   /	\
			functionality--User_friendliness

	system Development Life Cycle
		
		core activities, essential to the development of sound, secure systems: (terminology change from model to model, publication to publication)
			conceptual definitions
			functional requirements determination
			control specifications development
			design review
			code review walk-through
			system test review
			maintenance and change management

		conceptual definitions
			= creating the basic concept statement for a system
			= very high level statement of purpose of the project and general system requirements
			
		functional requirements determination
			specific functionalities are listed, dev begin to think how the parts of the system should interoperate
			deliverable = functional requirements document: lists specific system requirements			
			managers use this document as a checklist

		Control specifications development
			takes place after the functional requirements determination and go on as the design and design review progress
			analyze the system from a number of security perspectives
				only authorized user are allowed to access the system, and users are not allowed to exceed their level or authorization
				maintain confidentiality of vital data
				provide both an audit trail for individual accountability, and detective mechanism for illegitimate activity
				availability and fault-tolerance issues should be addressed as corrective actions

		Design Review
			often-lengthy process
			designer determine exactly how the various part of the system will interoperate and how the modular system structure will be laid out

		Code review walk-through
			software developers start writing code
			project managers schedule several code review walk-through meeting
			for each specific model, look for problem in logical flow or other design/security flaws

		User acceptance testing
			developers puts in that final semicolon and declares the system complete
			dev and users validate the system against predefined scenarios
			code may move to deployment

		Maintenance and Change Management
			ensure continued operation in the face of changing operational, data processing, storage and environmental requirements

	Life Cycle Model
							
		Soft Development Life Cycle (SDLC)			
		
		Waterfall Model
			SDLC = series of iterative activities
			traditionally 7 stage of development
			feedback loop characteristic = allow development to return to the previous phase to correct defects

			Systems requirements <-> Softwares requirements <-> Preliminary Design <-> Detailed Design <-> Code and Debug <-> Testing <-> Operations and Maintenance

			+: one of the first comprehensive attempts to model the software development process
			-: allows the developers to step back only one phase in the process

			improved by adding validation and verification steps to each phase > modified waterfall model
			
		Spiral Model
			1988, Barry Boehm of TRW
			encapsulates a number of iterations of another model
				> metamodels or "model of models"

			each loop on the spiral results in the development of a new system prototype
			+: allows the developers to return to the planning stages  

		Agile Software Development
			mid-1990
			Manifesto for the Agile Software Development 

			Individual and interactions: over processes and tools
			working software: over comprehensive document
			customer collaboration: over contract negotiation
			responding to change: over following a plan

			12 principles:
				highest priority is to satisfy the customer
				welcome changing requirement, even late in development
				deliver working software frequently
				business people and developers must work together daily
				build projects around motivated individuals
				face-to-face conversation is the most efficient and effective method of conveying information
				working software is the primary measure of progress
				agile process promote sustainable development
				continuous attention to technical excellence and good design enhances agility
				simplicity (= art of maximizing the amount of work not done) is essential
				best architectures, requirements, and designs emerge from self-organizing teams
				at regular intervals, the team reflects on how to become more effective

			Variants: Scrum, Agile Unified Process (AUP), the Dynamic System Development Model (DSDM), Extrem Programming (XP)

		Software Capability Maturity Model (SW-CMM, or CMM or SCMM)
			by the Software Engineering Institute (SEI)
			describes the principles and practices underlying software process maturity
			quality of software depends on the quality of its development process

			level 1: intial
				hardworking people charging ahead in a disorganized fashion
			level 2: repeatable
				basic life cycle management processes are introduced
				reuse of code in organized fashion, repeatable results are expected from similar objects
			Level 3: defined
				software developers operate according to a set of formal , documented software development process
			Level 4: managed
				quantitative measures are utilized to gain a detailed understanding of the development process
			Level 5: Optimizing
				process of continuous improvement occurs

		IDEAL Model
			Phase 1: Initiating
				business reasons behind the change are outlined; support built, appropriate infrastructure is put in place
			Phase 2: Diagnosing
				engineers analyze the current state of the organization and make general recommendation for change
			Phase 3: Establishing
				develop a specific plan of action according to the general recommandations from diagnosing
			Phase 4: Acting
				develops solutions and then tests, refines, and implements them
			Phase 5: Learning
				quality improvement process, organization must continuously analyze its efforts

		Memorization: "I..I, Dr Ed, am Lo(w)"
			
		Gantt Charts and PERT
			Gantt: shows the interrelationships over time between projects and schedules

			PERT (Program Evaluation Review Technique): project-scheduling tool use to judge size of development product and calculate the standard deviation (SD) for risk assessment
		
		Change and Configuration Management

			Request Control	
				provides an organized framework within which users can request modifications,É

			Change Control
				used by developers to recreate the situation encountered by the user and analyze the appropriate changes

				provides an organized framework within which multiple developers can create and test a solution
	
				includes conforming to quality control restrictions, developing tools for update or change deployment

						Release control

				double-check that any code inserted as a programming aid during the change process (debugging  code or backdoors) is removed
				
				include acceptance testing

			
			Configuration Identification

				admin document the configuration of covered software products throughout the organization



			Configuration Control

				ensures that changes to software versions are made in accordance with the change control and configuration management policies


			Configuration Status Auditing
				formalized procedures are used to keep track of all authorized changes


			Configuration Audit

				periodic configuration audit should be conducted to ensure that the actual production environment is consistent with the accounting records




		The DevOps Approach

			seeks to resolve the issues of disconnection between the 3 major IT functions: SW dev, Quality Assurance and Technology Operations
				brings the three function together  in a single operation model

			closely aligned  with the Agile development approach



		Application Programming Interfaces (API)

			modern web applications often include interactions between a number of different web services

			API: help cross-sites function to work properly, websites must interact with each others

			might include some of the following API function calls:

				Post status

				Follow user

				Unfollow user

				Like/Favorite a post


			API must know when to require authentification: verify credentials and authorization for every API call

				typically done by providing authorized API users with a complex API key that is passed with each API call

				backend system validates the API key before processing a request

				API keys are like password and should treated as very sensitive information


		Software testing

			mechanisms to use and data sets to use to explore the product must be developed in parallel with the product itself			
			reasonableness check: ensures that values returned by software match specified criteria that are within reasonable bounds
			
			check how the product handles normal and valid input data, incorrect types, out-of-range values

			Live workloads provides best stress testing possible

			should not use live data or actual field data > possible flaws of integrity and/or confidentiality of datas


			hold apply the same rules of separation of duties: testers different from programmers

			
			White-Box testing: examines the internal logical structures and steps through the code line-by-line

			Black-box testing: examine by a user perspective, providing a wide variety of input scenarios, and inspecting the input.

				No access to internal code

				ex.: final acceptance before system delivery


			Grey-Box testing: combines 2 approaches below and is popular for software validation: internal logical and user perspective

				do not analyze the inner workings of the program

			Static Testing: evaluates without running the SW, analyzing either the source code or the compiled application

				usually involves the use of automated tools to detect common software flaws (buffer overflows)


			Dynamic testing: analyze the security of the software in a runtime environment

				often the only test option for organizations deploying applications written by someone else

				use web-application scanning tools to detect: cross-site scripting, SQL injection

				should be coordinated to avoid unintended interruption of service


		Code repositories

			provides several important functions supporting the collaboration of geographically dispersed developers

			ex.: Github, Bitbucket, Sourceforge

				also provide version control, bug tracking, web hosting, release management, communication functions

			= wonderful collaborative tools that facilitate software development

			-: security risks of their own


			developers must take care not to include sensitive information in public code repositories, particularly for API keys


		Service-Level Agreements (SLA)

			common for following issues:

				system uptime

				Maximum consecutive downtime

				peak load

				average load

				responsability for diagnostic

				failover time (if redundancy)


		Software acquisition

			software acquired can run:

				- on internal servers or IaaS
		
		- delivered over the internet, SaaS approach

			ex.: mail: Microsoft Exchange

			


Establishing Databases and Data Warehousing


	
	Database Management System Architecture

		Database Management System (DBMS)

		vast contemporary systems implements Relational Database Management System (RDBMS)

			
		
		Hierarchical and Distributed Databases

			
			
			hierarchical data model: combines records and fields that are related in a logical tree structure

				> one-to-many model: each node may have 0 to many children, but only one parent

				ex.: organization chart, NCAA March Madness bracket system, hierarchical distribution of Domain Name System records


			
			distributed data model: has data stored in more than one database, logically connected

				users perceives the database as a single entity

				each field has numerous children and parents

				> many-to-many model



		Relational Databases

			= flat 2 dimensional tables made up of rows and columns

				> provides one-to-one data mapping relationships

			ex.:
 
				customers table, contains contact information

				Sales Reps table, contains identity information of organizations sales force

				Orders table, contains record of orders placed by each customer

			Object-oriented programing and databases:

				> object oriented databases (OODB)

				benefit from ease of code reuse, ease of troubleshooting analysis and reduced overall maintenance

				better suited for complex applications involving multimedia, CAD, video, graphics


				each table contains a number of attribute = fields = a column

				ex.: customer table contains: company name, address, city, state
	

				each customer would have its own record, or tuple = row in the table


			cardinality = number of row, usually changes frequently
			degree = number of column, usually doesn't change frequently
			domain = set of allowable values that an attribute can take


				easy to remember:
					cardinality > card > deck of card > rows
					degree > wall thermometer > column



			key = subset of the fields of a table and are used to uniquely identify records
				used to join tables for cross-reference information


				
				Candidate key: subset of attributes that can be used to uniquely identify any record in a table

				primary key: selected from the set of candidate keys for a table to used to uniquely identify the records in a table

				Foreign keys: or referential integrity, used to enforce relationships between two tables

				
			
			all relational database use a standard language: Structure Query Language (SQL)

				provide users with a consistent interface for the storage, retrieval, and modification of data

				ex.: Microsoft Transact-SQL, Oracle's PL/SQL
				SQL primary security feature is granularity of authorization: allows to set permissions at a very fine level of detail


			
			Database normalization:

				= process of bringing a database table into compliance with normal forms

				1NF/2NF/3NF = First normal form

				each form adds requirements to reduce redundancy in the tables

				normal forms are cumulatives: need to be 1NF before becoming 2NF


			
			SQL is divided in 2 distinct components:

				Data Definition Language (DDL) = allow creation and modification of the database structure

				Data Manipulation Language (DML) = allows user to interact with the data


		
		Database Transactions
	
		transaction = discrete set of instructions that will either succeed or fail as a group

			ex.: transfer between 2 accounts

				add 2500$ to account 1001 and then subtract 2500$ from account 2002

			
			when transaction is finished = committed in the DB and can't be undone

				SQL's COMMIT command or implicit end of the transaction

			transaction can be aborted: SQL's command ROLLBACK


			have 4 attributes: ACID model

				Atomicity = must be an all-or-nothing affair

				Consistency = must begin and end operating in an environment that is consistent with DB's rules

				Isolation = transactions operate separately from each other

				Durability = once committed, must be preserved



		Security for Multilevel Databases

			admin and dev should strive to keep data with different security requirements separate

			database contamination = mixing data with different classification levels


			Restricting access with views

				views = SQL statements that present data to users as if the views were tables themselves

					stored in the Database as SQL commands rather then as tables of data

						> reduces space requirements of DB / allows views to violate the rules of normalization that apply to tables

					-: longer to retrieve data < DBMS may need to calculate values of certain attributes for each record



			Concurrency

				or edit control

				= preventive security mechanism that endeavors to make certain that the information stored in the DB is always correct = integrity and availability protected

				can be employed in single-level or multi-level DB

				uses a lock feature to allow one user to make changes but deny other users access to views or make changes to data elements at the same time



			Other Security Mechanisms

				semantic integrity = ensure user actions don't violate any structural rules

				time and date stamps = maintain integrity

					often in distributed database systems

				objects can be controlled granularly within the database, and improve security control

					content-dependant access control = example of granular object control

						access-control based on the contents or payloads of the objects being accessed

						increases processing overhead

					cell-suppression = concept of hiding individual database fields or cells
 

				Context-dependant access control = evaluates the big picture to make access control decisions

					= how each object or packet or field relates to the overall activity or communication


				database partitioning: subvert aggregation and inference vulnerabilities

					= process of splitting a single database into multiple parts, each  with a unique and distinct security level or type of content


				Polyinstantiation

					= when multiple rows in the same relational database table appear to have identical primary key elements but contain different data for use at differing classification level

					often use as defense against some types of inference attacks

					ex.: ship USS UpToNoGood on an undercover mission to a top-secret location



				noise and perturbation: admin insert false or misleading data into DBMS
	
				redirect o thwart information confidentiality attacks
					careful not to affect business operations



		Open Database Connectivity (ODCB)

			=feature that allows application to communicate with different type of DB without having to be directly programmed for interaction with each type

			has a proxy between applications and backend database driver


			Application -> ODBC manager -> Database drivers -> Database types



Storing Data and information


	types of storage

		primary, secondary, virtual, random access, sequential access, volatile, non volatile


	Storage Threats

		illegitimate access: on every type of storage

			use encrypted file systems, accessible only through the primary operating system

		covert channel attacks allow transmission of data between classification levels

			ex.: writing sensitive data to an inadvertently shared portion of memory

				manipulate amount of free space available on a disk or the size of the file to covertly convey information



Understanding Knowledge-Based Systems
	
	
	
	Expert Systems

		seek to embody the accumulated knowledge of experts on a particular subject and apply it in a consistent fashion to future decisions

		2 main components:

			the knowledge base: contains rules known by an expert system

				seeks to codify the knowledge of human experts in a series of Ç"if/then"È statements

			the inference machine: analyzes information in the knowledge base to arrive at the appropriate decision

				use Fuzzy logic = more closely approximate human thought patterns than the rigid mathematics, by implementing blurred boundaries, allowing algorithm to think "in the shade of gray"
					has 4 steps or phases: fuzzificaion, inference, composition, defuzzification


	Neutral Networks

		= chains of computational units used to imitate the biological reasoning of the human mind

		benefits includes: linearity, input-output mapping and adaptivity

		evident for face-recognition, voice-recognition, weather prediction

		involves many layers of summation, weighing information to reflect relative importance in the overall decision-making process

		training period: network is provided with inputs for which the proper decision is known

			Delta rule (or learning rule) = algorithm works backward from these decisions to determine the proper weights for each node in the computational chain
 			
	
	Decision support system (DSS)

		= knowledge-based application that analyzes business data and presents it in such a way as to make business decisions easier for users

		more informational application than an operational application

		often employed by knowledge workers: graphical manner to link concepts and content and guide the script of the operator

	
	
	Security application

		inability for admin to analyze massive amounts of audit logs

		NIDES (Next-Generation Intrusion Detection Experts System)
			by Philip Porras

			provides an inference engine and knowledge base that draw information from a variety of audit logs


=======================================================================================================================================================

Chapitre 21:
Malicious Code and Application Attacks
			
=======================================================================================================================================================
=======================================================================================================================================================

Malicious code
	
	include broad range of programmed computer security threats


	
	Sources of Malicious Code

		script kiddies = malicious individual who doesn't understand the technologie behind security vulnerabilities but dl ready-to-use scripts

		international organized crime syndicates

		
	
	Viruses

		earliest form of malicious code

		in 2010, 286M million strains of malicious codeÉ 200 000 each day !

		2 main functions: propagation and destruction

		
	
	Virus propagation technique

		
		
		master book record (MBR) viruses

			MBR = portion of bootable media that computer use to load the operating system during boot process

			contain 512Bytes of data, not enough for the entire virus payload

				virus instructs to read and execute the code stored in an alternate location outside the MBR

					> loading the entire virus into memory and potentially trig erring the delivery of the virus's payload


		Boot sector and the MBR

			MBR = single disk sector, normally first of the media that is read

				determine which media partition contains the OS and then directs the system ro read that partition's boot sector to load the OS

			virus can attack both MBR and booth sector



		File Infector Viruses

			infect different types of executable files and trigger when the OS attempts to execute them

				implanting the technologie, the virus needs to replicate and damage the system

					replace the entire file with an infected version


		Companion virus

			self-contained executable files that escape detection by using a filename similar to, but slightly different from, a legitimate OS file

			ex.: game.exe and game.com, launching the shortcut "game" refers to the infected file game.com



		Macro viruses

			use scripting functionality called Macros

			appeared in mid 1990, to infect docs in MS Word

			
		Service Injection Viruses

			injecting themselves into trusted runtime processes of the operating system, like svchost.exe, winlogin.exe, explorer.exe

			
		Platform Vulnerable to Viruses
			99% windows
	
	
		Antivirus mechanisms

			signature-based detection = extremely large DB that contains the telltale characteristics of all known viruses

				scan periodically storage media for matching with criteria in the DB

				if detection:

					- eradicate virus, disinfects the affected files and restores the machine

					- recognizes virus but don't know how to disinfect the files: quarantine the files until user can examine manually

					- if security settings/policies do not provide for quarantine or the file exceed a defined danger threshold, delete infected files

				as effective as the virus definition file upon which it's based

					must update frequently the virus definition

			heuristic-based mechanisms: analyze application behavior, looking for telltale signes of virus activity: elevate privilege level, cover electronic tracks alter unrelated or OS files


			tripwire: designed to alert admin to unauthorized file modification

				works by maintaining an database of hash values for all files stored on the system



		Virus Technology

			
			
			multipartite viruses

				use more than one propagation technique in an attempt to penetrate systems that defend against only one method or the other

				ex.: Marzia in 1993 infects critical COM and EXE files, adding 2,084bytes of malicious code to each file

					2h later, writes malicious code to the system's MBR > boot sector virus


			Stealth virus

				hide themselves by actually tampering with the operating system to fool antivirus packages into thinking that everything is normal

				ex.: modify MBR and OS's file access functionality to cover its tracks

			
			Polymorphic Viruses

				modify their own code as they travel from one system to another

					> constantly changing signature, signature-based antivirus packages useless

					some antivirus have cracked the code of many polymorphism technique and now are able to detect known polymorphisme viruses

						longer to generate the necessary signature files


			Encrypted virus

				use cryptographic techniques to avoid detection

				each infected system has a virus with a different signature, not by changing the code, but altering the way they are stored on the disk

				virus decryption routine = very short segment of code used by virus
 
					contains the cryptographic information necessary to load and decrypt the main virus code stored else where on the disk

				each virus use a unique cryptographic key, causing main code to appear completely different on each system

				
		Hoaxes

			send a mail received by a friend or relative that warns of the latest virus threat roaming the Internet

			= most destructive virus ever unleashed



		Logic Bombs

			= malicious code objects that infects a system and lie dormant until they are triggered by occurrence of one or more conditions

			often programmed into custom-built application to destroy work of developers if they leave the company

			many trojan horses and viruses contain a logic bomb component

			ex.: michelangelo: destroy all data on the birhdate of the famous artist



		Trojan Horses

			= appears benevolent but carries malicious, behind-the-scene payload that has the potential to wreak havoc on a system or network

			ex.: XBox trojan horses, rogue antivirus software



		Ransomware

			infects a machine and encrypt documents with a key only known by malware creator

			ex.: cryptolocker

	
		
		Botnets

			trojan horse make all the infected systems members of a botnet
 
			= collection of computers across the internet under the control of an attacker known as a botmaster
		


		Worms

			propagate themselves without requiring any human intervention


		
			Code red worms

				summer 2001, on Microsoft Internet Information Server (IIS)

				+ randomly selected Hundreds of IP address and probe them to see whether they were used by vulnerable hosts

				+ defaced HTML pages on the local web server, replacing by Ç"Welcome to http://www.worm.com

				+ planted a logic bomb that would initiate a DoS against the IP 198.137.240.91: white house's home page

				
			
			Stuxnet

				mid-2010,
 
				+ searching for unprotected administratives shares of systems on the local network

				+ exploiting zero-day vulnerabilities in the Windows Server Service and Windows Print Spooler service

				+ connecting to system using a default database password

				+ spreading by the use of shared infected USB drives

				searching for a specific controller manufactured by Siemens, used for production of nuclear weapons, to destroy centrifuges

				developed by American-Israeli to sabotage the Iranian program



		Spyware and Adware

			spyware monitors your system and transmits important information to a remote system that spies on activities

			adware displays advertisements on infected computers, could display pop-up or monitor shopping behavior and redirect to competitor websites

			take advantage of third-party plug-ins to popular internet tools

			
	
		Countermeasures

			
deploy antivirus-filtering software on at least 3 keys areas:

				client systems = every workstation on a network

				server systems: more critical than protecting client systems

				content filters: scans inbound and outbound electronic mail and web traffic


			removal = removes the malicious code but does not repair the damage

			cleaning = removes the malicious code and repair damages done

			
between signature database update, virus can appears in the wild, need:

				- integrity-checking software: like tripwire

				- access-control maintained and enforced


			to prevent system from being infected by malicious code embedded in active content:

				- Java's sandbox provides applets with an isolate environment

				- ActiveX control signing uses a system of digital signatures to ensure the code to be generated by a trusted source

				- whitelisting applications at the OS level admin to specify approved app


		2 main reasons systems are affected by zero-day vulnerabilities	
			- necessary delay between discovery or virus and issuance of patches
			- slowness in applying updates by admin



Password Attack

	
	
	Password guessing

		lists of most common password
			
	many people use name of spouse, child, family pet, birthrates, anniversaries, Social Security Number, phone number


	Dictionary attacks

		Unix systems encrypt user password in /etc/passwd

			contain an encrypted value obtained from a one-way encryption function

		uses automated tools like John the ripper to run automated dictionary attacks:

			run the encryption function on a large dictionary file to obtain the encrypted equivalent

			then search the /etc/passwd file for a match with this encrypted dictionary

			when found, reports username and password in plain text



		password crackers

			ex.: Cain & Abel, Ophcrack, Brutus, THC Hydra, L0htCrack, Pwdump, Rainbowcrack


		can now crack these techniques or password:

			rearranging the letters in a dictionary word

			appending a number to a dictionary word

			replacing each occurrence of O by 0, l with 1
			combining 2 dictionary words in some form



	Social Engineering

		direct call, phishing mail



	Countermeasures

		> education

		continually remind users of the importance of a strong password, periodic refresher training

		use first letter of a passphrase

		use secure tools: ex.: Password Safe and Lastpass

		dont assign password to user: they will write them down !

		use shadow password file: /etc/shadow contains the true encrypted passwords, but not accessible to one except the administrator



Application Attacks


	
	Buffer Overflows

		Buffer overflow vulnerabilities exist when dev doesn't properly validate user input

		input that is too largee can Ç"overflow"È a data structure to affect other data stored in the computer's memory

		
	
	Time of Check to Time of Use (TOCTTOU or TOC/TOU)

		program checks access permissions too far in advance of a resource request

		since user is logon, it can access indefinitely the resource


	
	Back Doors

		undocumented command sequence that allows individuals with knowledge of the back door to bypass normal access restrictions

		
	
	Escalation of Privilege and Rootkits

		expand access from normal user account to more comprehensive, administrative access



Web Application Security


	
Cross-Site Scripting (XSS)

		occur when web application contain some type of reflected input
	
		in name field type "Mike<SCRIPT>alert('hello')</SCRIPT>" instead of "Mike"
		can be embed form input in a link

		
counter: input validation, better to determine input that will be authorized: ex.: 3 digit for age



	SQL Injection

		use XSS to gain access to an underlying database



		Dynamic web application

		
		
		SQL Injection Attacks

			allows malicious individual to directly perform SQL transactions against the underlying database

			
	
	Protecting against SQL injection

		perform input validation: remove single quote to prevent main attacks

		limit account privileges: DELETE would fail if the account has only the REQUEST procedure

		use stored procedures: SQL statement resides on the database server and may be modified only by database admin

Reconnaissance Attacks


	IP Probes

		or IP sweeps or Ping sweeps

		ping each address in a range

		ex.: nmap tool

		
	
	Port Scan

		probe all the active systems


	
	Vulnerability scan

		ex.: Nessus, OpenVAS, Qualys, Core Impact, NexposeÉ
		DB of known vulnerabilities and probe targeted systems to locate security flaws

		= highly automated tools

		
	Dumpster Diving

		mostly used for social engineering



Masquerading attacks
	
	attack borrow identity  of legitimate users and systems to gain the trust of third parties

	
	
	IP Spoofing

		reconfigure their system so that is has the IP address of a trusted system

		3 simple filtering:

			+ packets with private internal source IP address dont enter the network from the outside

			+ packets with private external source IP address dont exit the network from the inside

			+ packets with private IP address dont pass through the router in either direction



	Session Hijacking

		malicious individual intercepts part of the communication between an authorized user and a resource

			uses a hijacking technique to take over the session and assume the identity of the authorized user

		uses common techniques:

			- capturing details of the authentication between a client and a server

			- tricking the client into thinking the attacker's system is the server, acting like the middle man

			- accessing a web application using the cookie data of a user who did not properly close the connection


		counter:
 
			administrative control (like anti-replay authentication techniques)

			application controls (like expiring cookies within a reasonable period of time





		